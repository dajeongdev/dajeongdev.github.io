<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="ko"><generator uri="https://jekyllrb.com/" version="3.9.5">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" hreflang="ko" /><updated>2026-01-16T17:39:07+09:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Every Single Day</title><subtitle></subtitle><author><name>Dajeong Park</name></author><entry><title type="html">Docker + Github Actions ê¸°ë°˜ ìë™ ë°°í¬ êµ¬ì¶•í•˜ê¸°</title><link href="http://localhost:4000/wiki/2026/01/16/deploy-with-docker.html" rel="alternate" type="text/html" title="Docker + Github Actions ê¸°ë°˜ ìë™ ë°°í¬ êµ¬ì¶•í•˜ê¸°" /><published>2026-01-16T00:00:00+09:00</published><updated>2026-01-16T00:00:00+09:00</updated><id>http://localhost:4000/wiki/2026/01/16/deploy-with-docker</id><content type="html" xml:base="http://localhost:4000/wiki/2026/01/16/deploy-with-docker.html"><![CDATA[<h3 id="ë°°ê²½">ë°°ê²½</h3>

<p>í”„ë¡œì íŠ¸ê°€ ì ˆë°˜ ì •ë„ ì§„í–‰ë˜ë‹ˆ ìˆ˜ë™ ë°°í¬í•˜ëŠ” ê²Œ ìƒì‚°ì„±ì´ ë„ˆë¬´ ë–¨ì–´ì§„ë‹¤ëŠ” ê±¸ ì²´ê°í•˜ê¸° ì‹œì‘í–ˆë‹¤.
ê·¸ë˜ì„œ ì´ì „ì²˜ëŸ¼ Github Actions ê¸°ë°˜ì˜ ìë™ ë°°í¬ë¥¼ í•˜ë ¤ê³  í–ˆì§€ë§Œ, ì´ì™• í•˜ëŠ” ê¹€ì— ìš”ì¦˜ ë§ì´ ì‚¬ìš©í•˜ëŠ” Docker + Github Actions ì¡°í•©ì„ ì ìš©í•´ë³´ê¸°ë¡œ í–ˆë‹¤.
<br />
<br /></p>

<h3 id="ê³¼ì •">ê³¼ì •</h3>
<h4 id="1-ë¡œì»¬ì—ì„œ-ë¨¼ì €-docker-í™•ì¸í•˜ê¸°">1. ë¡œì»¬ì—ì„œ ë¨¼ì € Docker í™•ì¸í•˜ê¸°</h4>
<p>ìë™ ë°°í¬ ì „ì— Docker ì‹¤í–‰ íë¦„ì„ ì•Œê³  ì‹¶ì–´ ë¡œì»¬ì—ì„œ ë¨¼ì € í™•ì¸í–ˆë‹¤.</p>
<ul>
  <li><a href="https://www.docker.com/products/docker-desktop/">Docker</a> ì„¤ì¹˜</li>
  <li>
    <p><strong>â­ï¸ DockerfileëŠ” ë°˜ë“œì‹œ í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— ìœ„ì¹˜</strong></p>

    <div class="language-docker highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  FROM amazoncorretto:21.0.4
  WORKDIR /app 
    
  ARG JAR_FILE=build/libs/*.jar
  COPY ${JAR_FILE} app.jar
    
  ENTRYPOINT ["java", "-jar", "app.jar"]
</code></pre></div>    </div>
  </li>
  <li>
    <p>ë¡œì»¬ì—ì„œ Dockerfile ì‹¤í–‰</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c"># jar ìƒì„±</span>
  ./gradlew build
    
  <span class="c"># ì´ë¯¸ì§€ ìƒì„±</span>
  docker build <span class="nt">-t</span> &lt;ì‚¬ìš©í•  ì´ë¯¸ì§€ ì´ë¦„&gt; <span class="nb">.</span> <span class="c"># í˜„ì¬ ë””ë ‰í† ë¦¬ ì „ì²´ë¥¼ ë¹Œë“œ ì»¨í…ìŠ¤íŠ¸ë¡œ ì‚¬ìš©</span>
    
  <span class="c"># ì´ë¯¸ì§€ í™•ì¸</span>
  docker images
    
  <span class="c"># ì»¨í…Œì´ë„ˆ ì‹¤í–‰</span>
  docker run <span class="nt">-d</span> <span class="nt">-p</span> &lt;í¬íŠ¸ë²ˆí˜¸&gt;:&lt;í¬íŠ¸ë²ˆí˜¸&gt; <span class="nt">--name</span> &lt;ì»¨í…Œì´ë„ˆ ì´ë¦„&gt; &lt;ì´ë¯¸ì§€ ì´ë¦„&gt;
</code></pre></div>    </div>

    <ul>
      <li>ì—¬ê¸°ê¹Œì§€ ì§„í–‰í•˜ë©´ ë¡œì»¬ì—ì„œ dockerë¥¼ ì„±ê³µì ìœ¼ë¡œ ë„ì› ë‹¤ëŠ” ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
<br />
<br /></li>
    </ul>
  </li>
</ul>

<h4 id="2-docker-composeyml-ìƒì„±">2. docker-compose.yml ìƒì„±</h4>
<ul>
  <li>docker-compose.yml íŒŒì¼ì€ ì—¬ëŸ¬ ê°œì˜ <code class="language-plaintext highlighter-rouge">docker run</code> ëª…ë ¹ì–´ë¥¼ íŒŒì¼ í•˜ë‚˜ë¡œ ê´€ë¦¬í•´ì¤€ë‹¤.</li>
  <li>í•˜ì§€ë§Œ ë§¤ë²ˆ ì•„ë˜ì²˜ëŸ¼ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•´ì„œ ì‹¤í–‰ì‹œí‚¤ëŠ” ê²Œ ìœ„í—˜í•˜ê³  ê·€ì°®ì•˜ë‹¤.
    <div class="language-docker highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  docker run -d -p &lt;í¬íŠ¸ë²ˆí˜¸&gt;:&lt;í¬íŠ¸ë²ˆí˜¸&gt; -e &lt;í”„ë¡œíŒŒì¼ ì„¤ì •&gt; --name &lt;ì»¨í…Œì´ë„ˆ ì´ë¦„&gt; &lt;ì´ë¯¸ì§€ ì´ë¦„&gt;
</code></pre></div>    </div>
  </li>
  <li>ê·¸ë˜ì„œ docker-compose.ymlë¡œ ê´€ë¦¬í•˜ë„ë¡ ë³€ê²½í–ˆë‹¤.
    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="na">services</span><span class="pi">:</span>
    <span class="na">app</span><span class="pi">:</span>
      <span class="na">image</span><span class="pi">:</span> <span class="s">&lt;ì´ë¯¸ì§€ ì´ë¦„&gt;</span>
      <span class="na">container_name</span><span class="pi">:</span> <span class="s">&lt;ì»¨í…Œì´ë„ˆ ì´ë¦„&gt;</span>
      <span class="na">ports</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s2">"</span><span class="s">&lt;í¬íŠ¸ë²ˆí˜¸&gt;:&lt;í¬íŠ¸ë²ˆí˜¸&gt;"</span>
      <span class="na">environment</span><span class="pi">:</span>
        <span class="na">SPRING_PROFILES_ACTIVE</span><span class="pi">:</span> <span class="s">prod</span>
</code></pre></div>    </div>

    <p><strong>ì‹¤í–‰</strong></p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  docker compose up <span class="nt">-d</span>
</code></pre></div>    </div>

    <p><strong>ì¤‘ì§€</strong></p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  docker compose down
</code></pre></div>    </div>
    <p><br />
<br /></p>
  </li>
</ul>

<h4 id="3-ë¯¼ê°-ì •ë³´-ë¶„ë¦¬-application-secretyml--env"><strong>3. ë¯¼ê° ì •ë³´ ë¶„ë¦¬ (application-secret.yml â†’ .env)</strong></h4>

<p><strong>ê¸°ì¡´ ë°©ë²•</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">application-secret.yml</code>ì„ <code class="language-plaintext highlighter-rouge">.gitignore</code> ì²˜ë¦¬</li>
  <li>ìë™ ë°°í¬ ì‹œ ì„œë²„ì— ë™ì¼í•œ ì„¤ì •ì„ ë‹¤ì‹œ ë§Œë“¤ì–´ì•¼ í•¨</li>
</ul>

<p><strong>ê°œì„  ë°©í–¥</strong></p>
<ul>
  <li>application-secret.ymlì—ëŠ” í™˜ê²½ ë³€ìˆ˜ placeholderë§Œ ë‚¨ê¹€</li>
  <li>ì‹¤ì œ ê°’ì€ <code class="language-plaintext highlighter-rouge">.env</code> íŒŒì¼ê³¼ Github Repository Variablesë¡œ ê´€ë¦¬</li>
</ul>

<p><strong>application-secret.yml</strong></p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spring</span><span class="pi">:</span>
  <span class="na">datasource</span><span class="pi">:</span>
    <span class="na">url</span><span class="pi">:</span> <span class="s">${DB_URL}</span>
    <span class="na">username</span><span class="pi">:</span> <span class="s">${DB_USERNAME}</span>
    <span class="na">password</span><span class="pi">:</span> <span class="s">${DB_PASSWORD}</span>
</code></pre></div></div>

<p><strong>.env</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DB_URL=...
DB_USERNAME=...
DB_PASSWORD=...
</code></pre></div></div>

<p><strong>docker-compose.yml</strong></p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">services</span><span class="pi">:</span>
  <span class="na">app</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">&lt;ì´ë¯¸ì§€ ì´ë¦„&gt;</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">&lt;ì»¨í…Œì´ë„ˆ ì´ë¦„&gt;</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">&lt;í¬íŠ¸ë²ˆí˜¸&gt;:&lt;í¬íŠ¸ë²ˆí˜¸&gt;"</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">SPRING_PROFILES_ACTIVE</span><span class="pi">:</span> <span class="s">prod</span>
    <span class="na">env_file</span><span class="pi">:</span>
<span class="err">	</span>    <span class="pi">-</span> <span class="s">.env</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h4 id="4-ì„œë²„ì—-docker-ì„¤ì¹˜">4. ì„œë²„ì— Docker ì„¤ì¹˜</h4>
<ul>
  <li>Ubuntu ê¸°ì¤€ìœ¼ë¡œ Dockerë¥¼ ì„¤ì¹˜í–ˆë‹¤.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ê¸°ì¡´ íŒ¨í‚¤ì§€ ì—…ë°ì´íŠ¸</span>
<span class="nb">sudo </span>apt update
<span class="nb">sudo </span>apt upgrade <span class="nt">-y</span>

<span class="c"># í•„ìš” íŒ¨í‚¤ì§€ ì„¤ì¹˜</span>
<span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> apt-transport-https ca-certificates curl software-properties-common lsb-release

<span class="c"># Docker GPG key ì¶”ê°€</span>
curl <span class="nt">-fsSL</span> https://download.docker.com/linux/ubuntu/gpg | <span class="nb">sudo </span>gpg <span class="nt">--dearmor</span> <span class="nt">-o</span> /usr/share/keyrings/docker-archive-keyring.gpg

<span class="c"># Docker repository ì¶”ê°€</span>
<span class="nb">echo</span> <span class="se">\</span>
  <span class="s2">"deb [arch=</span><span class="si">$(</span>dpkg <span class="nt">--print-architecture</span><span class="si">)</span><span class="s2"> signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] </span><span class="se">\</span><span class="s2">
  https://download.docker.com/linux/ubuntu </span><span class="si">$(</span>lsb_release <span class="nt">-cs</span><span class="si">)</span><span class="s2"> stable"</span> | <span class="se">\</span>
  <span class="nb">sudo tee</span> /etc/apt/sources.list.d/docker.list <span class="o">&gt;</span> /dev/null

<span class="c"># Docker ì„¤ì¹˜</span>
<span class="nb">sudo </span>apt update
<span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> docker-ce docker-ce-cli containerd.io

<span class="c"># Docker ê¶Œí•œ ì„¤ì • (sudo ì—†ì´ ì‹¤í–‰)</span>
<span class="nb">sudo </span>usermod <span class="nt">-aG</span> docker <span class="nv">$USER</span>

<span class="c"># Docker Compose ì„¤ì¹˜</span>
<span class="nb">sudo </span>curl <span class="nt">-L</span> <span class="s2">"https://github.com/docker/compose/releases/download/v2.24.1/docker-compose-</span><span class="si">$(</span><span class="nb">uname</span> <span class="nt">-s</span><span class="si">)</span><span class="s2">-</span><span class="si">$(</span><span class="nb">uname</span> <span class="nt">-m</span><span class="si">)</span><span class="s2">"</span> <span class="nt">-o</span> /usr/local/bin/docker-compose
<span class="nb">sudo chmod</span> +x /usr/local/bin/docker-compose

<span class="c"># ë²„ì „ í™•ì¸</span>
docker-compose <span class="nt">--version</span>

<span class="c"># Docker Composeë¡œ ì‹¤í–‰</span>
docker compose up <span class="nt">-d</span> <span class="nt">--build</span>

<span class="c"># ë¡œê·¸ í™•ì¸</span>
docker compose logs <span class="nt">-f</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h4 id="5-github-actions-ìë™-ë°°í¬">5. Github Actions ìë™ ë°°í¬</h4>

<p><strong>ì „ì²´ íë¦„</strong></p>
<ol>
  <li>feature ë¸Œëœì¹˜ì— push</li>
  <li>self-hosted runnerì—ì„œ ì‹¤í–‰</li>
  <li>Gradle ë¹Œë“œ</li>
  <li>Docker ì´ë¯¸ì§€ ë¹Œë“œ</li>
  <li>ê¸°ì¡´ ì»¨í…Œì´ë„ˆ ì¢…ë£Œ</li>
  <li>docker compose ì¬ì‹¤í–‰</li>
</ol>

<p><strong>ì§„í–‰</strong></p>
<ul>
  <li>ì„œë²„ì— ë¨¼ì € Github Actions Runner ì„¤ì¹˜í•œë‹¤.</li>
  <li>ê·¸ë¦¬ê³  í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— /.gihub/workflows í´ë” ë§Œë“¤ê³ , ë°°í¬í•  yml íŒŒì¼ì„ ì‘ì„±í•œë‹¤.</li>
</ul>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">Auto Deploy</span>

<span class="na">on</span><span class="pi">:</span>
  <span class="na">push</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">feature</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>

    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">self-hosted</span>
    <span class="na">environment</span><span class="pi">:</span> <span class="s">prod</span>

    <span class="na">steps</span><span class="pi">:</span>
      <span class="c1"># ì½”íŠ¸ ì²´í¬ì•„ì›ƒ</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Checkout</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v4</span>

      <span class="c1"># JDK ì„¤ì •</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Set up JDK </span><span class="m">21</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/setup-java@v4</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">java-version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">21'</span>
          <span class="na">distribution</span><span class="pi">:</span> <span class="s1">'</span><span class="s">zulu'</span>

      <span class="c1"># env íŒŒì¼ ìƒì„±</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Create prod env file</span>
        <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
          <span class="s">mkdir -p /home/ubuntu/project/env</span>
          
          <span class="s">cat &lt;&lt;EOF &gt; /home/ubuntu/project/env/prod.env</span>
          <span class="s">SPRING_PROFILES_ACTIVE=prod</span>
          
          <span class="s"># ... .env íŒŒì¼ì— Variables ë§¤í•‘ ì„¤ì •</span>
          <span class="s">EOF</span>
          
          <span class="s">chmod 600 /home/ubuntu/project/env/prod.env</span>

      <span class="c1"># Gradle ê¶Œí•œ ë¶€ì—¬</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Grant permission for gradlew</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">chmod +x ./gradlew</span>

      <span class="c1"># í…ŒìŠ¤íŠ¸ ì—†ì´ ë¹Œë“œ</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Build with Gradle</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">./gradlew clean build -x test</span>

      <span class="c1"># ê¸°ì¡´ ì»¨í…Œì´ë„ˆ ì¤‘ì§€ ë° ì œê±°</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Stop &amp; Remove Existing Containers</span>
        <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
          <span class="s">docker compose down</span>
          <span class="s">echo "Existing containers stopped and removed."</span>

      <span class="c1"># ì»¨í…Œì´ë„ˆ ì‹¤í–‰</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Run Docker Compose</span>
        <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
          <span class="s">docker compose up -d --build</span>
          <span class="s">echo "Docker containers running."</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="-íŠ¸ëŸ¬ë¸”ìŠˆíŒ…">ğŸ’« íŠ¸ëŸ¬ë¸”ìŠˆíŒ…</h3>

<h4 id="1-docker-composeyml-ìœ„ì¹˜">1. docker-compose.yml ìœ„ì¹˜</h4>
<ul>
  <li>ì²˜ìŒì—ëŠ” <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> íŒŒì¼ì´ ì„¤ì • íŒŒì¼ ê°™ì•„ì„œ /src/main/resources í´ë”ì— ë„£ì–´ë’€ë”ë‹ˆ ê³„ì† ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤.</li>
  <li>ì—¬ëŸ¬ ë²ˆì˜ ì—ëŸ¬ë¥¼ í†µí•´ Dockerfileì´ ìˆëŠ” í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— ë„£ì–´ì•¼ í•œë‹¤ëŠ” ê±¸ ì•Œì•˜ë‹¤.
<br /></li>
</ul>

<h4 id="2-private-keyê³¼-env-íŒŒì¼ì˜-ê°’-ë§¤í•‘-ì´ìŠˆ">2. private keyê³¼ .env íŒŒì¼ì˜ ê°’ ë§¤í•‘ ì´ìŠˆ</h4>
<p><strong>ë¬¸ì œ ìƒí™©</strong></p>
<ol>
  <li>ì• í”Œ ë¡œê·¸ì¸ì˜ private key ê°’ì„ ê¸°ì¡´ application-secret.ymlì—ì„œëŠ” ë©€í‹°ë¼ì¸ìœ¼ë¡œ ì‚¬ìš©</li>
  <li>í•˜ì§€ë§Œ <code class="language-plaintext highlighter-rouge">.env</code> íŒŒì¼ì€ ë©€í‹°ë¼ì¸ ë¯¸ì§€ì›
<br /></li>
</ol>

<p><strong>ì‹œë„</strong></p>
<ol>
  <li>ì¤„ë°”ê¿ˆì„ \në¡œ ì¹˜í™˜</li>
  <li>Base64 ì¸ì½”ë”©</li>
  <li>BEGIN / END êµ¬ë¬¸ ì œê±° í›„ ì¸ì½”ë”©</li>
  <li>ì¤„ë°”ê¿ˆì„ \në¡œ ì¹˜í™˜ + BEGIN / END êµ¬ë¬¸ ì œê±° â†’ ì„±ê³µ<br />
<br /></li>
</ol>

<p><strong>ì •ë¦¬</strong><br />
ê²¨ìš° í•´ê²°í•˜ê³  ë‚˜ë‹ˆ ì´ê²Œ ì•ˆì „í•œ ë°©ë²•ì¸ì§€ ì˜ë¬¸ì´ ë“¤ì–´ì„œ ë‹¤ìŒì—ëŠ” AWS Parameter Store / Secrets Managerë‚˜ GitHub OIDC + ì™¸ë¶€ Secret ê´€ë¦¬ ê°™ì€ ë°©ì‹ë„ ê²€í† í•´ë³´ë ¤ê³  í•œë‹¤.</p>]]></content><author><name>Dajeong Park</name></author><category term="wiki" /><category term="CICD" /><category term="Docker" /><category term="GithubActions" /><summary type="html"><![CDATA[ë°°ê²½]]></summary></entry><entry><title type="html">Swagger UIì—ì„œ ë°œìƒí•œ Failed to road remote configuration ì›ì¸ ì°¾ì•„ë‚´ê¸°</title><link href="http://localhost:4000/wiki/2025/12/12/swagger-error.html" rel="alternate" type="text/html" title="Swagger UIì—ì„œ ë°œìƒí•œ Failed to road remote configuration ì›ì¸ ì°¾ì•„ë‚´ê¸°" /><published>2025-12-12T00:00:00+09:00</published><updated>2025-12-12T00:00:00+09:00</updated><id>http://localhost:4000/wiki/2025/12/12/swagger-error</id><content type="html" xml:base="http://localhost:4000/wiki/2025/12/12/swagger-error.html"><![CDATA[<h3 id="ë°°ê²½">ë°°ê²½</h3>

<p>í˜„ì¬ ì‘ì—…ì¤‘ì¸ ì‚¬ì´ë“œ í”„ë¡œì íŠ¸ì—ì„œ Springdoc ê¸°ë°˜ìœ¼ë¡œ Swaggerë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤. ìƒˆë¡œìš´ API ê·¸ë£¹ì„ ë§Œë“¤ê¸° ìœ„í•´ GroupedOpenApi ì„¤ì •ì„ ì¶”ê°€í•˜ë©´ì„œ SwaggerConfigë¥¼ ë¶„ë¦¬í•˜ë‹¤ê°€, Swaggerì—ì„œ í™”ë©´ì´ ê°‘ìê¸° ì•„ë˜ ì´ë¯¸ì§€ì²˜ëŸ¼ ì˜¤ë¥˜ë¥¼ ì¶œë ¥í•˜ë©° ë¡œë”©ë˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ë°œìƒí–ˆë‹¤.</p>

<p><img width="788" alt="github-actions2" src="https://dajeongdev.github.io/assets/images/posts/swagger-error.png" /></p>

<p>í˜¹ì‹œ ëª°ë¼ Explore ë²„íŠ¼ì„ ëˆ„ë¥´ë‹ˆ ì•„ë˜ ê°™ì€ ì—ëŸ¬ê°€ ì¶œë ¥ë˜ì—ˆë‹¤.</p>

<p><img width="788" alt="github-actions2" src="https://dajeongdev.github.io/assets/images/posts/swagger-error2.png" /></p>

<p>ì²˜ìŒì—ëŠ” Springdoc ì˜ì¡´ì„±ê³¼ Spring Boot ë²„ì „ì˜ í˜¸í™˜ì„ ì˜ì‹¬í–ˆëŠ”ë°, Springdocì˜ ìŠ¤í™ì„ ë†’ì´ê±°ë‚˜ Spring Bootì˜ ë²„ì „ì„ ë‚®ì¶°ë´ë„ ë¬¸ì œëŠ” ê·¸ëŒ€ë¡œì˜€ë‹¤.
<br />
<br /></p>

<h3 id="ê³¼ì •">ê³¼ì •</h3>

<p>Swagger UIëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë‹¤ìŒ ê²½ë¡œì—ì„œ í™”ë©´ì— ë„ì›Œì¤„ìŠ¤í™(JSON)ì„ ì¡°íšŒí•œë‹¤.</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">/swagger-ui/**</code></li>
  <li><code class="language-plaintext highlighter-rouge">/v3/api-docs/**</code></li>
</ol>

<p>ê·¸ë˜ì„œ ë‹¤ìŒ ë¶€ë¶„ì„ ì°¨ë¡€ë¡œ í™•ì¸í•´ë´¤ë‹¤.</p>

<p><strong>1. GroupedOpenApi ì„¤ì •</strong></p>
<ul>
  <li>ê²½ë¡œë„ í™•ì¸í•˜ê³ , í•´ë‹¹ ì„¤ì •ì„ ì£¼ì„ ì²˜ë¦¬í•´ë„ í™”ë©´ì´ ìƒì„±ë˜ì§€ ì•ŠìŒ</li>
</ul>

<p><strong>2. YMLì—ì„œ Springdocì˜ paths-to-match ì„¤ì •</strong></p>
<ul>
  <li>paths-to-matchì— <code class="language-plaintext highlighter-rouge">/api/**</code> ê²½ë¡œë§Œ ìŠ¤ìº”í•˜ë„ë¡ ì„¤ì •í•´ë‘ì—ˆê¸° ë•Œë¬¸ì— í˜¹ì‹œ ìŠ¤í™ ìƒì„±ì´ í•„í„°ë§ ë˜ì—ˆëŠ”ì§€ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í™•ì¸í•´ë´¤ì§€ë§Œ, ì´ê²ƒë„ ë¬¸ì œê°€ ì•„ë‹ˆì—ˆìŒ
<br />
<br /></li>
</ul>

<h3 id="ì›ì¸-ë°œê²¬">ì›ì¸ ë°œê²¬</h3>

<p>ì˜¤ë¥˜ í™”ë©´ì„ ë³´ë‹¤ê°€ Network íƒ­ì„ ë³¼ ìƒê°ì´ ë“¤ì–´ í™•ì¸í•´ë³´ë‹ˆ ìš”ì²­ ê²½ë¡œê°€ <code class="language-plaintext highlighter-rouge">/api-docs/swagger-config</code>ì˜€ê³ , <strong>403</strong> ìƒíƒœì½”ë“œë¥¼ ì¶œë ¥í•˜ê³  ìˆì—ˆë‹¤.</p>

<p>ê·¸ë¦¬ê³  í”„ë¡œì íŠ¸ì—ì„œëŠ” Spring Securityë¥¼ ì ìš©í•´ë‘ì—ˆëŠ”ë°, í—ˆìš© ê²½ë¡œì—ëŠ” ìœ„ì— ì–¸ê¸‰í–ˆë˜ default ê²½ë¡œë¿ì´ì—ˆë‹¤. ì¦‰, <strong>Swagger UI í˜ì´ì§€ ìì²´ëŠ” ë¡œë”©</strong>ë˜ì—ˆìœ¼ë‚˜, <strong>UIê°€ ë‚´ë¶€ì ìœ¼ë¡œ ìš”ì²­í•˜ëŠ” ì‹¤ì œ ìŠ¤í™ ê²½ë¡œ(<code class="language-plaintext highlighter-rouge">/api-docs/swagger-config</code>) ìš”ì²­ì´ Securityì— ì˜í•´ ì°¨ë‹¨</strong>ë˜ê³  ìˆë˜ ê²ƒì´ë‹¤.
<br />
<br /></p>

<h3 id="í•´ê²°">í•´ê²°</h3>

<p>ê·¸ë˜ì„œ SecurityConfigì— ëˆ„ë½ëœ <code class="language-plaintext highlighter-rouge">/api-docs/**</code> ê²½ë¡œë¥¼ í—ˆìš©í•˜ë„ë¡ ì¶”ê°€í–ˆë‹¤.</p>

<p><strong>SecurityConfig.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfig</span> <span class="kd">implements</span> <span class="nc">WebMvcConfigurer</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">permitUrls</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">[]{</span>
            <span class="s">"/swagger-ui.html"</span><span class="o">,</span>
            <span class="s">"/swagger-ui/**"</span><span class="o">,</span>
            <span class="s">"/api-docs/**"</span><span class="o">,</span> <span class="c1">// application.ymlì— ëª…ì‹œí•´ë‘” ê²½ë¡œ</span>
            <span class="s">"/v3/api-docs/**"</span><span class="o">,</span>
    <span class="o">};</span>
    
		<span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">SecurityFilterChain</span> <span class="nf">filterChain</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="n">http</span>
                <span class="o">.</span><span class="na">authorizeHttpRequests</span><span class="o">(</span><span class="n">authorizeRequest</span> <span class="o">-&gt;</span> <span class="n">authorizeRequest</span> <span class="c1">// ì¸ì¦/ì¸ê°€ URL ì§€ì •</span>
                        <span class="o">.</span><span class="na">requestMatchers</span><span class="o">(</span><span class="n">permitUrls</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span> <span class="c1">// í—ˆìš© URL</span>
                        <span class="o">.</span><span class="na">anyRequest</span><span class="o">().</span><span class="na">authenticated</span><span class="o">())</span> <span class="c1">// ë‚˜ë¨¸ì§€ëŠ” ì¸ì¦ í•„ìš”</span>
			<span class="o">...</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>application.yml</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">springdoc:</span>
  <span class="n">swagger</span><span class="o">-</span><span class="nl">ui:</span>
    <span class="o">...</span>
  <span class="n">api</span><span class="o">-</span><span class="nl">docs:</span>
    <span class="nl">path:</span> <span class="o">/</span><span class="n">api</span><span class="o">-</span><span class="n">docs</span> <span class="err">#</span> <span class="n">openAPI</span> <span class="n">ì ‘ê·¼</span> <span class="n">ê²½ë¡œ</span>
</code></pre></div></div>

<p>ì¶”ê°€ í›„ì—ëŠ” Swagger UIê°€ ì •ìƒì ìœ¼ë¡œ JSON ìŠ¤í™ì„ ë¡œë”©í–ˆê³ , ëª¨ë“  APIê°€ ì˜ í‘œì‹œë˜ì—ˆë‹¤.
<br />
<br /></p>

<h3 id="ê²°ë¡ ">ê²°ë¡ </h3>

<p>ì´ë²ˆ ë¬¸ì œëŠ” Swagger ì„¤ì • ì˜¤ë¥˜ë¡œ ë³´ì˜€ì§€ë§Œ, ì‚¬ì‹¤ ì»¤ìŠ¤í…€ìœ¼ë¡œ OpenAPI ì ‘ê·¼ ê²½ë¡œë¥¼ ì„¤ì •í•´ë†“ê³  SecurityConfigì—ëŠ” ëˆ„ë½í•œ ê²Œ ì›ì¸ì´ì—ˆë‹¤.</p>

<p>Springdocì—ì„œ OpenAPI ê¸°ë³¸ ê²½ë¡œ(<code class="language-plaintext highlighter-rouge">/v3/api-docs</code>)ë¥¼ ëŒ€ì‹  ì»¤ìŠ¤í…€ ê²½ë¡œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì—ëŠ” SecurityConfigì—ì„œë„ ë°˜ë“œì‹œ ë™ì¼í•œ ê²½ë¡œë¥¼ í—ˆìš©í•´ì£¼ì–´ì•¼ í•œë‹¤.</p>

<p>ì´ë²ˆ ì¼€ì´ìŠ¤ëŠ” ì‘ì€ ì‹¤ìˆ˜ì˜€ì§€ë§Œ, ìƒê°ë³´ë‹¤ ì‹œê°„ì„ ì¡ì•„ë¨¹ì€ ì‚½ì§ˆì´ì—ˆë‹¤. ì•ìœ¼ë¡œëŠ” Swagger ê´€ë ¨ ì´ìŠˆê°€ ìˆì„ ë•ŒëŠ” YML ì„¤ì •ê³¼ Securityë¥¼ ê°€ì¥ ë¨¼ì € ê²€í† í•´ë³¼ ê²ƒ ê°™ë‹¤.
<br />
<br /></p>

<h4 id="ì°¸ê³ ">ì°¸ê³ </h4>
<ul>
  <li>https://yundevnote.tistory.com/71</li>
</ul>]]></content><author><name>Dajeong Park</name></author><category term="wiki" /><category term="SpringBoot" /><category term="Swagger" /><category term="Springdoc" /><summary type="html"><![CDATA[ë°°ê²½]]></summary></entry><entry><title type="html">QueryDSLì—ì„œ group_concat SEPARATOR ì—†ì´ êµ¬ë¶„ì ì²˜ë¦¬í•˜ê¸°</title><link href="http://localhost:4000/wiki/2025/07/24/queryds-separator.html" rel="alternate" type="text/html" title="QueryDSLì—ì„œ group_concat SEPARATOR ì—†ì´ êµ¬ë¶„ì ì²˜ë¦¬í•˜ê¸°" /><published>2025-07-24T00:00:00+09:00</published><updated>2025-07-24T00:00:00+09:00</updated><id>http://localhost:4000/wiki/2025/07/24/queryds-separator</id><content type="html" xml:base="http://localhost:4000/wiki/2025/07/24/queryds-separator.html"><![CDATA[<h3 id="ë°°ê²½">ë°°ê²½</h3>

<p>ì¢…ì¢… í…Œì´ë¸”ì˜ ì—¬ëŸ¬ ê°œë¡œ ë“¤ì–´ê°€ ìˆëŠ” ë°ì´í„°ë¥¼ List<String>ì˜ í˜•íƒœë¡œ ë³´ë‚´ì•¼ í•  ë•Œê°€ ìˆë‹¤. QueryDSLì„ ì‚¬ìš©í•  ë•Œ ì´ë¥¼ ìœ„í•´ ë³´í†µ group_concatì„ ì‚¬ìš©í•´ í•˜ë‚˜ì˜ ë¬¸ìì—´ë¡œ ë¬¶ì€ ë’¤, DTOì—ì„œ Stringìœ¼ë¡œ ë°›ì•„ `String.split(â€,â€)`ì„ ì‚¬ìš©í•˜ì—¬ Listë¡œ ë³€í™˜í•˜í•˜ëŠ” ë°©ì‹ì„ ì‚¬ìš©í•˜ê³¤ í–ˆë‹¤.</String></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Expressions</span><span class="o">.</span><span class="na">stringTemplate</span><span class="o">(</span><span class="s">"group_concat({0})"</span><span class="o">,</span> <span class="n">book</span><span class="o">.</span><span class="na">title</span><span class="o">);</span>
</code></pre></div></div>
<p>ê·¸ëŸ°ë° ì´ ë°©ì‹ì—” ì¹˜ëª…ì ì¸ ë¬¸ì œê°€ ìˆë‹¤.
<br />
<br /></p>

<h3 id="ë°ì´í„°ì—-ì‰¼í‘œê°€-ë“¤ì–´ê°„ë‹¤ë©´">ë°ì´í„°ì— ì‰¼í‘œê°€ ë“¤ì–´ê°„ë‹¤ë©´?</h3>
<p>ì˜ˆë¥¼ ë“¤ì–´, ë‹¤ìŒ ê°™ì€ ì±… ì œëª©ì´ ìˆë‹¤ê³  í•  ë•Œ</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"ì²« ì—¬ë¦„, ì™„ì£¼"
"ë‹¤ì„¯ ë²ˆì§¸ ê³„ì ˆ"
</code></pre></div></div>
<p>ì´ ê°’ë“¤ì„ ê¸°ì¡´ ë°©ì‹ëŒ€ë¡œ group_concatìœ¼ë¡œ ë¬¶ì€ ë’¤ DTOì—ì„œ <code class="language-plaintext highlighter-rouge">split(â€,â€)</code> ì²˜ë¦¬ë¥¼ í•´ë³´ì.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">titles</span> <span class="o">=</span> <span class="s">"ì²« ì—¬ë¦„, ì™„ì£¼, ë‹¤ì„¯ ë²ˆì§¸ ê³„ì ˆ"</span><span class="o">;</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">aresult</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">titles</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">","</span><span class="o">));</span>
<span class="c1">// ["ì²« ì—¬ë¦„", " ì™„ì£¼", "ë‹¤ì„¯ ë²ˆì§¸ ê³„ì ˆ"]</span>
</code></pre></div></div>

<p>ì œëª© ì•ˆì˜ ì‰¼í‘œê°€ String.split()ì˜ ê¸°ì¤€ì´ ë˜ì–´ ê°’ì´ ìª¼ê°œì ¸ë²„ë¦¬ëŠ” ë¬¸ì œê°€ ë°œìƒí•œë‹¤.
<br />
<br /></p>

<h3 id="ê·¸ëŸ¼-separatorë¥¼-ì“°ë©´-ë˜ì§€-ì•Šì„ê¹Œ">ê·¸ëŸ¼ SEPARATORë¥¼ ì“°ë©´ ë˜ì§€ ì•Šì„ê¹Œ?</h3>
<p>ë¬¼ë¡  MySQLì—ì„œëŠ” <code class="language-plaintext highlighter-rouge">group_concat(â€¦ SEPARATOR â€˜|||â€™)</code> ê°™ì€ ë°©ì‹ìœ¼ë¡œ êµ¬ë¶„ìë¥¼ ì§€ì •í•  ìˆ˜ ìˆë‹¤.</p>

<p>í•˜ì§€ë§Œ <strong>QueryDSL ë‚´ë¶€ì˜ Hibernateì—ì„œ ì´ SEPERATORë¥¼ SQLì´ ì•„ë‹ˆë¼ JPQLë¡œ íŒŒì‹±í•˜ë ¤ê³  í•˜ê¸° ë•Œë¬¸ì— SyntaxExceptionì„ ë°œìƒ</strong>í•˜ê²Œ ëœë‹¤. ê·¸ë˜ì„œ MySQL ì „ìš© ë¬¸ë²•ì¸ SEPARATORë¥¼ ì§ì ‘ ì“¸ ìˆ˜ ì—†ë‹¤.</p>

<p>ì°¸ê³ ë¡œ <code class="language-plaintext highlighter-rouge">group_concat</code>ì„ ì‚¬ìš©í•˜ë©´ ê¸°ë³¸ì ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">,(ì‰¼í‘œ)</code>ë¥¼ êµ¬ë¶„ìë¡œ ì‚¬ìš©í•œë‹¤.
<br />
<br /></p>

<h3 id="í•´ê²°-querydslì—ì„œ-êµ¬ë¶„ì-ìˆ˜ë™-ì‚½ì…">í•´ê²°: QueryDSLì—ì„œ êµ¬ë¶„ì ìˆ˜ë™ ì‚½ì…</h3>

<p><code class="language-plaintext highlighter-rouge">group_concat</code>ì˜ ê¸°ë³¸ êµ¬ë¶„ìë¥¼ ë°”ê¿€ ìˆ˜ëŠ” ì—†ì§€ë§Œ, <strong>ê° ê°’ ë’¤ì— ì›í•˜ëŠ” êµ¬ë¶„ì(<code class="language-plaintext highlighter-rouge">|||</code>)ë¥¼ ì§ì ‘ ë¶™ì¼ ìˆ˜ ìˆë‹¤.</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// QueryDSL</span>
<span class="nc">Expressions</span><span class="o">.</span><span class="na">stringTemplate</span><span class="o">(</span>
    <span class="s">"group_concat(distinct concat({0}, '|||'))"</span><span class="o">,</span> <span class="n">book</span><span class="o">.</span><span class="na">title</span>
<span class="o">)</span>

<span class="c1">// DTO</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">convertTitles</span><span class="o">(</span><span class="nc">String</span> <span class="n">titles</span><span class="o">)</span> <span class="o">{</span>
		<span class="c1">// ì‰¼í‘œë¡œ ë¶„ë¦¬ëœ ê°’ë“¤ì„ '|||' ê¸°ì¤€ìœ¼ë¡œ ë‚˜ëˆ”</span>
    <span class="k">return</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">titles</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">"\\\\|\\\\|\\\\|"</span><span class="o">))</span> 
	    <span class="c1">// ì•ì— ë¶™ì„ ìˆ˜ ìˆëŠ” ì‰¼í‘œ ì œê±°</span>
	  <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">s</span> <span class="o">-&gt;</span> <span class="n">s</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="s">","</span><span class="o">)</span> <span class="o">?</span> <span class="n">s</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="n">s</span><span class="o">)</span>
      <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">s</span> <span class="o">-&gt;</span> <span class="o">!</span><span class="n">s</span><span class="o">.</span><span class="na">isBlank</span><span class="o">())</span>
      <span class="o">.</span><span class="na">toList</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ì´ë ‡ê²Œ í•˜ë©´ <code class="language-plaintext highlighter-rouge">group_concat</code>ì€ ì—¬ì „íˆ ì‰¼í‘œë¡œ ê°’ì„ ë¶™ì´ì§€ë§Œ, ê° ê°’ì˜ ë‚´ë¶€ì—ëŠ” ìš°ë¦¬ê°€ ì§€ì •í•œ êµ¬ë¶„ì(<code class="language-plaintext highlighter-rouge">|||</code>)ê°€ ë¶™ì–´ ìˆì–´ ì•ˆì „í•˜ê²Œ ë¶„ë¦¬í•  ìˆ˜ ìˆë‹¤.
<br />
<br /> 
<br /></p>

<h3 id="ì¶”ê°€-ë°ì´í„°-ì•ˆì—-ë°˜ë“œì‹œ-ì‰¼í‘œ-í¬í•¨ëœë‹¤ë©´">ì¶”ê°€: ë°ì´í„° ì•ˆì— ë°˜ë“œì‹œ ì‰¼í‘œ í¬í•¨ëœë‹¤ë©´?</h3>

<p>ë§Œì•½ ë°ì´í„° ì•ˆì— ì‰¼í‘œê°€ ë°˜ë“œì‹œ í¬í•¨ëœë‹¤ë©´, ë‹¤ìŒê³¼ ê°™ì´ í•œ ë²ˆ ë” escape ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ì•ˆì „í•˜ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// QueryDSL</span>
<span class="nc">Expressions</span><span class="o">.</span><span class="na">stringTemplate</span><span class="o">(</span>
    <span class="s">"replace(group_concat(distinct replace({0}, ',', '##COMMA##')), ',', '|||')"</span><span class="o">,</span>
    <span class="n">book</span><span class="o">.</span><span class="na">title</span>
<span class="o">)</span>

<span class="c1">// DTO</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">convertTitles</span><span class="o">(</span><span class="nc">String</span> <span class="n">titles</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">titles</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">"\\\\|\\\\|\\\\|"</span><span class="o">))</span>
	    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">s</span> <span class="o">-&gt;</span> <span class="n">s</span><span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="s">"##COMMA##"</span><span class="o">,</span> <span class="s">","</span><span class="o">))</span>
      <span class="o">.</span><span class="na">toList</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="native-queryë¥¼-ì‚¬ìš©í•˜ì§€-ì•Šì€-ì´ìœ ">Native Queryë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì€ ì´ìœ </h3>

<p>Native Queryë¥¼ ì‚¬ìš©í•˜ë©´ <code class="language-plaintext highlighter-rouge">SEPARATOR</code>ë‚˜ <code class="language-plaintext highlighter-rouge">ORDER BY</code> ê°™ì€ SQLì„ QueryDSLë³´ë‹¤ ììœ ë¡­ê²Œ ì“¸ ìˆ˜ ìˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Query</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"select group_concat(distinct title SEPARATOR '|||') "</span> <span class="o">+</span>
	<span class="s">"FROM book"</span><span class="o">,</span> <span class="n">nativeQuery</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
</code></pre></div></div>

<p>í•˜ì§€ë§Œ ë‚˜ëŠ” ì—¬ëŸ¬ ì´ìœ ë¡œ QueryDSL ë°©ì‹ì„ ì„ íƒí–ˆë‹¤.</p>
<ul>
  <li>ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ì¡°ê±´ì´ ë§ìŒ</li>
  <li><strong>íƒ€ì… ì•ˆì •ì„±</strong>ì´ ìœ ë¦¬í•¨</li>
  <li>Native QueryëŠ” ìœ ì§€ë³´ìˆ˜ ì–´ë µê³ , íƒ€ì… ë§¤í•‘ì´ ë¶ˆí¸í•¨</li>
  <li>ë¬¸ìì—´ ì¡°ë¦½ì„ ì˜ëª»í•˜ë©´ <strong>SQL Injection ìœ„í—˜</strong>ë„ ìˆìŒ
    <ul>
      <li>QueryDSLì—ì„œ íŒŒë¼ë¯¸í„°ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">PreparedStatement</code>ë¡œ ë°”ì¸ë”©ë˜ê¸° ë•Œë¬¸ì— <strong>ì‚¬ìš©ì ì…ë ¥ì´ ì§ì ‘ ì¿¼ë¦¬ êµ¬ì¡°ì— ë“¤ì–´ê°€ì§€ ì•Šìœ¼ë©°, SQL Injection ê³µê²©ìœ¼ë¡œë¶€í„° ì•ˆì „</strong>
<br />
<br />
<br /></li>
    </ul>
  </li>
</ul>

<h3 id="ë§ˆë¬´ë¦¬">ë§ˆë¬´ë¦¬</h3>
<p>ë” ì¢‹ì€ ë°©ë²•ì´ ìˆì„ ìˆ˜ ìˆê² ì§€ë§Œ (ìˆë‹¤ë©´ ëŒ“ê¸€ ë¶€íƒë“œë¦½ë‹ˆë‹¤!)<br />
QueryDSLì€ group_concatì—ì„œ SEPERATORë¥¼ ì§ì ‘ ì§€ì •í•  ìˆœ ì—†ì§€ë§Œ, ìš°íšŒì ìœ¼ë¡œ êµ¬ë¶„ìë¥¼ ì‚½ì…í•˜ê³  í›„ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë¬¸ì œë¥¼ ì¶©ë¶„íˆ í•´ê²°í•  ìˆ˜ ìˆì—ˆë‹¤.</p>]]></content><author><name>Dajeong Park</name></author><category term="wiki" /><category term="QueryDSL" /><summary type="html"><![CDATA[ë°°ê²½]]></summary></entry><entry><title type="html">null-safeí•˜ê²Œ Optional ì‚¬ìš©í•˜ê¸°</title><link href="http://localhost:4000/wiki/2025/05/15/java-optional.html" rel="alternate" type="text/html" title="null-safeí•˜ê²Œ Optional ì‚¬ìš©í•˜ê¸°" /><published>2025-05-15T00:00:00+09:00</published><updated>2025-05-15T00:00:00+09:00</updated><id>http://localhost:4000/wiki/2025/05/15/java-optional</id><content type="html" xml:base="http://localhost:4000/wiki/2025/05/15/java-optional.html"><![CDATA[<h3 id="ë°°ê²½">ë°°ê²½</h3>
<p>í”„ë¡œì íŠ¸ ì‘ì—… ì¤‘ Optionalì„ ìì£¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ëŠ” ê±¸ ì¸ì§€í•˜ê²Œ ë˜ì—ˆë‹¤. ê¸°ë³¸ ê°œë…ë¶€í„° ì£¼ì˜í•  ì ì„ ë‹¤ì‹œ ì‚´í´ë³´ë‹ˆ, ìƒê°ë³´ë‹¤ ë‹¤ì–‘í•œ ë°©ì‹ìœ¼ë¡œ null-safeí•œ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•˜ë‹¤ëŠ” ê±¸ ì•Œê²Œ ë˜ì—ˆê³ , íë¦„ì„ ë” ëª…í™•í•˜ê²Œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤ëŠ” ì ë„ ì¸ìƒ ê¹Šì—ˆë‹¤. ì´ë²ˆ ê¸°íšŒì— Optionalì„ ì–´ë–»ê²Œ ì“°ëŠ” ê²ƒì´ ë°”ëŒì§í•œì§€, ì‹¤ë¬´ì—ì„œ ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜ëŠ” ë¬´ì—‡ì¸ì§€ ì •ë¦¬í•´ë³´ê³ ì í•œë‹¤.
<br />
<br /></p>

<h2 id="optional">Optional</h2>
<p><img src="https://dajeongdev.github.io/assets/images/posts/optional.png" /></p>

<ul>
  <li>Javaì—ì„œ NullPointerException(NPE)ì€ ê°€ì¥ í”í•œ ëŸ°íƒ€ì„ ì˜¤ë¥˜ ì¤‘ í•˜ë‚˜ë‹¤.</li>
  <li>Java 8 ì´ì „ì—ëŠ” ë©”ì„œë“œê°€ nullì„ ë°˜í™˜í•  ê²½ìš°, ì‚¬ìš©í•˜ëŠ” ìª½ì—ì„œ null ì—¬ë¶€ë¥¼ ì£¼ì„ì´ë‚˜ ë¬¸ì„œë¡œë§Œ ìœ ì¶”í•´ì•¼ í–ˆë‹¤.</li>
  <li>Java 8ì—ì„œ ë„ì…ëœ Optionalì„ ì‚¬ìš©í•˜ì—¬ null ì—¬ë¶€ë¥¼ ëª…ì‹œì ìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ ìˆì–´, map, filter, flatMap ë“± í•¨ìˆ˜í˜• ë©”ì„œë“œë¥¼ ì§€ì›í•˜ì—¬ null-safeí•œ ì½”ë“œ ì‘ì„±ì´ ê°€ëŠ¥í•˜ë‹¤.
<br />
<br /></li>
</ul>

<h2 id="optional-ì£¼ìš”-ë©”ì„œë“œ-ìš”ì•½">Optional ì£¼ìš” ë©”ì„œë“œ ìš”ì•½</h2>

<table>
  <thead>
    <tr>
      <th>ë©”ì„œë“œ</th>
      <th>ì„¤ëª…</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>map()</td>
      <td>ë‚´ë¶€ ê°’ì„ ê°€ê³µí•˜ê³  Optionalë¡œ ê°ì‹¸ì„œ ì œê³µ</td>
    </tr>
    <tr>
      <td>flatMap()</td>
      <td>ë‚´ë¶€ ê°’ì´ ë˜ ë‹¤ë¥¸ Optionalì¼ ë•Œ ì¤‘ì²© ë°©ì§€</td>
    </tr>
    <tr>
      <td>filter()</td>
      <td>ì¡°ê±´ì„ ë§Œì¡±í•  ê²½ìš°ë§Œ ê°’ì„ ìœ ì§€</td>
    </tr>
    <tr>
      <td>ifPresent()</td>
      <td>ê°’ì´ ìˆìœ¼ë©´ ì‹¤í–‰ (void ë¦¬í„´)</td>
    </tr>
    <tr>
      <td>ifPresentOrElse() (Java 9)</td>
      <td>ê°’ì´ ìˆìœ¼ë©´ A ì‹¤í–‰, ì—†ìœ¼ë©´ B ì‹¤í–‰</td>
    </tr>
    <tr>
      <td>orElse()</td>
      <td>ê°’ì´ ì—†ì„ ê²½ìš° ê¸°ë³¸ê°’ ì œê³µ</td>
    </tr>
    <tr>
      <td>orElseGet()</td>
      <td>ê°’ì´ ì—†ì„ ê²½ìš° Supplier ì‹¤í–‰</td>
    </tr>
    <tr>
      <td>orElseThrow()</td>
      <td>ê°’ì´ ì—†ì„ ê²½ìš° ì˜ˆì™¸ ë°œìƒ</td>
    </tr>
    <tr>
      <td>isPresent()/isEmpty()<br />(Java 11)</td>
      <td>ê°’ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ (â†’ ê°€ê¸‰ì  ì‚¬ìš© ìì œ, ifPresent() ë“± ê¶Œì¥)</td>
    </tr>
    <tr>
      <td>or() (Java 9)</td>
      <td>ë¹„ì–´ ìˆì„ ê²½ìš° ëŒ€ì²´ Optional ì œê³µ</td>
    </tr>
    <tr>
      <td>stream (Java 9)</td>
      <td>Optionalì„ Streamìœ¼ë¡œ ë³€í™˜</td>
    </tr>
  </tbody>
</table>

<h3 id="orelseì™€-orelseget">orElseì™€ orElseGet</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// orElseëŠ” í•­ìƒ ì‹¤í–‰</span>
<span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="na">orElse</span><span class="o">(</span><span class="n">getExpensiveDefault</span><span class="o">());</span>

<span class="c1">// orElseGetì€ í•„ìš”í•  ë•Œë§Œ ì‹¤í–‰(lazy)</span>
<span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="na">orElseGet</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="n">getExpensiveDefault</span><span class="o">());</span>
</code></pre></div></div>

<p>â­ï¸ <code class="language-plaintext highlighter-rouge">orElse()</code>ëŠ” ê¸°ë³¸ê°’ì„ í•­ìƒ ë¨¼ì € ê³„ì‚°í•˜ë‹¤. ë¶ˆí•„ìš”í•œ ë¦¬ì†ŒìŠ¤ ë‚­ë¹„ê°€ ë˜ì§€ ì•Šë„ë¡, ê¸°ë³¸ê°’ì´ í•„ìˆ˜ê°€ ì•„ë‹ˆë¼ë©´ <code class="language-plaintext highlighter-rouge">orElseGet()</code>ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.</p>

<h3 id="ispresent-ì‚¬ìš©-ì‹œ-ì£¼ì˜ì‚¬í•­">isPresent() ì‚¬ìš© ì‹œ ì£¼ì˜ì‚¬í•­</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="o">(</span><span class="n">optionalUser</span><span class="o">.</span><span class="na">isPresent</span><span class="o">())</span> <span class="o">{</span>
	<span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">optionalUser</span><span class="o">.</span><span class="na">get</span><span class="o">();</span> <span class="c1">// ì—¬ì „íˆ ì˜ˆì™¸ ìœ„í—˜ ìˆìŒ</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>Optionalì˜ ëª©ì ì€ null-safeí•œ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê±´ë°, isPresent()ë¥¼ ì¨ì„œ ifë¬¸ìœ¼ë¡œ ë‹¤ì‹œ ì²´í¬í•œë‹¤ë©´ ê²°êµ­ ì´ì „ ë°©ì‹(if (value â‰  null)ê³¼ ë‹¤ë¥¼ ë°” ì—†ê¸° ë•Œë¬¸ì— Optionalì„ ì“°ëŠ” ì´ìœ ê°€ ë¶ˆë¶„ëª…í•´ì§€ê²Œ ëœë‹¤.
    <ul>
      <li>ë˜í•œ, isPresent()ê°€ trueë¼ê³  í•´ë„ ì¤‘ê°„ì— ë‹¤ë¥¸ ë¡œì§ì´ ì¶”ê°€ë˜ë©´ get() í˜¸ì¶œ ì‹œì ì— Optionalì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆì–´ ìœ„í—˜í•˜ë‹¤.</li>
    </ul>
  </li>
  <li>ì´ëŸ´ ë•ŒëŠ” ì•„ë˜ì²˜ëŸ¼ ëª…ì‹œì ì¸ í•¨ìˆ˜í˜• ìŠ¤íƒ€ì¼ì„ ì‚¬ìš©í•˜ë©´ ì¢‹ë‹¤.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">optionalUser</span>
	<span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">NotFoundException</span><span class="o">(</span><span class="s">"ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."</span><span class="o">));</span>
</code></pre></div></div>

<ul>
  <li>ifPresent()ë„ ë¹„ì–´ìˆì§€ ì•Šì„ ë•Œë§Œ ìˆ˜í–‰í•˜ëŠ” ì‘ì—…ì„ í‘œí˜„í•˜ê¸° ì¢‹ë‹¤.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">optionalUser</span><span class="o">.</span><span class="na">ifPresent</span><span class="o">(</span><span class="n">user</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
</code></pre></div></div>

<h3 id="filter">filter</h3>

<ul>
  <li>ì¡°ê±´ì— ë§ëŠ” ê°’ë§Œ ìœ ì§€</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">name</span> <span class="o">=</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"íŒŒì¸ì• í”Œ"</span><span class="o">);</span>
<span class="n">name</span><span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="n">n</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="o">)</span>
		<span class="o">.</span><span class="na">ifPresent</span><span class="o">(</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"ì´ë¦„ì´ ë„ˆë¬´ ê¹ë‹ˆë‹¤. : "</span> <span class="o">+</span> <span class="n">n</span><span class="o">));</span>
</code></pre></div></div>

<h3 id="map">map</h3>

<ul>
  <li>ê°’ì„ null-safeí•˜ê²Œ ë³€í™˜</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">name</span> <span class="o">=</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"íŒŒì¸ì• í”Œ"</span><span class="o">);</span>
<span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">nameLength</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">String:</span><span class="o">:</span><span class="n">length</span><span class="o">);</span>
<span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"ê²°ê³¼: {}"</span><span class="o">,</span> <span class="n">nameLength</span><span class="o">.</span><span class="na">orElse</span><span class="o">(</span><span class="mi">0</span><span class="o">));</span> <span class="c1">// ê²°ê³¼: 4</span>
</code></pre></div></div>

<h3 id="flatmap">flatMap</h3>

<ul>
  <li>ì¤‘ì²©ëœ Optional í•´ì œ</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// User- &gt; Optional&lt;Profile&gt;ë¥¼ ë°˜í™˜í•˜ëŠ” ë©”ì„œë“œê°€ ìˆì„ ê²½ìš°</span>
<span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="n">user</span> <span class="o">=</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="k">new</span> <span class="nc">User</span><span class="o">());</span>

<span class="nc">String</span> <span class="n">email</span> <span class="o">=</span> <span class="n">user</span>
	<span class="o">.</span><span class="na">flatMap</span><span class="o">(</span><span class="nl">User:</span><span class="o">:</span><span class="n">getProfile</span><span class="o">)</span> <span class="c1">// Optional&lt;Profile&gt;</span>
	<span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">Profile:</span><span class="o">:</span><span class="n">getEmail</span><span class="o">)</span>    <span class="c1">// Optional&lt;String&gt;</span>
	<span class="c1">// mapì„ ì•ˆ ì“°ë©´ Optioanl&lt;Optional&lt;String&gt;&gt;ì´ ë˜ì–´ë²„ë¦¼</span>
	<span class="o">.</span><span class="na">orElse</span><span class="o">(</span><span class="s">"ì´ë©”ì¼ ì •ë³´ ì—†ìŒ"</span><span class="o">);</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h2 id="optional-ì§€ì–‘í•´ì•¼-í• -ì‚¬ìš©ë²•"><strong>Optional ì§€ì–‘í•´ì•¼ í•  ì‚¬ìš©ë²•</strong></h2>

<h3 id="1-ë¬´ë¶„ë³„í•œ-optionalget-ì‚¬ìš©">1. ë¬´ë¶„ë³„í•œ Optional.get() ì‚¬ìš©</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="n">user</span> <span class="o">=</span> <span class="n">userRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="mi">1L</span><span class="o">);</span>
<span class="o">**</span><span class="nc">User</span> <span class="n">u</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="na">get</span><span class="o">();**</span> 
</code></pre></div></div>
<ul>
  <li><code class="language-plaintext highlighter-rouge">Optional.get()</code>ì€ ë‚´ë¶€ì— ê°’ì´ ì—†ì„ ê²½ìš° ëŸ°íƒ€ì„ ì˜ˆì™¸(NoSuchElementException) ë°œìƒí•˜ë©°, null-safeí•˜ê²Œ ì½”ë“œë¥¼ ì‘ì„±í•˜ë ¤ê³  Optionalì„ ì“°ëŠ”ë°, get()ì„ ì“°ë©´ ê·¸ ì˜ë¯¸ê°€ ì‚¬ë¼ì§„ë‹¤.</li>
  <li>isPresent()ì™€ í•¨ê»˜ ì“°ë”ë¼ë„, ìœ ì§€ë³´ìˆ˜ ì¤‘ì— ë³€ê²½ë˜ë©´ ì˜ˆì™¸ ë°œìƒ ê°€ëŠ¥ì„± ì¡´ì¬í•œë‹¤.</li>
</ul>

<p><strong>ğŸ‘ ëŒ€ì•ˆ:</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">userRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="mi">1L</span><span class="o">)</span>
		<span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">CommonException</span><span class="o">(</span><span class="nc">ErrorCode</span><span class="o">.</span><span class="na">NOT_FOUND</span><span class="o">));</span>
</code></pre></div></div>
<ul>
  <li><code class="language-plaintext highlighter-rouge">orElse()</code>ì´ë‚˜ <code class="language-plaintext highlighter-rouge">orElseThrow()</code> ì‚¬ìš©</li>
</ul>

<h3 id="2-í•„ë“œì—--ì‚¬ìš©">2. í•„ë“œì—  ì‚¬ìš©</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">name</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>JPA, Jackson, Hibernate ë“± ì§ë ¬í™”/ì—­ì§ë ¬í™”/ë§¤í•‘ ê³¼ì •ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.</li>
  <li>í•„ë“œëŠ” ì¼ë°˜ì ìœ¼ë¡œ ê°ì²´ì˜ ìƒíƒœë¥¼ í‘œí˜„í•˜ëŠ”ë°, Optionalì€ ê³„ì‚° ê²°ê³¼ë‚˜ ì¡°ê±´ì  ë°˜í™˜ì„ ìœ„í•œ ìš©ë„ë¼ ë§ì§€ ì•ŠëŠ”ê³ , ë©”ëª¨ë¦¬ ë‚­ë¹„ ë° ë¶ˆí•„ìš”í•œ ë˜í•‘ìœ¼ë¡œ ê°€ë…ì„±ì´ ì €í•˜ë  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><strong>ğŸ‘ ëŒ€ì•ˆ:</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
	<span class="kd">public</span> <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">getNameOptional</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">ofNullable</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>í•„ë“œëŠ” ì¼ë°˜ íƒ€ì…ìœ¼ë¡œ ì„ ì–¸, getterì—ì„œ Optionalë¡œ ê°ì‹¸ëŠ” ë°©ì‹ ê¶Œì¥í•œë‹¤.</li>
</ul>

<h3 id="3-íŒŒë¼ë¯¸í„°ë‚˜-ë¦¬í„´ê°’ìœ¼ë¡œ-ì‚¬ìš©">3. íŒŒë¼ë¯¸í„°ë‚˜ ë¦¬í„´ê°’ìœ¼ë¡œ ì‚¬ìš©</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateName</span><span class="o">(</span><span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">name</span><span class="o">)</span> <span class="c1">// ì˜ëª»ëœ ì„¤ê³„</span>
</code></pre></div></div>
<ul>
  <li>Optionalì€ ë©”ì„œë“œ ê²°ê³¼ë¥¼ ê°ì‹¸ê¸° ìœ„í•œ ëª©ì ì´ì§€, ì¸ìë¡œ ì „ë‹¬í•˜ëŠ” ìš©ë„ê°€ ì•„ë‹ˆë©°, ì˜¤íˆë ¤ ì‚¬ìš©í•˜ëŠ” ìª½ì—ì„œ of(), empty() ë“±ì„ ê°•ì œí•˜ê²Œ ë˜ì–´ ë³µì¡ë„ê°€ ì¦ê°€í•œë‹¤.</li>
</ul>

<p><strong>ğŸ‘ ëŒ€ì•ˆ:</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateName</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
	<span class="c1">// ë‚´ë¶€ì—ì„œ Optional.ofNullable(name)ìœ¼ë¡œ ì²˜ë¦¬</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>ë©”ì„œë“œ ì¸ìëŠ” ê¸°ë³¸ íƒ€ì…ìœ¼ë¡œ ë°›ê³ , ë‚´ë¶€ì—ì„œ Optional.ofNullable()ë¡œ ì²˜ë¦¬í•œë‹¤.
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">findById</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">ofNullable</span><span class="o">(...);</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>ë¦¬í„´ íƒ€ì…ìœ¼ë¡œ Optionalì„ ì“°ë©´ â€œê°’ì´ ì—†ì„ ìˆ˜ë„ ìˆë‹¤â€ë¼ëŠ” ì˜ë„ê°€ ëª…í™•í•˜ê²Œ ë“œëŸ¬ë‚˜ë¯€ë¡œ ì¢‹ë‹¤.
<br />
<br /></li>
</ul>

<h2 id="optional-ë‹¨ì ">Optional ë‹¨ì </h2>

<h3 id="1-ì„±ëŠ¥-ì˜¤ë²„í—¤ë“œ">1. ì„±ëŠ¥ ì˜¤ë²„í—¤ë“œ</h3>
<ul>
  <li>Optionalì€ ê²°êµ­ í•˜ë‚˜ì˜ ë˜í¼ ê°ì²´ë¡œ, ê°’ í•˜ë‚˜ë¥¼ ê°ì‹¸ê¸° ìœ„í•´ ê°ì²´ê°€ ì¶”ê°€ë¡œ ìƒì„±ëœë‹¤. íŠ¹íˆ ë¹ˆ Optional ê°ì²´ëŠ” ì¬ì‚¬ìš©ë˜ì§€ë§Œ, ê°’ì´ ìˆì„ ê²½ìš° ë§¤ë²ˆ Optional.of()ë¡œ ìƒˆ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.</li>
  <li>ìì£¼ í˜¸ì¶œë˜ëŠ” ë©”ì„œë“œì—ì„œ Optionalì„ ë‚¨ë°œí•˜ë©´ GCì— ë¶€ë‹´ì´ ì¦ê°€í•˜ê³ , ì„±ëŠ¥ ì €í•˜ ê°€ëŠ¥ì„±ì´ ë†’ì•„ì§„ë‹¤.</li>
</ul>

<h3 id="2-ì²´ì´ë‹ì´-ì§€ë‚˜ì¹˜ë©´-ê°€ë…ì„±-ì €í•˜">2. ì²´ì´ë‹ì´ ì§€ë‚˜ì¹˜ë©´ ê°€ë…ì„± ì €í•˜</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Optional</span><span class="o">.</span><span class="na">ofNullable</span><span class="o">(</span><span class="n">user</span><span class="o">)</span>
    <span class="o">.</span><span class="na">flatMap</span><span class="o">(</span><span class="nl">User:</span><span class="o">:</span><span class="n">getProfile</span><span class="o">)</span>
    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">Profile:</span><span class="o">:</span><span class="n">getEmail</span><span class="o">)</span>
    <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">email</span> <span class="o">-&gt;</span> <span class="n">email</span><span class="o">.</span><span class="na">endsWith</span><span class="o">(</span><span class="s">".com"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">orElse</span><span class="o">(</span><span class="s">"ì´ë©”ì¼ ì—†ìŒ"</span><span class="o">);</span>
</code></pre></div></div>
<ul>
  <li>í•¨ìˆ˜í˜• ìŠ¤íƒ€ì¼ì€ ê¹”ë”í•´ ë³´ì¼ ìˆ˜ ìˆì§€ë§Œ, ìµìˆ™í•˜ì§€ ì•Šì€ ê°œë°œìì—ê² ì˜¤íˆë ¤ ë‚œí•´í•˜ë‹¤. íŠ¹íˆ ì˜ˆì™¸ ì²˜ë¦¬ë‚˜ ì¡°ê±´ ë¶„ê¸°ê°€ ë³µì¡í•  ìˆ˜ë¡ ëª…ë ¹í˜• ì½”ë“œë³´ë‹¤ ì½ê¸° ì–´ë ¤ì›Œì§ˆ ìˆ˜ ìˆë‹¤.
<br />
<br /></li>
</ul>

<h2 id="optionalì„-ì‚¬ìš©í•˜ëŠ”-ë°”ëŒì§í•œ-ìœ„ì¹˜">Optionalì„ ì‚¬ìš©í•˜ëŠ” ë°”ëŒì§í•œ ìœ„ì¹˜</h2>
<p>| ê³„ì¸µ | ì‚¬ìš© ì—¬ë¶€ | ì´ìœ  |
| â€” | â€” | â€” |
| Repository | ë¦¬í„´ê°’ | ì¡°íšŒ ê²°ê³¼ê°€ ì—†ì„ ìˆ˜ ìˆë‹¤ëŠ” ì˜ë„ë¥¼ ëª…í™•íˆ ë“œëŸ¬ëƒ„ |
| Service | ë‚´ë¶€ ì²˜ë¦¬/ë³€í™˜ ì‹œ | Optionalì„ ë°”ë¡œ ì²˜ë¦¬í•´ì„œ ë„ë©”ì¸ ê°ì²´ë¡œ ë³€í™˜í•˜ê±°ë‚˜ ì˜ˆì™¸ ì²˜ë¦¬ |
| Controller | âŒ | ì‘ë‹µ ê°ì²´ëŠ” ëª…í™•í•˜ê³  ë‹¨ìˆœí•œ íƒ€ì…ì´ ë°”ëŒì§í•˜ë¯€ë¡œ Optional ë…¸ì¶œ ì§€ì–‘ |</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Repository</span>
<span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">findById</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">);</span>

<span class="c1">// Service</span>
<span class="kd">public</span> <span class="nc">User</span> <span class="nf">findUserOrThrow</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
	<span class="k">return</span> <span class="n">userRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">id</span><span class="o">)</span>
			<span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">CommonException</span><span class="o">(</span><span class="nc">ErrorCode</span><span class="o">.</span><span class="na">NOT_FOUND_USER</span><span class="o">));</span>
<span class="o">}</span>

<span class="c1">// Controller</span>
<span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/users/{id}"</span><span class="o">)</span>
<span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">UserResponse</span><span class="o">&gt;</span> <span class="nf">getUser</span><span class="o">(</span><span class="nd">@PathVariable</span><span class="o">(</span><span class="s">"id"</span><span class="o">)</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
	<span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">userService</span><span class="o">.</span><span class="na">findUserOrThrow</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
	<span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">ok</span><span class="o">(</span><span class="nc">UserResponse</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">user</span><span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>
<p>â¡ï¸ RepositoryëŠ” Optionalë¡œ ê°ì‹¸ì„œ ë¦¬í„´í•˜ê³ , Serviceì—ì„œ ì²˜ë¦¬í•˜ê³ , Controllerì—ì„œëŠ” ë…¸ì¶œí•˜ì§€ ì•ŠëŠ” ê²ƒì´ ë°”ëŒì§í•˜ë‹¤.
<br />
<br /></p>

<h2 id="optionalê³¼-validationexception-ì²˜ë¦¬">Optionalê³¼ Validation/Exception ì²˜ë¦¬</h2>

<p>**1. Optionalë¡œ ì¡°ê±´ ë¶„ê¸° ì—†ì´ ê¹”ë”í•œ ì˜ˆì™¸ ì²˜ë¦¬ ê°€ëŠ¥í•˜ë‹¤.  **</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">userRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">id</span><span class="o">)</span>
	<span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">CommonException</span><span class="o">(</span><span class="nc">ErrorCode</span><span class="o">.</span><span class="na">NOT_FOUND_USER</span><span class="o">));</span>
</code></pre></div></div>
<ul>
  <li>orElseThrow()ë¥¼ í™œìš©í•˜ë©´ null ì²´í¬ì™€ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ í•œ ì¤„ë¡œ ì²˜ë¦¬ ê°€ëŠ¥í•˜ë‹¤.</li>
</ul>

<p><strong>2. Validationê³¼ì˜ ì—°ê³„ëŠ” Optional ë°–ì—ì„œ ìˆ˜í–‰í•œë‹¤.</strong></p>
<ul>
  <li>ì…ë ¥ê°’ì´ Optionalì¸ ê²½ìš°, Spring Validationì—ì„œëŠ” ì œëŒ€ë¡œ ì²˜ë¦¬ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ìš”ì²­ DTOì—ëŠ” ê¸°ë³¸ íƒ€ì…ìœ¼ë¡œ ì„ ì–¸í•˜ê³ , ì´í›„ ë³€í™˜ ì‹œ Optionalì„ ì‚¬ìš©í•œë‹¤.
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserRequest</span> <span class="o">{</span>
      <span class="nd">@NotBlank</span>
      <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>ë°›ì€ ê°’ì´ nullì¼ ìˆ˜ ìˆë‹¤ë©´, Service ê³„ì¸µì—ì„œ Optional.ofNullable(request.getName())ìœ¼ë¡œ ê°ì‹¸ì„œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ë‚«ë‹¤.
<br />
<br /></li>
</ul>

<h2 id="ë§ˆë¬´ë¦¬">ë§ˆë¬´ë¦¬</h2>
<p>Optionalì€ ì œëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ ê°•ë ¥í•œ null-safe ë„êµ¬ì§€ë§Œ, ëª©ì ì— ë§ì§€ ì•Šê²Œ ì‚¬ìš©í•˜ê±°ë‚˜ ë‚¨ìš©í•  ê²½ìš° ì˜¤íˆë ¤ ê°€ë…ì„±ê³¼ ì„±ëŠ¥ì„ ì €í•˜ì‹œí‚¬ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ë§ì´ ì‚¬ìš©í•  ìˆ˜ë¡ ë°”ëŒì§í•œ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.</p>

<p>âœ… Optionalì€ ë¦¬í„´ì—ë§Œ ì ì ˆí•˜ê²Œ ì‚¬ìš©<br />
âŒ get(), isPresent() ë‚¨ìš© ê¸ˆì§€<br />
ğŸ§© orElseGet(), orElse ì°¨ì´ ìœ ì˜<br /></p>]]></content><author><name>Dajeong Park</name></author><category term="wiki" /><category term="Java" /><category term="Java8" /><category term="Optional" /><summary type="html"><![CDATA[ë°°ê²½ í”„ë¡œì íŠ¸ ì‘ì—… ì¤‘ Optionalì„ ìì£¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ëŠ” ê±¸ ì¸ì§€í•˜ê²Œ ë˜ì—ˆë‹¤. ê¸°ë³¸ ê°œë…ë¶€í„° ì£¼ì˜í•  ì ì„ ë‹¤ì‹œ ì‚´í´ë³´ë‹ˆ, ìƒê°ë³´ë‹¤ ë‹¤ì–‘í•œ ë°©ì‹ìœ¼ë¡œ null-safeí•œ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•˜ë‹¤ëŠ” ê±¸ ì•Œê²Œ ë˜ì—ˆê³ , íë¦„ì„ ë” ëª…í™•í•˜ê²Œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤ëŠ” ì ë„ ì¸ìƒ ê¹Šì—ˆë‹¤. ì´ë²ˆ ê¸°íšŒì— Optionalì„ ì–´ë–»ê²Œ ì“°ëŠ” ê²ƒì´ ë°”ëŒì§í•œì§€, ì‹¤ë¬´ì—ì„œ ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜ëŠ” ë¬´ì—‡ì¸ì§€ ì •ë¦¬í•´ë³´ê³ ì í•œë‹¤.]]></summary></entry><entry><title type="html">ì¡°ê¸ˆ ëŠ¦ì€ ê¸€ë˜ íšŒê³ </title><link href="http://localhost:4000/blog/2025/05/02/review-geultto.html" rel="alternate" type="text/html" title="ì¡°ê¸ˆ ëŠ¦ì€ ê¸€ë˜ íšŒê³ " /><published>2025-05-02T00:00:00+09:00</published><updated>2025-05-02T00:00:00+09:00</updated><id>http://localhost:4000/blog/2025/05/02/review-geultto</id><content type="html" xml:base="http://localhost:4000/blog/2025/05/02/review-geultto.html"><![CDATA[<p><img src="https://dajeongdev.github.io/assets/images/posts/review-geultto.jpeg" /></p>

<p>í•œ ë‹¬ì´ë‚˜ ì§€ë‚˜ì„œ ì‘ì„±í•˜ëŠ” ê¸€ë˜ íšŒê³ ,, ë°˜ì„±í•©ë‹ˆë‹¤.</p>

<p>ê¸€ë˜ëŠ” ë‚´ê°€ ì‘ë…„ì— í•œ ì¼ ì¤‘ ê°€ì¥ ì˜í•œ ì¼ë¡œ ì†ê¼½íŒë‹¤. ì›ë˜ ë§ˆì§€ë§‰ ê¸€ì€ íšŒê³ ê¸€ì„ ì œì¶œí•˜ê³  ì‹¶ì—ˆì§€ë§Œ, ê³µë“¤ì—¬ë³´ê³  ì‹¶ì€ ë§ˆìŒì— ë¯¸ë£¬ë‹¤ëŠ” ê²Œ ì§€ê¸ˆê¹Œì§€ ë¯¸ë£¨ê²Œ ë˜ì—ˆë‹¤.</p>

<p>ê·¸ë ‡ë‹¤ë©´ ë‚´ê°€ ê¸€ë˜ë¥¼ í†µí•´ ë­˜ ë°°ìš°ê³  ì‹¶ì—ˆì„ê¹Œ? ê·¸ê±¸ ì•Œê¸° ìœ„í•´ì„œ ê¸€ë˜ì—ì„œ ì²˜ìŒìœ¼ë¡œ ì‘ì„±í•œ ê¸€ê³¼ ì˜¬í•´ ëª©í‘œë¥¼ ë‹¤ì‹œ ëŒì•„ë³´ì•˜ë‹¤.</p>

<h3 id="ì²«-ë²ˆì§¸-ê¸€ì˜-ë‹¤ì§">ì²« ë²ˆì§¸ ê¸€ì˜ ë‹¤ì§</h3>
<ol>
  <li>ì¢‹ì€ ê¸€ì„ ë§ì´ ë³´ê³  ê¸€ê°ì— ëŒ€í•´ ê³ ë¯¼í•´ë³´ê¸°</li>
  <li>ê¸€ì„ ì“°ëŠ” ì¬ë¯¸ì™€ ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ê°€ê¸°</li>
</ol>

<h3 id="ì˜¬í•´-ëª©í‘œ">ì˜¬í•´ ëª©í‘œ</h3>
<ol>
  <li><strong>ê¸€ë˜ ì°¸ì—¬ìœ¨ ë†’ì´ê¸°</strong></li>
  <li><strong>ê¾¸ì¤€íˆ ê¸€ ì“°ê¸°</strong></li>
  <li><strong>íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ë°”ë¡œë°”ë¡œ</strong></li>
  <li><strong>í…ŒìŠ¤íŠ¸ ì½”ë“œ ë“±ìœ¼ë¡œ ì—­ëŸ‰ ë„“íˆê¸°</strong></li>
  <li><strong>ì½”ë”©í…ŒìŠ¤íŠ¸ ê´€ë ¨ ê³µë¶€</strong></li>
  <li><strong>ì§ˆ ì¢‹ì€ ì˜ì‚¬ì†Œí†µ</strong></li>
  <li><strong>ì¤€ë¹„ëœ ì²´ë ¥</strong></li>
  <li><strong>ë„íŒŒë¯¼ ì¤„ì´ê¸°</strong></li>
</ol>

<p>ë°˜ì€ í•´ë‚´ê³  ë°˜ì€ ê·¸ë ‡ì§€ ëª»í–ˆì§€ë§Œ, ê·¸ë˜ë„ ë‚¨ëŠ” ê²Œ ë” ë§ì•˜ë‹¤.</p>

<p>í™•ì‹¤íˆ ê¸€ë˜ ì‹œì‘ ë•Œë³´ë‹¤ ì˜¬í•´ ë” ë§ì€ ì‚¬ëŒì„ ë§Œë‚˜ê³  ì°¸ì—¬í–ˆê³ , ì˜¬í•´ëŠ” íŒ¨ìŠ¤ ì—†ì´ ê¸€ë„ ëª¨ë‘ ì‘ì„±í–ˆë‹¤.</p>

<p>ê·¸ë¦¬ê³  ì—…ë¬´ë¥¼ ì§„í–‰í•˜ë©´ì„œ í‹ˆí‹ˆì´ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…ì„ ì‘ì„±í•œ ë•ë¶„ì— ê¸€ì„ ì‘ì„±í•˜ëŠ” ê²Œ ë” ìˆ˜ì›”í•˜ê¸°ë„ í–ˆë‹¤.</p>

<p>í…ŒìŠ¤íŠ¸ ì½”ë“œ ê°•ì˜ë„ ë°˜ ì •ë„ëŠ” ë“¤ì—ˆê³ , 2ì›”ë¶€í„°ëŠ” ì„¤ê³„ ìŠ¤í„°ë””ë¥¼ ì§„í–‰í•˜ê³  ìˆëŠ”ë° ë²Œì¨ ê±°ì˜ ë§ˆë¬´ë¦¬ ë‹¨ê³„ê°€ ë‹¤ê°€ì˜¤ê³  ìˆë‹¤. ì¢‹ì€ íŒ€ì›ë“¤ì„ ë§Œë‚˜ì„œ ì–´ë ¤ìš´ ë¶€ë¶„ë„ ë‚˜ë¦„ ì¬ë¯¸ìˆê²Œ ë°°ì›Œê°€ê³  ìˆë‹¤.</p>

<p>ì•„ì‰½ê²Œë„ ì½”ë”©í…ŒìŠ¤íŠ¸ ì¤€ë¹„ëŠ” ì „í˜€ í•˜ì§€ ëª»í–ˆë‹¤,, ì„¤ê³„ ìŠ¤í„°ë””ì— í…ŒìŠ¤íŠ¸ ì½”ë“œ ê°•ì˜ë¥¼ ë“£ê¸°ë„ ë„ˆë¬´ ë°”ë¹´ë‹¤.. 5ì›”ê¹Œì§€ëŠ” ì´ë²ˆ í”„ë¡œì íŠ¸ ë§ˆê°ìœ¼ë¡œ ë°”ì í…Œë‹ˆ 6ì›”ë¶€í„° ìŠ¤í„°ë””ë¥¼ êµ¬í•˜ë“ ì§€ í•´ì„œ ê¼­ ì¤€ë¹„í•´ë´ì•¼ì§€â—ï¸</p>

<p>ì˜ì‚¬ì†Œí†µì— ê´€ë ¨í•´ì„œëŠ” ë§ì€ ìƒê°ì´ ë“¤ì—ˆë‹¤. ì˜ ë§ëŠ” ì‚¬ëŒë“¤ì´ë‘ë§Œ ì¼í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ë‚´ ë§ˆìŒê°€ì§ì„ ê³ ì³ë¨¹ëŠ” ê²Œ ì¤‘ìš”í–ˆë‹¤. ì£¼ì–´ë¥¼ ì–˜ê¸°í•´ì£¼ì§€ ì•Šê±°ë‚˜ ë¶ˆëª…í™•í•˜ê²Œ ì–˜ê¸°í•´ì£¼ì‹œëŠ” ë¶€ë¶„ì— ëŒ€í•´ì„œ ì •í™•í•˜ê²Œ ì–˜ê¸°í•´ë‹¬ë¼ê³  ë§ì”€ë“œë¦¬ê³ , ë‚´ê°€ ëª¨ë¥´ëŠ” ë¶€ë¶„ì€ ëª¨ë¥¸ë‹¤ê³  ë¹¨ë¦¬ ì¸ì •í•˜ê³  ì–˜ê¸°í•˜ëŠ” ê²ƒ. ì¼ë‹¨ ì´ê²ƒë¶€í„° í•˜ê³  ìˆë‹¤. ì¢‹ì€ ì˜ì‚¬ì†Œí†µì— ê´€ë ¨í•´ì„œëŠ” ì˜¬í•´ ê³„ì† ìƒê°ì„ ë§Œë“¤ì–´ê°€ë³´ë ¤ê³  í•œë‹¤.</p>

<p>ìš´ë™ì€ ì˜¬í•´ ì˜í•˜ê³  ìˆëŠ” ë¶€ë¶„ ì¤‘ í•˜ë‚˜ì¸ë°, í•„ë¼í…ŒìŠ¤ë¥¼ ëë‚´ê³  PTë¥¼ ì‹œì‘í–ˆë‹¤. ë‚˜ë¦„ ì˜ ë°°ìš°ê³  ìˆì§€ë§Œ, ê·¼ìœ¡ëŸ‰ì´ ì‰½ê²Œ ëŠ˜ì§€ ì•ŠëŠ” ê²ƒì— ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ë°›ì§€ ì•Šìœ¼ë ¤ê³  ë…¸ë ¥í•˜ê³  ìˆë‹¤. PTìŒ¤ ë•ë¶„ì— 10km ë ˆì´ìŠ¤ë„ ì²˜ìŒ ë‚˜ê°€ë´¤ëŠ”ë°, ì¬ë¯¸ìˆì—ˆì§€ë§Œ ì‚¬ëŒë“¤ì´ ë„ˆë¬´ ë§ì•„ì„œ ìì£¼ëŠ” ëª»í•  ê²ƒ ê°™ë‹¤.. ì´ì œ ë‚ ì”¨ë„ ì¢‹ì•„ì¡Œìœ¼ë‹ˆ ì›¨ì´íŠ¸ì™€ ëŸ¬ë‹ì„ ì ì ˆíˆ ì„ì–´ì„œ ë” ì¢‹ì€ ì²´ë ¥ì„ ë§Œë“¤ì–´ë´ì•¼ì§€.</p>

<p>ë„íŒŒë¯¼ ì¤„ì´ê¸°ë„ ë‚˜ë¦„ ì˜í•´ëƒˆë‹¤. í•¸ë“œí° ê²Œì„ë„ ì‚­ì œí–ˆê³ , ì¶œí‡´ê·¼ê¸¸ì— ë§í•´ë³´ì¹´ì™€ ë…ì„œë¥¼ í•˜ë©´ì„œ ì˜¬í•´ ë²Œì¨ 6ê¶Œì˜ ì±…ì„ ì½ì—ˆë‹¤. ë˜ ê¸€ë˜ ë…ì„œëª¨ì„ë„ ë•ë¶„ì— ì•ˆ ì½ì–´ë³¼ ë²•í•œ ì±…ë„ ì½ê²Œ ë˜ì–´ì„œ ë„ˆë¬´ ì¬ë¯¸ìˆë‹¤.
<br />
<br /></p>

<h3 id="ê¸€-ëª©ë¡">ê¸€ ëª©ë¡</h3>
<p>ì²˜ìŒ ëª©í‘œëŠ” íŒ¨ìŠ¤ í•˜ë‚˜ë„ ì•ˆ ì“°ê¸°ì˜€ëŠ”ë°.. ğŸ¥¹ 1ë²ˆì˜ íŒ¨ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³ , 1ë²ˆì€ ê¸€ ì œì¶œ ë§ˆê°ì¼ë‚  ë²„ì €ë¹„í„°ë¥¼ ëˆ„ë¥´ë ¤ë‹¤ê°€ ì‹¤íŒ¨í•´ì„œ ë¯¸ì œì¶œì´ ë˜ì—ˆë‹¤.. ğŸ’¦ ë‚´ ì—…ë³´ì´ë‹ˆë¼â€¦</p>

<ul>
  <li>ê¸°ìˆ /ì–¸ì–´ ê´€ë ¨ <strong>8ê°œ</strong></li>
  <li>íšŒê³  ê´€ë ¨ ê¸€ <strong>2ê°œ</strong></li>
</ul>

<p>ê·¸ë˜ì„œ ì´ë²ˆ ê¸€ë˜ í™œë™ì„ í†µí•´ 10ê°œì˜ ê¸€ì„ ì œì¶œí–ˆëŠ”ë°, ëŒì•„ë³´ë‹ˆ íšŒê³ ê¸€ì´ ìƒê°ë³´ë‹¤ ì ì–´ì„œ ì˜ì™¸ì˜€ë‹¤. íë ˆì´ì…˜ì— í•œ ë²ˆì´ë¼ë„ ì„ ì •ë˜ê³  ì‹¶ì—ˆìœ¼ë‚˜, ì„ ì •ë˜ëŠ” ê¸€ì„ ë³´ë‹ˆ ì •ë§ì •ë§ ì˜ ì“°ì‹œëŠ” ë¶„ë“¤ì´ë¼ ì˜¤íˆë ¤ ë‚˜ë„ ì•ìœ¼ë¡œ ê·¸ëŸ° ê¸€ì„ ì“¸ ìˆ˜ ìˆë„ë¡ ë…¸ë ¥í•´ì•¼ê² ë‹¤ëŠ” ìƒê°ì´ ë§ì´ ë“¤ì—ˆë‹¤.
<br />
<br /></p>

<h3 id="ê¸€ë˜-í›„ê¸°">ê¸€ë˜ í›„ê¸°</h3>
<p>4ì›”ì— í•œ ê°œë„ ì“°ì§€ ëª»í•´ì„œ ê¸€ ì“°ëŠ” ìŠµê´€ì´ ë“¤ì—ˆë‹¤ê³  í•˜ê¸° ë¯¼ë§í•˜ì§€ë§Œ, ê·¸ë˜ë„ ê¸€ë˜ ë•ë¶„ì— ê¸€ì— ëŒ€í•œ ì¢‹ì€ ì¸ì‹ì´ ìƒê²¼ë‹¤. ë§ˆëƒ¥ ì–´ë µê³  ë§‰ë§‰í•˜ê¸°ë§Œ í–ˆëŠ”ë°, ì´ì œ ì¡°ê¸ˆì€ ì–´ë–»ê²Œ ì¨ì•¼í• ì§€ ì•Œê²Œ ë˜ì—ˆê³ , ë¬´ì—‡ë³´ë‹¤ ì˜ ì“°ê³  ì‹¶ì€ ë§ˆìŒì´ ë“¤ì–´ ì•ìœ¼ë¡œ ê¸€ ì“°ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ë§ì´ ê³ ë¯¼í•˜ê³  ì•Œì•„ë³¼ ê²ƒì´ë‹¤.</p>

<p>ë¬´ì—‡ë³´ë‹¤ ê¸€ë˜ë¥¼ í†µí•´ ì‚¬ëŒë“¤ê³¼ ë§Œë‚˜ë©´ì„œ í™•ì‹¤íˆ ë™ê¸°ë¶€ì—¬ë¥¼ ë§ì´ ì–»ì—ˆë‹¤. ì˜ˆìƒë³´ë‹¤ ë§ì€ í™œë™ì„ í•˜ì§€ ì•Šì•˜ì§€ë§Œ, ë‹¤ì§„ë§ˆëŠ˜ì„ í†µí•´ ì„¸ìš´ ê³„íšë“¤ë„ ë§ì´ í•´ëƒˆê³  ë‹¬ë¦¬ë˜ì—ëŠ” ê°€ë” ê¸€ì„ ì˜¬ë ¤ë„ ë§ì€ ë¶„ë“¤ì´ ì‘ì›ì„ í•´ì£¼ì…”ì„œ í˜ì´ ë‚¬ë‹¤. ë˜ ì‚¶ì˜ ì§€ë˜ë¥¼ í†µí•´ ë‚´ ì‚¶ì„ ë‹¤ì‹œ ëŒì•„ë³´ë©´ì„œ ë‚´ê°€ ì–´ë–»ê²Œ ì‚´ì•„ì™”ëŠ”ì§€, ë‚´ ê°€ì¹˜ê´€ì€ ì–´ë–»ê²Œ í˜•ì„±ë˜ì—ˆëŠ”ì§€, ë˜ ë‚´ê²Œ ë¬´ì—‡ì´ ì¤‘ìš”í•œì§€ ë“± ë‚˜ ìì‹ ì— ëŒ€í•´ ë§ì´ ëŒì•„ë³¼ ìˆ˜ ìˆì–´ì„œ ë„ˆë¬´ ì†Œì¤‘í•œ ê²½í—˜ì´ ë˜ì—ˆë‹¤. ì§€ê¸ˆ ì§„í–‰ ì¤‘ì¸ ì„¤ê³„ ìŠ¤í„°ë””ë„ ê¸€ë˜ í™ë³´ ê¸€ì— ì˜¬ë ¤ì£¼ì…”ì„œ í•  ìˆ˜ ìˆì—ˆê³ , ì˜¬í•´ ê°€ì¥ í˜ë“¤ ë•Œ ì—…ê·¸ë ˆì´ë˜ ì»¤í”¼ì±— ë•ë¶„ì— ë¹¨ë¦¬ í„¸ì–´ë²„ë¦´ ìˆ˜ ìˆì—ˆë‹¤. ì´ê³³ì—ì„œ ë§Œë‚œ ì¸ì—°ë“¤ì´ ì˜¤ë˜ ì§€ì†ë  ìˆ˜ ìˆë„ë¡ ë‚˜ë„ ë§ì´ ë…¸ë ¥í•´ì•¼ì§€.</p>

<p>ê¸€ë˜ì— ê°€ì…í–ˆì„ ë•Œì˜ ê¸°ëŒ€ë³´ë‹¤ ë” ë§ì€ ê±¸ ì–»ì–´ì„œ ë‚˜ë„ ì•ìœ¼ë¡œ ì´ ì—…ê³„ì—ì„œ ì¢‹ì€ ì˜í–¥ë ¥ì„ ì£¼ê³ ë°›ì„ ìˆ˜ ìˆìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ëª©í‘œë„ ìƒê²¼ë‹¤. ì•„ì§ ë‚´ê°€ ì§ì—…ì ìœ¼ë¡œ ë­˜ ì˜í•˜ëŠ”ì§€ ì˜ ëª¨ë¥´ê² ì§€ë§Œ ê·¸ëŸ° ë¶€ë¶„ì„ ë¹¨ë¦¬ íŒŒì•…í•´ì„œ ë‹¤ë¥¸ ì‚¬ëŒë“¤ì—ê²Œ ë„ì›€ì„ ì¤„ ìˆ˜ ìˆìœ¼ë©´ ì¢‹ê² ë‹¤.</p>

<p>ë§ˆì§€ë§‰ìœ¼ë¡œ ê¸€ë˜ì—ì„œ í™œë™í•´ì£¼ì‹  ëª¨ë“  ë¶„ë“¤ ë•ë¶„ì— ìƒë°˜ê¸° ì—´ì‹¬íˆ ì„±ì¥í•œ ê²ƒ ê°™ì•„ì„œ ë„ˆë¬´ ê°ì‚¬ë“œë¦°ë‹¤ëŠ” ë§ì„ ì „í•´ë“œë¦¬ê³  ì‹¶ìŠµë‹ˆë‹¤! ğŸ«¶</p>]]></content><author><name>Dajeong Park</name></author><category term="blog" /><category term="ê¸€ë˜" /><category term="íšŒê³ " /><summary type="html"><![CDATA[]]></summary></entry><entry><title type="html">Spring @Transactionalì„ ì •ë§ ì œëŒ€ë¡œ ì“°ê³  ìˆëŠ” ê±¸ê¹Œ?</title><link href="http://localhost:4000/wiki/2025/03/28/spring-transactional-annotation.html" rel="alternate" type="text/html" title="Spring @Transactionalì„ ì •ë§ ì œëŒ€ë¡œ ì“°ê³  ìˆëŠ” ê±¸ê¹Œ?" /><published>2025-03-28T00:00:00+09:00</published><updated>2025-03-28T00:00:00+09:00</updated><id>http://localhost:4000/wiki/2025/03/28/spring-transactional-annotation</id><content type="html" xml:base="http://localhost:4000/wiki/2025/03/28/spring-transactional-annotation.html"><![CDATA[<p>ìš°ë¦¬ëŠ” ìˆ˜ë§ì€ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ìˆ˜ì •í•˜ë©°, ê·¸ ê³¼ì •ì—ì„œ ë°ì´í„°ì˜ ë¬´ê²°ì„±ì„ ë³´ì¥í•˜ëŠ” ê²ƒì´ ì–¼ë§ˆë‚˜ ì¤‘ìš”í•œì§€ ê¹¨ë‹«ê²Œ ëœë‹¤. íŠ¹íˆ JPAì™€ Springì„ í™œìš©í•˜ëŠ” í™˜ê²½ì—ì„œëŠ” íŠ¸ëœì­ì…˜ì„ ì œëŒ€ë¡œ ê´€ë¦¬í•˜ì§€ ì•Šìœ¼ë©´ ì˜ˆìƒì¹˜ ëª»í•œ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.<br />
JPAë¥¼ ì²˜ìŒ ì ‘í–ˆì„ ë•Œ, ì—”í‹°í‹°ì˜ ê°’ì„ ë°”ê¾¸ë©´ ìë™ìœ¼ë¡œ UPDATE ì¿¼ë¦¬ê°€ ë‚˜ê°€ëŠ” ê²Œ ê½¤ ì‹ ê¸°í–ˆë‹¤. ê·¸ëŸ°ë° ë§‰ìƒ ì‹¤ë¬´ì—ì„œ ì½”ë“œë¥¼ ì‘ì„±í•˜ë‹¤ ë³´ë©´ â€œì™œ ì—…ë°ì´íŠ¸ê°€ ì•ˆ ë˜ì§€?â€, â€œì™œ ë°ì´í„°ê°€ ë°˜ì˜ë˜ì§€ ì•Šì•˜ì§€?â€ í•˜ëŠ” ìˆœê°„ë“¤ì„ ê²ªê²Œ ëœë‹¤.<br />
ê·¸ëŸ° ê²½í—˜ì„ í†µí•´ JPAì˜ ë³€ê²½ ê°ì§€ê°€ íŠ¸ëœì­ì…˜ ë²”ìœ„ ë‚´ì—ì„œë§Œ ë™ì‘í•œë‹¤ëŠ” ì ì„ ì•Œê²Œ ë˜ê³ , ê²°êµ­ @Transactional ì• ë…¸í…Œì´ì…˜ì˜ í•„ìš”ì„±ì„ ì²´ê°í•˜ê²Œ ëœë‹¤. ë˜ @Transactional(readOnly = true) ì˜µì…˜ì„ í™œìš©í•˜ë©´ ì¡°íšŒ ì„±ëŠ¥ì„ ìµœì í™”í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒë„ ì•Œê²Œ ëë‹¤.<br />
ê²°êµ­ ì¤‘ìš”í•œ ê±´ ë‹¨ìˆœíˆ @Transactionalì„ ë¶™ì´ëŠ” ê²Œ ì•„ë‹ˆë¼, íŠ¸ëœì­ì…˜ì´ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ë¥¼ ì´í•´í•˜ê³ , ìƒí™©ì— ë§ëŠ” ì˜µì…˜ì„ ì ìš©í•˜ëŠ” ê²ƒì´ë‹¤.
<br />
<br /></p>

<h3 id="trasaction">Trasaction</h3>
<p>Springì—ì„œëŠ” íŠ¸ëœì­ì…˜ ì²˜ë¦¬ë¥¼ ê°„í¸í•˜ê²Œ í•˜ê¸° ìœ„í•´ <code class="language-plaintext highlighter-rouge">@Transactional</code> ì• ë…¸í…Œì´ì…˜ì„ ì œê³µí•œë‹¤. ë³¸ê²©ì ìœ¼ë¡œ ì´ ì• ë…¸í…Œì´ì…˜ì„ ì‚´í´ë³´ê¸° ì „ì—, ë¨¼ì € íŠ¸ëœì­ì…˜ ìì²´ì— ëŒ€í•´ ê°„ë‹¨íˆ ì§šê³  ë„˜ì–´ê°€ì.
íŠ¸ëœì­ì…˜(Transaction)ì€ ì‚¬ì „ì ìœ¼ë¡œëŠ” â€˜ê±°ë˜â€™ë¼ëŠ” ëœ»ì´ì§€ë§Œ, ê°œë°œì—ì„œëŠ” ë°ì´í„°ë¥¼ ì¼ê´€ì„± ìˆê²Œ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ì‘ì—… ë‹¨ìœ„ë¡œ ì´í•´í•˜ë©´ ëœë‹¤.
<br /></p>

<h4 id="ì˜ˆì‹œ">ì˜ˆì‹œ</h4>
<p>ì˜ˆë¥¼ ë“¤ì–´, ì†ë‹˜ì´ í‚¤ì˜¤ìŠ¤í¬ë¡œ ì•„ë©”ë¦¬ì¹´ë…¸ë¥¼ í•œ ì” ì£¼ë¬¸í–ˆë‹¤ê³  í•´ë³´ì. 
ë‚´ë¶€ì ìœ¼ë¡œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì‘ì—…ì´ ìˆœì„œëŒ€ë¡œ ì¼ì–´ë‚œë‹¤.</p>
<ol>
  <li>ì•„ë©”ë¦¬ì¹´ë…¸ ì¬ê³  í™•ì¸</li>
  <li>ì†ë‹˜ì˜ ì¹´ë“œ ê³„ì¢Œì—ì„œ ì”ì•¡ í™•ì¸</li>
  <li>ê³„ì¢Œì—ì„œ ì•„ë©”ë¦¬ì¹´ë…¸ ê°€ê²©ë§Œí¼ ì°¨ê°</li>
  <li>ì•„ë©”ë¦¬ì¹´ë…¸ ì¬ê³  ì°¨ê°</li>
  <li>ì£¼ë¬¸ ì™„ë£Œ, ì˜ìˆ˜ì¦ ì¶œë ¥</li>
</ol>

<p>ì´ ëª¨ë“  ì‘ì—…ì€ <strong>ëª¨ë‘ ì„±ê³µí•˜ê±°ë‚˜, í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•˜ë©´ ì „ì²´ê°€ ì·¨ì†Œ</strong>ë˜ì–´ì•¼ í•œë‹¤. 
ê·¸ë˜ì•¼ ì†ë‹˜ì˜ ëˆë§Œ ë¹ ì ¸ë‚˜ê°€ê³  ìŒë£Œê°€ ë‚˜ì˜¤ì§€ ì•ŠëŠ” ìƒí™©ì„ ë°©ì§€í•  ìˆ˜ ìˆë‹¤. 
ì´ì²˜ëŸ¼ í•˜ë‚˜ì˜ ë‹¨ìœ„ë¡œ ë¬¶ì—¬ ì²˜ë¦¬ë¼ì•¼ í•˜ëŠ” ì‘ì—…ì„ â€˜<strong>íŠ¸ëœì­ì…˜â€™</strong>ì´ë¼ê³  í•œë‹¤.<br />
<br /></p>

<h4 id="íŠ¸ëœì­ì…˜ì˜-4ê°€ì§€-íŠ¹ì§•-acid">íŠ¸ëœì­ì…˜ì˜ 4ê°€ì§€ íŠ¹ì§• (ACID)</h4>
<ol>
  <li><strong>ì›ìì„±(Atomicity)</strong>
<br />
- ëª¨ë“  ì‘ì—…ì€ ì „ë¶€ ì„±ê³µí•˜ê±°ë‚˜ ì „ë¶€ ì‹¤íŒ¨í•´ì•¼ í•œë‹¤.</li>
  <li><strong>ì¼ê´€ì„±(Consistency)</strong>
<br />
- íŠ¸ëœì­ì…˜ ì „í›„ë¡œ ë°ì´í„°ëŠ” í•­ìƒ ìœ íš¨í•œ ìƒíƒœì—¬ì•¼ í•œë‹¤. (ì˜ˆ: ì¬ê³ ê°€ ìŒìˆ˜ê°€ ë˜ë©´ ì•ˆ ë¨)</li>
  <li><strong>ê²©ë¦¬ì„±(Isolation)</strong>
<br />
- ë™ì‹œì— ì—¬ëŸ¬ íŠ¸ëœì­ì…˜ì´ ì‹¤í–‰ë˜ì–´ë„ ì„œë¡œ ê°„ì„­í•˜ì§€ ì•Šì•„ì•¼ í•œë‹¤.</li>
  <li><strong>ì§€ì†ì„±(Durability)</strong>
<br />
- íŠ¸ëœì­ì…˜ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ë©´ ê·¸ ê²°ê³¼ëŠ” ì˜êµ¬ì ìœ¼ë¡œ ë°˜ì˜ë˜ì–´ì•¼ í•œë‹¤.
<br />
<br /></li>
</ol>

<h3 id="transactional-ì• ë…¸í…Œì´ì…˜">@Transactional ì• ë…¸í…Œì´ì…˜</h3>
<p>Springì—ì„œëŠ” <code class="language-plaintext highlighter-rouge">@Transactional</code>ì„ í†µí•´ íŠ¸ëœì­ì…˜ì„ ì„ ì–¸ì ìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤. ì´ ì• ë…¸í…Œì´ì…˜ì„ ë¶™ì´ë©´, ë©”ì„œë“œ ì‹¤í–‰ ì „í›„ë¡œ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ê³  ì»¤ë°‹í•˜ê±°ë‚˜ ë¡¤ë°±í•˜ëŠ” ë™ì‘ì„ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•´ì¤€ë‹¤.</p>

<h4 id="ë™ì‘-ë°©ì‹">ë™ì‘ ë°©ì‹</h4>
<p>Springì˜ <code class="language-plaintext highlighter-rouge">@Transactional</code>ì€ AOP(ê´€ì  ì§€í–¥ í”„ë¡œê·¸ë˜ë°) ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•œë‹¤. ì •í™•íˆëŠ” í”„ë¡ì‹œ ê°ì²´ê°€ ìƒì„±ë˜ê³ , ì´ í”„ë¡ì‹œê°€ ë©”ì„œë“œ ì‹¤í–‰ ì „í›„ë¡œ íŠ¸ëœì­ì…˜ì„ ê´€ë¦¬í•œë‹¤.</p>
<ol>
  <li><code class="language-plaintext highlighter-rouge">@Transactional</code>ì´ ë¶™ì€ ë©”ì„œë“œ í˜¸ì¶œ</li>
  <li>í”„ë¡ì‹œê°€ íŠ¸ëœì­ì…˜ ì‹œì‘</li>
  <li>ë©”ì„œë“œ ì‹¤í–‰</li>
  <li>ì˜ˆì™¸ ì—†ìœ¼ë©´ ì»¤ë°‹, ì˜ˆì™¸ ë°œìƒ ì‹œ ë¡¤ë°±</li>
</ol>

<p>ë‹¨, ì´ êµ¬ì¡° ë•Œë¬¸ì— <strong>ìê¸° ìì‹  ë‚´ë¶€ì—ì„œ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ íŠ¸ëœì­ì…˜ì´ ì ìš©ë˜ì§€ ì•ŠëŠ”</strong> ë¬¸ì œê°€ ìˆë‹¤.
<br />
<br /></p>

<h3 id="ì£¼ìš”-ì˜µì…˜">ì£¼ìš” ì˜µì…˜</h3>

<table>
  <thead>
    <tr>
      <th>ì˜µì…˜</th>
      <th>ì„¤ëª…</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">propagation</code></td>
      <td>íŠ¸ëœì­ì…˜ ì „íŒŒ ë°©ì‹ (ì˜ˆ: <code class="language-plaintext highlighter-rouge">REQUIRED</code>, <code class="language-plaintext highlighter-rouge">REQUIRES_NEW</code>, <code class="language-plaintext highlighter-rouge">NESTED</code> ë“±)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">isolation</code></td>
      <td>íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ (<code class="language-plaintext highlighter-rouge">READ_COMMITTED</code>, <code class="language-plaintext highlighter-rouge">SERIALIZABLE</code> ë“±)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">rollbackFor</code></td>
      <td>ì–´ë–¤ ì˜ˆì™¸ ë°œìƒ ì‹œ ë¡¤ë°±í• ì§€ ì§€ì • (ê¸°ë³¸ì€ <code class="language-plaintext highlighter-rouge">RuntimeException</code>ê³¼ <code class="language-plaintext highlighter-rouge">Error</code>ë§Œ ë¡¤ë°±)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">readOnly</code></td>
      <td>ì½ê¸° ì „ìš© íŠ¸ëœì­ì…˜ ì—¬ë¶€ (ì¿¼ë¦¬ ìµœì í™”ì— ì‚¬ìš©)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">timeout</code></td>
      <td>íŠ¸ëœì­ì…˜ ì œí•œ ì‹œê°„ ì´ˆê³¼ ì‹œ ë¡¤ë°±</td>
    </tr>
  </tbody>
</table>

<h4 id="readonly--true">readOnly = true</h4>
<p>ì¡°íšŒë§Œ ìˆ˜í–‰í•˜ëŠ” ë©”ì„œë“œë¼ë©´ <code class="language-plaintext highlighter-rouge">@Transactional(readOnly = true)</code> ì„¤ì •ì„ í†µí•´ ì„±ëŠ¥ì„ ìµœì í™”í•  ìˆ˜ ìˆë‹¤. ì´ ì„¤ì •ì´ ìˆìœ¼ë©´ JPAëŠ” ë³€ê²½ ê°ì§€(Dirt Checking)ë¥¼ ìœ„í•œ ìŠ¤ëƒ…ìƒ·ì„ ì €ì¥í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ë¶ˆí•„ìš”í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì¤„ì¼ ìˆ˜ ìˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Transactional</span><span class="o">(</span><span class="n">readOnly</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="c1">// ì¡°íšŒ ì„±ëŠ¥ ìµœì í™”</span>
<span class="kd">public</span> <span class="nc">Book</span> <span class="nf">findBook</span><span class="o">(</span><span class="nc">Long</span> <span class="n">bookId</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">bookRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">bookId</span><span class="o">).</span><span class="na">orElseThrow</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>í´ë˜ìŠ¤ ì „ì²´ì— ì„¤ì •í•  ìˆ˜ë„ ìˆê³ , ë©”ì„œë“œ ë‹¨ìœ„ë¡œ ì˜¤ë²„ë¼ì´ë“œë„ ê°€ëŠ¥í•˜ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="nd">@Transactional</span><span class="o">(</span><span class="n">readOnly</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="c1">// ëª¨ë“  ë©”ì„œë“œ ì¡°íšŒ ì „ìš©</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BookService</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nc">Book</span> <span class="nf">findBook</span><span class="o">(</span><span class="nc">Long</span> <span class="n">bookId</span><span class="o">)</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>

    <span class="nd">@Transactional</span> <span class="c1">// ì´ ë©”ì„œë“œëŠ” readOnly ì ìš©ë˜ì§€ ì•ŠìŒ</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateBook</span><span class="o">(</span><span class="nc">Long</span> <span class="n">bookId</span><span class="o">,</span> <span class="nc">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="ì‹¤ë¬´ì—ì„œ-ì£¼ì˜í• -ì "><strong>ì‹¤ë¬´ì—ì„œ ì£¼ì˜í•  ì </strong></h3>
<h4 id="1-ìê¸°-ìì‹ ì„-í˜¸ì¶œí•˜ëŠ”-ë©”ì„œë“œëŠ”-íŠ¸ëœì­ì…˜ì´-ì ìš©ë˜ì§€-ì•ŠìŒ">1. <strong>ìê¸° ìì‹ ì„ í˜¸ì¶œí•˜ëŠ” ë©”ì„œë“œëŠ” íŠ¸ëœì­ì…˜ì´ ì ìš©ë˜ì§€ ì•ŠìŒ</strong></h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderService</span> <span class="o">{</span>

    <span class="nd">@Transactional</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">outerMethod</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">innerMethod</span><span class="o">();</span> <span class="c1">// íŠ¸ëœì­ì…˜ ì ìš©ë˜ì§€ ì•ŠìŒ</span>
    <span class="o">}</span>

    <span class="nd">@Transactional</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">innerMethod</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// ì‹¤ì œ íŠ¸ëœì­ì…˜ ì ìš©ë˜ì§€ ì•ŠìŒ (í”„ë¡ì‹œë¥¼ ê±°ì¹˜ì§€ ì•ŠìŒ)</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>â“ @Transactionalì€ í”„ë¡ì‹œ ê¸°ë°˜ì´ê¸° ë•Œë¬¸ì—, ì´ í”„ë¡ì‹œê°€ ë©”ì„œë“œ í˜¸ì¶œì„ ê°€ë¡œì±„ì„œ íŠ¸ëœì­ì…˜ì„ ê´€ë¦¬í•œë‹¤. í•˜ì§€ë§Œ ë™ì¼í•œ í´ë˜ìŠ¤ ë‚´ì—ì„œ ë©”ì„œë“œê°€ ìê¸° ìì‹ ì„ í˜¸ì¶œí•˜ëŠ” ê²½ìš°ì—ëŠ” ìê¸° í˜¸ì¶œ(Self-Invocation)ë¡œ ì¸ì‹ë˜ì–´ í”„ë¡ì‹œë¥¼ ê±°ì¹˜ì§€ ì•Šê¸° ë•Œë¬¸ì— innerMethod()ì˜ íŠ¸ëœì­ì…˜ì€ ì²˜ë¦¬ë˜ì§€ ì•ŠëŠ”ë‹¤.
<strong>â¡ï¸</strong> innerMethodë¥¼ ë³„ë„ í´ë˜ìŠ¤/ë¹ˆìœ¼ë¡œ ë¶„ë¦¬í•˜ê±°ë‚˜, <code class="language-plaintext highlighter-rouge">AopContext.currentProxy()</code>ë¡œ ì§ì ‘ í˜¸ì¶œ (ë¹„ì¶”ì²œ)</p>

<h4 id="2-ê¸°ë³¸-ë¡¤ë°±-ëŒ€ìƒì€-runtimeexceptionë§Œ-ê°€ëŠ¥í•˜ë‹¤">2. ê¸°ë³¸ ë¡¤ë°± ëŒ€ìƒì€ RuntimeExceptionë§Œ ê°€ëŠ¥í•˜ë‹¤.</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">doSomething</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="o">();</span> <span class="c1">// ë¡¤ë°±ë˜ì§€ ì•ŠìŒ</span>
<span class="o">}</span>
</code></pre></div></div>
<p>â“ ì¼ë°˜ì ì¸ Exceptionì´ë‚˜ CheckedExceptionì€ ê¸°ë³¸ì ìœ¼ë¡œ ë¡¤ë°± ëŒ€ìƒì´ ì•„ë‹ˆë‹¤.
<strong>â¡ï¸</strong> <code class="language-plaintext highlighter-rouge">@Transactional(rollbackFor = Exception.class)</code> ê°™ì´ ëª…ì‹œì ìœ¼ë¡œ ì§€ì •</p>

<h4 id="3-ì¤‘ì²©-íŠ¸ëœì­ì…˜-nested-transaction">3. ì¤‘ì²© íŠ¸ëœì­ì…˜ (Nested Transaction)</h4>
<p><code class="language-plaintext highlighter-rouge">REQUIRES_NEW</code>ëŠ” ê¸°ì¡´ íŠ¸ëœì­ì…˜ì„ ì¤‘ë‹¨í•˜ê³  ìƒˆ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ëŠ” ë°©ì‹ì´ë‹¤. ì´ëŠ” ì‹¤ì œ ì¤‘ì²© íŠ¸ëœì­ì…˜(NESTED)ê³¼ëŠ” ë‹¤ë¥´ë©°, êµ¬í˜„ì²´ì— ë”°ë¼ ì§€ì› ì—¬ë¶€ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤. ì„±ëŠ¥ì´ë‚˜ ë¡¤ë°± ë²”ìœ„ì— ì£¼ì˜ê°€ í•„ìš”í•˜ë‹¤.</p>

<h4 id="4-readonly--true-ì„¤ì •">4. readOnly = true ì„¤ì •</h4>
<p>readOnly ì„¤ì •ì´ ìˆëŠ” íŠ¸ëœì­ì…˜ ì•ˆì—ì„œ <code class="language-plaintext highlighter-rouge">INSERT</code>, <code class="language-plaintext highlighter-rouge">UPDATE</code> ë“±ì˜ ì‘ì—…ì„ í•˜ë©´ DB ì¢…ë¥˜ì— ë”°ë¼ ì—ëŸ¬ê°€ ë‚˜ê±°ë‚˜ ë¬´ì‹œë  ìˆ˜ ìˆë‹¤. ê¼­ ì¡°íšŒ ì „ìš© ë©”ì„œë“œì—ì„œë§Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.
<br />
<br /></p>

<h3 id="insight--thoughts">insight &amp; thoughts</h3>
<p>ì²˜ìŒì—ëŠ” ê·¸ëƒ¥ ì• ë…¸í…Œì´ì…˜ í•˜ë‚˜ ë¶™ì´ë©´ ë˜ëŠ” ê±° ì•„ë‹Œê°€?ë¼ê³  ìƒê°í–ˆì§€ë§Œ, ì‹¤ë¬´ì—ì„œ ì§ì ‘ íŠ¸ëœì­ì…˜ ì´ìŠˆë¥¼ ê²ªë‹¤ ë³´ë©´ ì´ê²Œ ì™œ í•„ìš”í•œì§€ë¥¼ ì²´ê°í•˜ê²Œ ëœë‹¤. íŠ¹íˆ, JPAì˜ ë³€ê²½ ê°ì§€, íŠ¸ëœì­ì…˜ ê²½ê³„, readOnly ìµœì í™”, ë¡¤ë°± ë™ì‘ ë°©ì‹ì„ ì´í•´í•˜ë©´ ë‹¨ìˆœíˆ ë™ì‘í•˜ëŠ” ì½”ë“œë¥¼ ë„˜ì–´ì„œ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì½”ë“œë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤. ì´ì œëŠ” íŠ¸ëœì­ì…˜ì„ ë‹¨ìˆœí•œ ê¸°ìˆ  ìš”ì†Œê°€ ì•„ë‹ˆë¼, ë°ì´í„° ì •í•©ì„±ì„ ì§€í‚¤ê¸° ìœ„í•œ ê°œë…ìœ¼ë¡œ ë°›ì•„ë“¤ì´ê²Œ ëœ ê²ƒ ê°™ë‹¤.
<br />
<br />
<br /></p>

<p><strong>ì°¸ê³ </strong></p>
<ul>
  <li><a href="https://docs.spring.io/spring-framework/reference/data-access/transaction/declarative/annotations.html">Spring ê³µì‹ ë¬¸ì„œ</a></li>
  <li><a href="https://tech.kakaopay.com/post/jpa-transactional-bri">JPA Transactional ì˜ ì•Œê³  ì“°ê³  ê³„ì‹ ê°€ìš”?</a></li>
  <li><a href="https://m42-orion.tistory.com/160">@Transactionalì˜ ë™ì‘ ë°©ì‹ &amp; ì¤‘ì²©ì´ ì¼ì–´ë‚¬ì„ ë•Œ ì–´ë–»ê²Œ ë ê¹Œ?</a></li>
</ul>]]></content><author><name>Dajeong Park</name></author><category term="wiki" /><category term="Spring" /><category term="Transactional" /><summary type="html"><![CDATA[ìš°ë¦¬ëŠ” ìˆ˜ë§ì€ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ìˆ˜ì •í•˜ë©°, ê·¸ ê³¼ì •ì—ì„œ ë°ì´í„°ì˜ ë¬´ê²°ì„±ì„ ë³´ì¥í•˜ëŠ” ê²ƒì´ ì–¼ë§ˆë‚˜ ì¤‘ìš”í•œì§€ ê¹¨ë‹«ê²Œ ëœë‹¤. íŠ¹íˆ JPAì™€ Springì„ í™œìš©í•˜ëŠ” í™˜ê²½ì—ì„œëŠ” íŠ¸ëœì­ì…˜ì„ ì œëŒ€ë¡œ ê´€ë¦¬í•˜ì§€ ì•Šìœ¼ë©´ ì˜ˆìƒì¹˜ ëª»í•œ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. JPAë¥¼ ì²˜ìŒ ì ‘í–ˆì„ ë•Œ, ì—”í‹°í‹°ì˜ ê°’ì„ ë°”ê¾¸ë©´ ìë™ìœ¼ë¡œ UPDATE ì¿¼ë¦¬ê°€ ë‚˜ê°€ëŠ” ê²Œ ê½¤ ì‹ ê¸°í–ˆë‹¤. ê·¸ëŸ°ë° ë§‰ìƒ ì‹¤ë¬´ì—ì„œ ì½”ë“œë¥¼ ì‘ì„±í•˜ë‹¤ ë³´ë©´ â€œì™œ ì—…ë°ì´íŠ¸ê°€ ì•ˆ ë˜ì§€?â€, â€œì™œ ë°ì´í„°ê°€ ë°˜ì˜ë˜ì§€ ì•Šì•˜ì§€?â€ í•˜ëŠ” ìˆœê°„ë“¤ì„ ê²ªê²Œ ëœë‹¤. ê·¸ëŸ° ê²½í—˜ì„ í†µí•´ JPAì˜ ë³€ê²½ ê°ì§€ê°€ íŠ¸ëœì­ì…˜ ë²”ìœ„ ë‚´ì—ì„œë§Œ ë™ì‘í•œë‹¤ëŠ” ì ì„ ì•Œê²Œ ë˜ê³ , ê²°êµ­ @Transactional ì• ë…¸í…Œì´ì…˜ì˜ í•„ìš”ì„±ì„ ì²´ê°í•˜ê²Œ ëœë‹¤. ë˜ @Transactional(readOnly = true) ì˜µì…˜ì„ í™œìš©í•˜ë©´ ì¡°íšŒ ì„±ëŠ¥ì„ ìµœì í™”í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒë„ ì•Œê²Œ ëë‹¤. ê²°êµ­ ì¤‘ìš”í•œ ê±´ ë‹¨ìˆœíˆ @Transactionalì„ ë¶™ì´ëŠ” ê²Œ ì•„ë‹ˆë¼, íŠ¸ëœì­ì…˜ì´ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ë¥¼ ì´í•´í•˜ê³ , ìƒí™©ì— ë§ëŠ” ì˜µì…˜ì„ ì ìš©í•˜ëŠ” ê²ƒì´ë‹¤.]]></summary></entry><entry><title type="html">í† ìŠ¤í˜ì´ë¨¼ì¸  í•´ì™¸ê²°ì œ(Paypal, í•´ì™¸ì¹´ë“œ, Alipay) ì—°ë™ í›„ê¸°</title><link href="http://localhost:4000/wiki/2025/03/12/tosspayments-global-payment.html" rel="alternate" type="text/html" title="í† ìŠ¤í˜ì´ë¨¼ì¸  í•´ì™¸ê²°ì œ(Paypal, í•´ì™¸ì¹´ë“œ, Alipay) ì—°ë™ í›„ê¸°" /><published>2025-03-12T00:00:00+09:00</published><updated>2025-03-12T00:00:00+09:00</updated><id>http://localhost:4000/wiki/2025/03/12/tosspayments-global-payment</id><content type="html" xml:base="http://localhost:4000/wiki/2025/03/12/tosspayments-global-payment.html"><![CDATA[<p>í”„ë¡œì íŠ¸ ì§„í–‰ ì¤‘ í† ìŠ¤í˜ì´ë¨¼ì¸ ë¥¼ í†µí•´ í•´ì™¸ê²°ì œë¥¼ ì§„í–‰í•˜ê²Œ ë˜ì—ˆëŠ”ë°, ì œê³µí•´ì¤€ ê°€ì´ë“œê°€ ê¹”ë”í•˜ê³  êµ¬ì²´ì ì´ì—ˆì§€ë§Œ ê°œì¸ì ìœ¼ë¡œ í—¤ë§¨ ë¶€ë¶„ì´ ë§ì•„ ì •ë¦¬í•´ ë³¼ ê²¸ ì‘ì„±í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. 
í•´ì™¸ê²°ì œ ì¤‘ Paypal, í•´ì™¸ì¹´ë“œ, Alipay ì„¸ ê°€ì§€ë¥¼ ì‘ì—…í•˜ë©° ê²ªì€ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…ê¹Œì§€ ì‘ì„±í•´ë‘ì—ˆìœ¼ë‹ˆ ëˆ„êµ°ê°€ì—ê²Œ ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.
<br />
<br /></p>

<h3 id="ì‹œì‘-ì „-ì£¼ì˜ì‚¬í•­-ï¸">ì‹œì‘ ì „ ì£¼ì˜ì‚¬í•­ âš ï¸</h3>
<ul>
  <li>í•´ì™¸ê²°ì œëŠ” ëª¨ë“  ê³„ì•½ì´ ì„ í–‰ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.</li>
  <li>êµ­ë‚´ê²°ì œ, ë¸Œëœë“œí˜ì´, í•´ì™¸ê²°ì œë¥¼ ëª¨ë‘ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ê²°ì œìœ„ì ¯ë¥¼ ì›¹ë·°(Thymeleaf)ë¡œ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.</li>
  <li>êµ­ë‚´ê²°ì œ, ë¸Œëœë“œí˜ì´ë¥¼ ì´ë¯¸ êµ¬í˜„í•˜ì˜€ìœ¼ë¯€ë¡œ, successUrlê³¼ failUrlì´ ê°œë°œë˜ì–´ ìˆë‹¤ëŠ” ì „ì œí•˜ì— ê¸€ì„ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.
<br /></li>
</ul>

<h3 id="ìš”êµ¬ì‚¬í•­">ìš”êµ¬ì‚¬í•­</h3>
<ul>
  <li>Paypalì™€ AlipayëŠ” ë‹¬ëŸ¬ë¡œ, í•´ì™¸ì¹´ë“œëŠ” ì›í™”ë¡œ ê²°ì œí•©ë‹ˆë‹¤.</li>
  <li>ìµœê·¼ í•´ì™¸ì¹´ë“œë„ ë‹¬ëŸ¬ë¡œ ê²°ì œí•˜ëŠ” ì‹œìŠ¤í…œì´ ë„ì…ë˜ì—ˆìŠµë‹ˆë‹¤.
<br />
<br /></li>
</ul>

<h2 id="paypal">Paypal</h2>
<h3 id="ê²°ì œìœ„ì ¯-ì›¹ë·°">ê²°ì œìœ„ì ¯ ì›¹ë·°</h3>
<p>â€˜<a href="https://docs.tosspayments.com/guides/v2/learn/foreign-payment">í•´ì™¸ê²°ì œ ì—°ë™</a>â€™ ê°€ì´ë“œì— í•´ì™¸ì¹´ë“œì™€ í•¨ê»˜ ìˆëŠ” ì£¼ë¬¸ì„œ(javascript) ì½”ë“œëŠ” êµ¬ì²´ì ì´ì§€ ì•Šì•„ ê²°ì œìœ„ì ¯ &gt; â€˜<a href="https://docs.tosspayments.com/guides/v2/payment-widget/integration-paypal">Paypal ì—°ë™í•˜ê¸°</a>â€™ ê°€ì´ë“œì— ìˆëŠ” ì£¼ë¬¸ì„œ(javascript) ì½”ë“œë¥¼ ì°¸ê³ í•˜ì˜€ìŠµë‹ˆë‹¤.
Paypal ì—°ë™í•˜ê¸° ê°€ì´ë“œì—ì„œ í…ŒìŠ¤íŠ¸ìš© í˜ì´íŒ” ê³„ì •ë„ ì œê³µí•˜ê³  ìˆìœ¼ë‹ˆ ì°¸ê³ í•´ì„œ ê°œë°œí•˜ì‹œë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.</p>

<h3 id="trouble-shooting-">Trouble Shooting ğŸ’«</h3>
<p><img src="https://github.com/user-attachments/assets/46b260fc-ab90-41d1-b792-92ae94e332b5" alt="Image" />
í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ ê²°ì œ ìŠ¹ì¸ì˜ ê²°ê³¼ë¡œ Payment ê°ì²´ë¥¼ ë°›ìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ì´ë¯¸ êµ­ë‚´ ê²°ì œì™€ ë¸Œëœë“œí˜ì´ë¥¼ ì‘ì—…í•˜ë©´ì„œ easyPayë¼ëŠ” í•„ë“œë¥¼ <strong>ê°ì²´</strong>ë¡œ ë°›ê³  ìˆì—ˆëŠ”ë°, Paypalì˜ ê²½ìš° easyPay í•„ë“œì— ê°ì²´ê°€ ì•„ë‹Œ â€œí˜ì´íŒ”â€ì´ë‚˜ â€paypalâ€ì´ë¼ëŠ” <strong>String</strong>ì„ ì „ë‹¬í•˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤.<br />
ê·¸ë˜ì„œ JsonDeserializerë¥¼ ì‚¬ìš©í•´ì„œ ê°ì²´ì¼ ë•Œì™€ Stringì¼ ë•Œë¥¼ êµ¬ë¶„í•´ì„œ ì—°ê²°í•´ì£¼ì—ˆìŠµë‹ˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">EasyPayDtoDeserializer</span> <span class="kd">extends</span> <span class="nc">JsonDeserializer</span><span class="o">&lt;</span><span class="nc">TossPaymentDto</span><span class="o">.</span><span class="na">EasyPayDto</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">TossPaymentDto</span><span class="o">.</span><span class="na">EasyPayDto</span> <span class="nf">deserialize</span><span class="o">(</span><span class="nc">JsonParser</span> <span class="n">parser</span><span class="o">,</span> <span class="nc">DeserializationContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">JsonNode</span> <span class="n">node</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="na">getCodec</span><span class="o">().</span><span class="na">readTree</span><span class="o">(</span><span class="n">parser</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">isTextual</span><span class="o">())</span> <span class="o">{</span> <span class="c1">// Stringì¼ ë•Œ</span>
                <span class="k">return</span> <span class="k">new</span> <span class="nc">TossPaymentDto</span><span class="o">.</span><span class="na">EasyPayDto</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">asText</span><span class="o">(),</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">isObject</span><span class="o">())</span> <span class="o">{</span> <span class="c1">// ê°ì²´ì¼ ë•Œ</span>
                <span class="nc">String</span> <span class="n">provider</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">"provider"</span><span class="o">)</span> <span class="o">?</span> <span class="n">node</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"provider"</span><span class="o">).</span><span class="na">asText</span><span class="o">()</span> <span class="o">:</span> <span class="kc">null</span><span class="o">;</span>
                <span class="kt">int</span> <span class="n">amount</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">"amount"</span><span class="o">)</span> <span class="o">?</span> <span class="n">node</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"amount"</span><span class="o">).</span><span class="na">asInt</span><span class="o">()</span> <span class="o">:</span> <span class="mi">0</span><span class="o">;</span>
                <span class="kt">int</span> <span class="n">discountAmount</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="na">has</span><span class="o">(</span><span class="s">"discountAmount"</span><span class="o">)</span> <span class="o">?</span> <span class="n">node</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"discountAmount"</span><span class="o">).</span><span class="na">asInt</span><span class="o">()</span> <span class="o">:</span> <span class="mi">0</span><span class="o">;</span>
                <span class="k">return</span> <span class="k">new</span> <span class="nc">TossPaymentDto</span><span class="o">.</span><span class="na">EasyPayDto</span><span class="o">(</span><span class="n">provider</span><span class="o">,</span> <span class="n">amount</span><span class="o">,</span> <span class="n">discountAmount</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@JsonDeserialize</span><span class="o">(</span><span class="n">using</span> <span class="o">=</span> <span class="nc">EasyPayDtoDeserializer</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="c1">// ì»¤ìŠ¤í…€ ë³€í™˜ ì ìš©</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">EasyPayDto</span> <span class="o">{</span> <span class="c1">// ê°„í¸ ê²°ì œ</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">provider</span><span class="o">;</span> <span class="c1">// ê°„í¸ê²°ì œ ì œê³µ</span>
	<span class="kd">private</span> <span class="kt">double</span> <span class="n">amount</span><span class="o">;</span> <span class="c1">// ê³„ì¢Œ í˜¹ì€ í˜„ê¸ˆì„± í¬ì¸íŠ¸ ê¸ˆì•¡ (ì¶©ì „ì‹ ê²°ì œ ìˆ˜ë‹¨)</span>
	<span class="kd">private</span> <span class="kt">double</span> <span class="n">discountAmount</span><span class="o">;</span> <span class="c1">// ì ë¦½ í¬ì¸íŠ¸, ì¿ í°, ì¦‰ì‹œ í• ì¸ëœ ê¸ˆì•¡ (ì ë¦½ì‹ ê²°ì œìˆ˜ë‹¨)</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ë¨¼ì € EasyPayDtoDeserializer í´ë˜ìŠ¤ë¥¼ êµ¬í˜„í•˜ê³ , Payment ê°ì²´ ì•ˆì˜ EasyPayDto ê°ì²´ì— <code class="language-plaintext highlighter-rouge">@JsonDeserialize</code> ì• ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ êµ¬í˜„í•œ í´ë˜ìŠ¤ì™€ ì—°ê²°í•´ì£¼ë©´ ë©ë‹ˆë‹¤.<br />
<br /></p>

<h4 id="jsondeserializerë€">JsonDeserializerë€?</h4>
<p>JsonDeserializerëŠ” Jackson ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ìœ¼ë¡œ, JSON ë°ì´í„°ë¥¼ íŠ¹ì • Java ê°ì²´ë¡œ ë³€í™˜í•˜ëŠ” ê³¼ì •ì—ì„œ ì»¤ìŠ¤í…€ ë³€í™˜ ë¡œì§ì„ ì ìš©í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” í´ë˜ìŠ¤ì…ë‹ˆë‹¤.<br />
ê¸°ë³¸ì ìœ¼ë¡œ Jacksonì€ <code class="language-plaintext highlighter-rouge">@JsonProperty</code>ë‚˜ <code class="language-plaintext highlighter-rouge">@JsonDeserialize</code> ë“±ì˜ ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì—¬ JSONì„ Java ê°ì²´ë¡œ ìë™ ë§¤í•‘í•˜ì§€ë§Œ, JSON ë°ì´í„°ì˜ êµ¬ì¡°ê°€ ì˜ˆìƒê³¼ ë‹¤ë¥´ê±°ë‚˜, íŠ¹ë³„í•œ ë³€í™˜ ë¡œì§ì´ í•„ìš”í•  ë•Œ JsonDeserializerë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
<br />
<br />
<br /></p>

<h2 id="í•´ì™¸-ì¹´ë“œ">í•´ì™¸ ì¹´ë“œ</h2>
<h3 id="ì°¸ê³ ">ì°¸ê³ </h3>
<p>í•´ì™¸ ì¹´ë“œ ê³„ì•½ì„ ì™„ë£Œí•˜ë©´ ê¸°ëŠ¥ &gt; ì¹´ë“œì‚¬ ëª©ë¡ì—ì„œ í•´ì™¸ ì¹´ë“œë¥¼ í™•ì¸í•  ìˆ˜ ìˆì§€ë§Œ, ì €ëŠ” í•´ì™¸ ê²°ì œì¼ ë•Œì™€ êµ­ë‚´ ê²°ì œì¼ ë•Œë¥¼ êµ¬ë¶„í•˜ì—¬ ìœ„ì ¯ì„ ë…¸ì¶œì‹œí‚¤ê¸° ë•Œë¬¸ì— <a href="https://docs.tosspayments.com/guides/v2/learn/foreign-payment">í•´ì™¸ê²°ì œ ì—°ë™ API ê°€ì´ë“œ</a>ë¥¼ ì°¸ê³ í–ˆìŠµë‹ˆë‹¤.<br />
í•´ë‹¹ ê°€ì´ë“œ ë˜í•œ í…ŒìŠ¤íŠ¸ìš© í•´ì™¸ ì¹´ë“œ ë²ˆí˜¸ë¥¼ ì œê³µí•˜ë‹ˆ ì°¸ê³ í•´ì„œ ê°œë°œí•˜ì‹œë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.<br />
ìµœê·¼ í† ìŠ¤í˜ì´ë¨¼ì¸ ì— í•´ì™¸ì¹´ë“œ ë‹¬ëŸ¬ ê²°ì œ ê¸°ëŠ¥ì´ ì¶”ê°€ë˜ì—ˆë‹¤ê³  í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì €í¬ ìš”êµ¬ì‚¬í•­ì€ í•´ì™¸ì¹´ë“œë¥¼ ì›í™” ê²°ì œì´ê¸° ë•Œë¬¸ì— ì›í™”ë¡œ ê²°ì œí•œ ì½”ë“œë¼ëŠ” ì  ì°¸ê³ í•´ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.</p>

<h3 id="ì¤€ë¹„">ì¤€ë¹„</h3>
<p>í˜ì´íŒ”ì„ ì„¤ì •í•´ì¤„ ë•Œì²˜ëŸ¼ ê²°ì œ UIì—ì„œ ì„¤ì •í•˜ë©´ ë˜ì§€ë§Œ, ë‹¤ë¥¸ ì ì€ ì»¤ìŠ¤í…€ ê²°ì œìˆ˜ë‹¨ ì¶”ê°€ì—ì„œ ì´ë¦„ì€ â€˜Cardâ€™, keyëŠ” â€˜CARDâ€™ë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤ëŠ” ì ì…ë‹ˆë‹¤. ì—¬ê¸°ì„œ ì„¤ì •í•œ keyê°€ ê²°ì œìœ„ì ¯ (ì›¹ë·°)ì—ì„œ ì‚¬ìš©í•  í‚¤ê°’ì´ë¼ëŠ” ê²ƒì„ ê¸°ì–µí•´ë‘ì–´ì•¼ í•©ë‹ˆë‹¤.</p>

<h3 id="trouble-shooting--1">Trouble Shooting ğŸ’«</h3>
<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">selectedPaymentMethod</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">paymentMethodWidget</span><span class="p">.</span><span class="nx">getSelectedPaymentMethod</span><span class="p">();</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">selectedPaymentMethod</span><span class="p">.</span><span class="nx">code</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">CARD</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// ì»¤ìŠ¤í…€ ê²°ì œ ìˆ˜ë‹¨ì—ì„œ ì¶”ê°€í•œ í‚¤ ê°’</span>
		<span class="c1">// í•´ì™¸ ì¹´ë“œ ê²°ì œì°½ í˜¸ì¶œ</span>
		<span class="kd">const</span> <span class="nx">clientKeyCard</span> <span class="o">=</span> <span class="dl">""</span><span class="p">;</span> <span class="c1">// API ê°œë³„ ì—°ë™ í´ë¼ì´ì–¸íŠ¸ í‚¤(í•´ì™¸ ì¹´ë“œ MID)</span>
		<span class="kd">const</span> <span class="nx">tossPaymentsCard</span> <span class="o">=</span> <span class="nx">TossPayments</span><span class="p">(</span><span class="nx">clientKeyCard</span><span class="p">);</span>
		<span class="kd">const</span> <span class="nx">customerKey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">T_NuvKOyhjmLdxNz5SouY</span><span class="dl">"</span><span class="p">;</span>
		<span class="kd">const</span> <span class="nx">payment</span> <span class="o">=</span> <span class="nx">tossPaymentsCard</span><span class="p">.</span><span class="nx">payment</span><span class="p">({</span> <span class="nx">customerKey</span> <span class="p">});</span>
		<span class="nx">payment</span><span class="p">.</span><span class="nx">requestPayment</span><span class="p">({</span>
			<span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">CARD</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// ì»¤ìŠ¤í…€ ê²°ì œ ìˆ˜ë‹¨ì—ì„œ ì¶”ê°€í•œ í‚¤ ê°’</span>
			<span class="na">amount</span><span class="p">:</span> <span class="p">{</span>
				<span class="na">currency</span><span class="p">:</span> <span class="dl">"</span><span class="s2">KRW</span><span class="dl">"</span><span class="p">,</span>
				<span class="na">value</span><span class="p">:</span> <span class="mi">50000</span><span class="p">,</span> <span class="c1">// KRWì˜ ê²½ìš° ë°˜ë“œì‹œ ì •ìˆ˜í˜• íƒ€ì…</span>
			<span class="p">},</span>
			<span class="na">orderId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">mhob2uEy33o616FNnwVpD</span><span class="dl">"</span><span class="p">,</span>
			<span class="na">orderName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">í† ìŠ¤ í‹°ì…”ì¸  ì™¸ 2ê±´</span><span class="dl">"</span><span class="p">,</span>
			<span class="na">successUrl</span><span class="p">:</span> <span class="nx">baseUrl</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">/api/reservation/widget/success</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// ì¶”ê°€</span>
			<span class="na">failUrl</span><span class="p">:</span> <span class="nx">baseUrl</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">/api/reservation/widget/fail</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// ì¶”ê°€</span>
			<span class="na">customerEmail</span><span class="p">:</span> <span class="dl">"</span><span class="s2">customer123@gmail.com</span><span class="dl">"</span><span class="p">,</span>
			<span class="na">customerName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ê¹€í† ìŠ¤</span><span class="dl">"</span><span class="p">,</span>
			<span class="na">customerMobilePhone</span><span class="p">:</span> <span class="dl">"</span><span class="s2">01012341234</span><span class="dl">"</span><span class="p">,</span>
			<span class="na">card</span><span class="p">:</span> <span class="p">{</span>
				<span class="na">useInternationalCardOnly</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
			<span class="p">},</span>
		<span class="p">});</span>
	<span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Uncaught</span> <span class="p">(</span><span class="k">in</span> <span class="nx">promise</span><span class="p">)</span> <span class="nb">Error</span><span class="p">:</span> <span class="nx">ëª¨ë°”ì¼</span> <span class="nx">í™”ë©´ì—ì„œëŠ”</span> <span class="nb">Promise</span> <span class="nx">ë°©ì‹ì„</span> <span class="nx">ì§€ì›í•˜ì§€</span> <span class="nx">ì•ŠìŠµë‹ˆë‹¤</span><span class="p">.</span>
</code></pre></div></div>
<p>í† ìŠ¤ì—ì„œ ì œê³µí•´ì¤€ ì½”ë“œëŒ€ë¡œ ì‘ì„±í•´ì„œ ì‹œë„í–ˆë”ë‹ˆ ìœ„ì²˜ëŸ¼ Promise ë°©ì‹ì„ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì—ëŸ¬ë¥¼ ë§ˆì£¼ì¹˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
ê·¸ëŸ°ë° í˜„ì¬ Promise ë°©ì‹ì„ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì—, í˜¹ì‹œ ëª°ë¼ì„œ í† ìŠ¤í˜ì´ë¨¼ì¸  ì—ëŸ¬ ì½”ë“œë¥¼ ì°¾ì•„ë³´ë‹ˆ ë’¤ì—  successUrl, failUrlì„ ì¶”ê°€í•˜ë¼ëŠ” ë©˜íŠ¸ê°€ ìˆê¸¸ë˜ ì¶”ê°€í•´ë´¤ìŠµë‹ˆë‹¤.</p>

<p><img src="https://github.com/user-attachments/assets/4121c00e-684f-4a4b-8408-3ed2b47f8068" alt="Image" /></p>

<p>í•˜ì§€ë§Œ ì´ë ‡ê²Œ í•´ë„ <code class="language-plaintext highlighter-rouge">COMMON_ERROR ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</code>ë¼ëŠ” ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì´ ë¶€ë¶„ì— ëŒ€í•´ í† ìŠ¤í˜ì´ë¨¼ì¸  ë””ìŠ¤ì½”ë“œì—ì„œ ì§ˆë¬¸í•˜ë˜ ì¤‘ ë°©ë²•ì„ ì°¾ì•„ëƒˆìŠµë‹ˆë‹¤. ì €ëŠ” í•´ì™¸ê²°ì œë¼ê³  í•´ì„œ í•´ì™¸ê²°ì œ MIDë¥¼ ë„£ê³  ìˆì—ˆëŠ”ë°ìš”. ê·¸ëŸ°ë° í•´ì™¸ì¹´ë“œì—ì„œëŠ” KRWë¡œ ê²°ì œ ì²˜ë¦¬ë¥¼ í•˜ê¸° ë•Œë¬¸ì— KRWë¡œ ê²°ì œí•˜ê¸° ìœ„í•œ MIDë¥¼ ì‚¬ìš©í•´ì•¼ í–ˆë˜ ê²ƒì…ë‹ˆë‹¤. ë‹¹ì—°íˆ í•´ì™¸ì¹´ë“œëŠ” í•´ì™¸ê²°ì œ ê´€ë ¨ í‚¤ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤ê³  ìƒê°í–ˆëŠ”ë°, ì´ ë¶€ë¶„ ë•Œë¬¸ì— ì¡°ê¸ˆ í—¤ë§¸ìœ¼ë‹ˆ ì´ê±¸ ë³´ì‹œëŠ” ë¶„ë“¤ì€ ì‹œê°„ì„ ì•„ë¼ì‹œê¸¸ ë°”ëë‹ˆë‹¤.
<br />
<br /></p>

<h2 id="alipay">AliPay</h2>
<p>ì•Œë¦¬í˜ì´ ë˜í•œ í•´ì™¸ê²°ì œì— í•´ë‹¹í•˜ì§€ë§Œ, Paypalê³¼ ë‹¬ë¦¬ ë¹„ë™ê¸°ë¡œ ì§„í–‰ë˜ì–´ ë¡œì§ì„ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤. Paypalì˜ ê²°ì œ ë°©ì‹ë¶€í„° í•œ ë²ˆ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<p><img src="https://github.com/user-attachments/assets/8f8f72a7-c20b-4d8b-ae46-2966394fa54b" alt="Image" />
Paypalì€ ë™ê¸° ê²°ì œë¡œ ìš°ë¦¬ê°€ ìƒê°í•˜ëŠ” íë¦„ì²˜ëŸ¼ ì§„í–‰ë©ë‹ˆë‹¤. ê²°ì œ ìœ„ì ¯ì—ì„œ ê²°ì œ ì •ë³´ë¥¼ ì…ë ¥í•˜ê³  â€˜ê²°ì œí•˜ê¸°â€™ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì—°ê²°ëœ successUrl/failUrlë¡œ ê²°ì œ ì •ë³´ê°€ ì „ë‹¬ë©ë‹ˆë‹¤. successUrlë¡œ ì „ë‹¬ë˜ì—ˆë‹¤ë©´ ê²°ì œ ìŠ¹ì¸ APIë¥¼ í˜¸ì¶œí•˜ì—¬ ê²°ì œë¥¼ ì²˜ë¦¬í•˜ê³ , ì´ë•Œ 200 ì‘ë‹µì„ ë°›ìœ¼ë©´ ê²°ì œê°€ ì„±ê³µí•˜ê²Œ ë˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>

<p><img src="https://github.com/user-attachments/assets/154c847a-e6c3-4b43-a144-28dd0a0852cd" alt="Image" />
ì•Œë¦¬í˜ì´ì˜ ë¹„ë™ê¸° ê²°ì œëŠ” ë¬´ì—‡ì´ ë‹¤ë¥¼ê¹Œìš”? ê²°ì œ ìœ„ì ¯ì—ì„œ ê²°ì œ ì •ë³´ë¥¼ ì…ë ¥í•˜ê³  ê²°ì œë¥¼ ìš”ì²­í•˜ëŠ” ê²ƒê¹Œì§€ëŠ” ë™ì¼í•˜ì§€ë§Œ pendingUrlì´ë¼ëŠ” ë¶€ë¶„ì´ ìƒê²¼ìŠµë‹ˆë‹¤. ë˜í•œ ê²°ì œ ìŠ¹ì¸ì˜ ê²°ê³¼ë¥¼ ì›¹í›…ìœ¼ë¡œ ë°›ì•„ì•¼ í•©ë‹ˆë‹¤.<br />
ìœ„ì—ì„œ ì¤‘ìš”í•œ ë¶€ë¶„ì´ ìˆìŠµë‹ˆë‹¤. ë°”ë¡œ ì›¹í›…ì´ ìµœëŒ€ 10ë¶„ì´ ê±¸ë¦´ ìˆ˜ ìˆë‹¤ëŠ” ì ì…ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ pendingUrlë¡œ ë„˜ì–´ì˜¤ë©´ ì•±ì—ì„œëŠ” ê²°ì œ ëŒ€ê¸° ìƒíƒœë¼ëŠ” ê²ƒì„ ì•Œë¦¬ê³ , ì¶”í›„ ê²°ì œ ì™„ë£Œê°€ ë˜ë©´ ë‹¤ì‹œ ì•Œë ¤ì£¼ê² ë‹¤ëŠ” ì•¡ì…˜ì„ ì·¨í•´ì•¼ í•©ë‹ˆë‹¤.</p>

<h3 id="êµ¬í˜„-íŒ">êµ¬í˜„ íŒ</h3>

<h4 id="1-pendingurl">1. pendingUrl</h4>
<p>ì œ ìƒí™©ì²˜ëŸ¼ ì•±ì„ êµ¬í˜„í•˜ì‹ ë‹¤ë©´ pendingUrlì—ì„œ ë”¥ë§í¬ë¥¼ í˜¸ì¶œí•´ì„œ ì•±ìœ¼ë¡œ ëŒì•„ê°ˆ ìˆ˜ ìˆë„ë¡ êµ¬í˜„í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.</p>

<p><strong>pendingUrl í˜ì´ì§€ ì˜ˆì‹œ</strong></p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"ko"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"icon"</span> <span class="na">href=</span><span class="s">"https://static.toss.im/icons/png/4x/icon-toss-logo.png"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"/css/style.css"</span> <span class="na">type=</span><span class="s">"text/css"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"X-UA-Compatible"</span> <span class="na">content=</span><span class="s">"IE=Chrome"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1.0"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;title&gt;</span>í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ìœ„ì ¯ ëŒ€ê¸° ì›¹ë·°<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
        
<span class="nt">&lt;body&gt;</span>
        
    <span class="nt">&lt;script&gt;</span>
        <span class="k">async</span> <span class="kd">function</span> <span class="nx">confirm</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span> <span class="c1">// app scheme í˜¸ì¶œ</span>
        <span class="p">}</span>
        <span class="nx">confirm</span><span class="p">();</span>
    <span class="nt">&lt;/script&gt;</span>
        
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
        
</code></pre></div></div>

<h4 id="2-ì›¹í›…-ë“±ë¡-ë°-ê²°ì œ-ìŠ¹ì¸-ì›¹í›…-api-ì¶”ê°€">2. ì›¹í›… ë“±ë¡ ë° ê²°ì œ ìŠ¹ì¸ ì›¹í›… API ì¶”ê°€</h4>
<p>ì›¹í›…ìœ¼ë¡œ ì „ë‹¬ë°›ëŠ” ê²°ì œ ìŠ¹ì¸ ê²°ê³¼ëŠ” Payment ê°ì²´ë§Œ ì „ë‹¬ ë°›ëŠ” ê²Œ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ë³„ë„ë¡œ êµ¬í˜„ì´ í•„ìš”í•©ë‹ˆë‹¤.
ì•Œë¦¬í˜ì´ ë˜í•œ ê°„í¸ê²°ì œì´ë¯€ë¡œ easyPayë¼ëŠ” í•„ë“œì— Stringìœ¼ë¡œ â€œì•Œë¦¬í˜ì´â€ í˜¹ì€ â€œAPLIPAYâ€ë¼ëŠ” ê°’ìœ¼ë¡œ ì „ë‹¬ë˜ë©°, status í•„ë“œì— ë”°ë¼ ê²°ì œ ì„±ê³µ/ì‹¤íŒ¨ ë¶„ê¸°ë¥¼ ì²˜ë¦¬í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.</p>

<p><strong>ì›¹í›… ë¶„ê¸° êµ¬í˜„ ì˜ˆì‹œ</strong><br />
â• ê²°ì œ ìƒíƒœ(PaymentStatus)ë¥¼ ë¯¸ë¦¬ enum í´ë˜ìŠ¤ë¡œ êµ¬í˜„í•´ë‘ì—ˆìŠµë‹ˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">confirmOrderWebhook</span><span class="o">(</span><span class="nc">OrderWebhookDto</span> <span class="n">webhook</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">TossPaymentDto</span> <span class="n">payment</span> <span class="o">=</span> <span class="n">webhook</span><span class="o">.</span><span class="na">getData</span><span class="o">();</span>
                
    <span class="c1">// ê²°ì œ ìƒíƒœì— ë”°ë¥¸ ë¶„ê¸° ì²˜ë¦¬</span>
    <span class="k">if</span> <span class="o">(</span><span class="nc">PaymentStatus</span><span class="o">.</span><span class="na">DONE</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">status</span><span class="o">))</span> <span class="o">{</span>
        <span class="c1">// ê²°ì œ ì„±ê³µ ì‹œ ë¡œì§ êµ¬í˜„</span>
    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="nc">PaymentStatus</span><span class="o">.</span><span class="na">ABORTED</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">status</span><span class="o">)</span> 
                <span class="o">||</span> <span class="nc">PaymentStatus</span><span class="o">.</span><span class="na">EXPIRED</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">status</span><span class="o">))</span> <span class="o">{</span>
        <span class="c1">// ê²°ì œ ì‹¤íŒ¨ ì‹œ ë¡œì§ êµ¬í˜„</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="ì£¼ì˜">ì£¼ì˜</h3>
<ol>
  <li>AWalletì´ë¼ëŠ” í…ŒìŠ¤íŠ¸ì•±ì´ ì¡´ì¬í•˜ì§€ë§Œ, AWalletì—ì„œ ê²°ì œë¥¼ ì§„í–‰í•´ë„ pendingUrlë¡œ ë³´ë‚´ì£¼ì§€ ì•ŠìŠµë‹ˆë‹¤.</li>
  <li>ì•Œë¦¬í˜ì´ ì•±ì—ì„œ pin ë²ˆí˜¸ ì¸ì¦ìœ¼ë¡œ ê²°ì œê°€ ì„±ê³µí•˜ë©´, í˜„ì¬ ì„œë²„ì˜ ìš´ì˜ì— ìƒê´€ì—†ì´ ê²°ì œê°€ ì„±ê³µëœ ê²ƒìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.</li>
</ol>

<h3 id="ê²°ë¡ ">ê²°ë¡ </h3>
<p>ê²°ê³¼ì ìœ¼ë¡œ ë§í•˜ìë©´ ì•Œë¦¬í˜ì´ëŠ” í˜„ì¬ ë‹¨ê³„ì—ì„œ ì ìš©í•˜ì§€ ì•Šê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. í…ŒìŠ¤íŠ¸ ì•±ì—ì„œ ê²°ì œë¥¼ ì§„í–‰(ì„±ê³µ/ì‹¤íŒ¨)í•œ ê²ƒì„ ì•±ì—ì„œ í™•ì¸í•  ìˆ˜ ì—†ê³ , ë¼ì´ë¸Œ ê²°ì œ ë˜í•œ ì¤‘êµ­ì—ì„œ ìƒì„±í•œ ê³„ì •ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ ì‹¤ì œë¡œ ì‚¬ìš©í•˜ê¸° ì–´ë µê² ë‹¤ëŠ” ê²°ì •ì´ ìˆì—ˆìŠµë‹ˆë‹¤.
<br />
<br /></p>

<h3 id="í•´ì™¸ê²°ì œ-ì¶”ê°€-íŒï¸">í•´ì™¸ê²°ì œ ì¶”ê°€ íŒâ—ï¸</h3>
<ul>
  <li>KRW ê²°ì œëŠ” ì†Œìˆ˜ì ì„ ì§€ì›í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ë°˜ë“œì‹œ ì •ìˆ˜í˜• ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ê°’ì„ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤.</li>
  <li>Paypalê³¼ í•´ì™¸ì¹´ë“œëŠ” ì‹¤ê²°ì œ í…ŒìŠ¤íŠ¸ë¥¼ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
    <ul>
      <li>Paypalì€ êµ­ë‚´ ì•„ì´í”¼, êµ­ë‚´ íšŒì›ê°€ì… ê³„ì •ìœ¼ë¡œ ê²°ì œí•˜ëŠ” ê²ƒì´ Paypal ì •ì±… ë° êµ­ë‚´ë²•ìƒ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.</li>
      <li>í•´ì™¸ì¹´ë“œëŠ” í•´ì™¸ì—ì„œ ë°œê¸‰ëœ ì¹´ë“œë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. êµ­ë‚´ì—ì„œ ë°œê¸‰ë°›ì€ ì¹´ë“œ ì¤‘ VISA, MASTERê°€ ë¶™ì€ ì¹´ë“œë„ êµ­ë‚´ ì¹´ë“œë¡œ ì¸ì‹ë©ë‹ˆë‹¤.
<br />
<br />
<br /></li>
    </ul>
  </li>
</ul>

<h3 id="insight--thoughts">insight &amp; thoughts</h3>
<ul>
  <li>ì´ë²ˆ í•´ì™¸ê²°ì œ ì—°ë™ì„ ì§„í–‰í•˜ë©´ì„œ ì˜ˆìƒì¹˜ ëª»í•œ ë¬¸ì œë“¤ì´ ìˆì—ˆì§€ë§Œ, í•´ê²° ê³¼ì •ì„ í†µí•´ í† ìŠ¤í˜ì´ë¨¼ì¸ ì˜ ê²°ì œ ì‹œìŠ¤í…œì„ ì´í•´í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.</li>
  <li>íŠ¹íˆ Paypal, í•´ì™¸ì¹´ë“œ, Alipayì˜ ì°¨ì´ì ì„ ëª…í™•íˆ ì•Œê²Œ ë˜ì—ˆê³ , ê° ê²°ì œ ë°©ì‹ì— ë§ëŠ” êµ¬í˜„ ë°©ì‹ê³¼ ì£¼ì˜ì ì„ ìµí˜”ìŠµë‹ˆë‹¤.</li>
  <li>JsonDeserializerë¥¼ í™œìš©í•œ ê°ì²´ì™€ ë¬¸ìì—´ ì²˜ë¦¬ ë°©ì‹ì˜ ì°¨ì´ë¥¼ ì§ì ‘ ì ìš©í•˜ë©´ì„œ ìœ ì—°í•œ ë°ì´í„° ì²˜ë¦¬ ë°©ë²•ì„ ë°°ìš´ ê²ƒë„ í° ìˆ˜í™•ì´ì—ˆìŠµë‹ˆë‹¤.</li>
  <li>í•´ì™¸ì¹´ë“œ ê²°ì œ ì‹œ KRWì™€ USDì˜ ì°¨ì´ë¥¼ ê³ ë ¤í•´ì•¼ í–ˆê³ , MID ì„¤ì • ë¬¸ì œë¡œ ì¸í•´ ì—ëŸ¬ê°€ ë°œìƒí–ˆì§€ë§Œ, í† ìŠ¤í˜ì´ë¨¼ì¸  ë””ìŠ¤ì½”ë“œì™€ ê³µì‹ ë¬¸ì„œë¥¼ í†µí•´ í•´ê²°í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.
    <ul>
      <li>í† ìŠ¤í˜ì´ë¨¼ì¸  ë””ìŠ¤ì½”ë“œì—ì„œ ê°œë°œìë¶„ë“¤ì´ ì¹œì ˆí•˜ê²Œ ì˜ ì•Œë ¤ì£¼ì‹­ë‹ˆë‹¤. ë‹¤ì‹œ í•œë²ˆ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤ ğŸ™</li>
    </ul>
  </li>
  <li>Alipayì˜ ê²½ìš° ë¹„ë™ê¸° ê²°ì œ ë° ì›¹í›… ì²˜ë¦¬ ë°©ì‹ì´ Paypalê³¼ ë‹¤ë¥´ë‹¤ëŠ” ì ì´ ìƒˆë¡œì› ê³ , ì´ë¥¼ êµ¬í˜„í•˜ëŠ” ê³¼ì •ì—ì„œ pendingUrlì„ í™œìš©í•œ ì‚¬ìš©ì ê²½í—˜ ê°œì„ ì„ ê³ ë¯¼í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.</li>
  <li>Paypalê³¼ í•´ì™¸ì¹´ë“œëŠ” êµ­ë‚´ì—ì„œëŠ” ì‹¤ì œ í…ŒìŠ¤íŠ¸ê°€ ë¶ˆê°€ëŠ¥í•˜ì—¬ ì¼ë¶€ëŠ” ì´ë¡ ì ì¸ ì ‘ê·¼ìœ¼ë¡œ êµ¬í˜„í•´ì•¼ í–ˆë‹¤ëŠ” ì ì´ ì•„ì‰¬ì› ìŠµë‹ˆë‹¤.</li>
  <li>íŠ¹íˆ Alipayì˜ ê²½ìš°, í…ŒìŠ¤íŠ¸ í™˜ê²½ì˜ ì œí•œìœ¼ë¡œ ì¸í•´ ì‹¤ì‚¬ìš©ì´ ì–´ë ¤ì› ë‹¤ëŠ” ì ì´ ì•„ì‰½ì§€ë§Œ, í–¥í›„ ê¸€ë¡œë²Œ í™˜ê²½ì—ì„œ ì ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ë°˜ì„ ë§ˆë ¨í•œ ì ì€ ì˜ë¯¸ ìˆë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤.</li>
  <li>ì´ë²ˆ í”„ë¡œì íŠ¸ë¥¼ í†µí•´ í•´ì™¸ ê²°ì œ ì‹œìŠ¤í…œì˜ ë³µì¡ì„±ì„ ì´í•´í•˜ê³ , ê° ê²°ì œ ìˆ˜ë‹¨ì˜ ì°¨ì´ë¥¼ ëª…í™•íˆ ì •ë¦¬í•  ìˆ˜ ìˆì—ˆë˜ ì ì´ ê°€ì¥ í° ìˆ˜í™•ì´ì—ˆìŠµë‹ˆë‹¤. ì•ìœ¼ë¡œ ê¸€ë¡œë²Œ ì„œë¹„ìŠ¤ë¥¼ ì¤€ë¹„í•  ë•Œ ë„ì›€ì´ ë  ì¤‘ìš”í•œ ê²½í—˜ì´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤!
<br />
<br /></li>
</ul>

<p><strong>ì°¸ê³  ìë£Œ</strong></p>
<ul>
  <li><a href="https://docs.tosspayments.com/guides/v2/learn/foreign-payment">í† ìŠ¤í˜ì´ë¨¼ì¸  í•´ì™¸ê²°ì œ ì—°ë™í•˜ê¸° ê°€ì´ë“œ</a></li>
  <li><a href="https://docs.tosspayments.com/guides/v2/payment-widget/integration-foreignpay">í† ìŠ¤í˜ì´ë¨¼ì¸  í•´ì™¸ ê°„í¸ê²°ì œ ì—°ë™í•˜ê¸° ê°€ì´ë“œ</a></li>
  <li><a href="https://docs.tosspayments.com/reference/using-api/webhook-events#payment_status_changed">í† ìŠ¤í˜ì´ë¨¼ì¸  ì›¹í›… ì´ë²¤íŠ¸ ê°€ì´ë“œ</a></li>
  <li><a href="https://www.notion.so/17e714bbfde780b68df9efa1a1667e4a?pvs=21">í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì—°ë™ ë°±ì„œ ë…¸ì…˜</a>
    <ul>
      <li>í•´ì™¸ì¹´ë“œ ë‹¬ëŸ¬ ê²°ì œí•˜ì‹¤ ë¶„ë“¤ ì°¸ê³ í•˜ì‹œë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.</li>
    </ul>
  </li>
</ul>]]></content><author><name>Dajeong Park</name></author><category term="wiki" /><category term="API" /><category term="í† ìŠ¤í˜ì´ë¨¼ì¸ " /><category term="í•´ì™¸ê²°ì œ" /><category term="íŠ¸ëŸ¬ë¸”ìŠˆíŒ…" /><category term="Proejct" /><summary type="html"><![CDATA[í”„ë¡œì íŠ¸ ì§„í–‰ ì¤‘ í† ìŠ¤í˜ì´ë¨¼ì¸ ë¥¼ í†µí•´ í•´ì™¸ê²°ì œë¥¼ ì§„í–‰í•˜ê²Œ ë˜ì—ˆëŠ”ë°, ì œê³µí•´ì¤€ ê°€ì´ë“œê°€ ê¹”ë”í•˜ê³  êµ¬ì²´ì ì´ì—ˆì§€ë§Œ ê°œì¸ì ìœ¼ë¡œ í—¤ë§¨ ë¶€ë¶„ì´ ë§ì•„ ì •ë¦¬í•´ ë³¼ ê²¸ ì‘ì„±í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. í•´ì™¸ê²°ì œ ì¤‘ Paypal, í•´ì™¸ì¹´ë“œ, Alipay ì„¸ ê°€ì§€ë¥¼ ì‘ì—…í•˜ë©° ê²ªì€ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…ê¹Œì§€ ì‘ì„±í•´ë‘ì—ˆìœ¼ë‹ˆ ëˆ„êµ°ê°€ì—ê²Œ ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.]]></summary></entry><entry><title type="html">JPA Auditingìœ¼ë¡œ ì—”í‹°í‹° ë³€ê²½ ì´ë ¥ ê´€ë¦¬í•˜ê¸°</title><link href="http://localhost:4000/wiki/2025/02/28/jpa-auditing.html" rel="alternate" type="text/html" title="JPA Auditingìœ¼ë¡œ ì—”í‹°í‹° ë³€ê²½ ì´ë ¥ ê´€ë¦¬í•˜ê¸°" /><published>2025-02-28T00:00:00+09:00</published><updated>2025-02-28T00:00:00+09:00</updated><id>http://localhost:4000/wiki/2025/02/28/jpa-auditing</id><content type="html" xml:base="http://localhost:4000/wiki/2025/02/28/jpa-auditing.html"><![CDATA[<p>Spring Data JPAì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µí•´ì£¼ëŠ” ê¸°ëŠ¥ ì¤‘ í¸ë¦¬í•œ ê¸°ëŠ¥ë“¤ì´ ë§ì€ë°, ê·¸ì¤‘ ë‚´ê²Œ ì¶©ê²©ì„ ì£¼ì—ˆë˜ ê¸°ëŠ¥ì´ ë°”ë¡œ Auditingì´ì—ˆë‹¤. 
MyBatisì—ì„œëŠ” ì¼ì¼ì´ ì„¤ì •í•˜ê±°ë‚˜ ì§€ì •í•´ì¤˜ì•¼ í–ˆë˜ ë¶€ë¶„ì´ ê¸°ëŠ¥ìœ¼ë¡œ ìˆë‹¤ë‹ˆ.. 
ì˜¤ëŠ˜ì€ JPA Auditingì— ëŒ€í•´ì„œ ìì„¸íˆ ì•Œì•„ë³´ê³ , ì•„ì§ ì‚¬ìš©í•´ë³´ì§€ ëª»í•œ AuditorAware ê¸°ëŠ¥ê³¼ ì‹¤ë¬´ì—ì„œ ê²ªì—ˆë˜ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…ê¹Œì§€ ì¶”ê°€í•´ì„œ ê¸°ë¡í•´ë‘ë ¤ê³  í•œë‹¤.
<br />
<br />
<br /></p>

<h2 id="jpa-auditing">JPA Auditing</h2>
<p>Auditì€ ì‚¬ì „ì ìœ¼ë¡œ â€˜ê°ì‚¬í•˜ë‹¤â€™, â€˜ë‹¨ì†í•˜ë‹¤â€™ë¼ëŠ” ëœ»ì„ ê°€ì§€ê³  ìˆë‹¤. JPAì—ì„œëŠ” Auditingì„ ì œê³µí•˜ì—¬ ì—”í‹°í‹°ê°€ ì–¸ì œ í˜¹ì€ ëˆ„ê°€ ìƒì„±í•˜ê±°ë‚˜ ë³€ê²½í–ˆëŠ”ì§€ë¥¼ ìë™ìœ¼ë¡œ ì¶”ì (ë‹¨ì†)í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.
Auditingì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ì—”í‹°í‹° í´ë˜ìŠ¤ì— Auditing ì •ë³´ë¥¼ í¬í•¨í•œ ë©”íƒ€ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ê³ , ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ê±°ë‚˜ íŠ¹ì • ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ì—¬ ì •ì˜í•  ìˆ˜ ìˆë‹¤.
<br />
<br />
<br /></p>

<h2 id="auditing-ì ìš©">Auditing ì ìš©</h2>

<h3 id="applicationclass">Application.class</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@EnableJpaAuditing</span>
<span class="nd">@SpringBootApplication</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Application</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">CaffeineApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>
<p><strong><code class="language-plaintext highlighter-rouge">@EnableJpaAuditing</code></strong></p>
<ul>
  <li>JPA Auditingì„ í™œì„±í•˜ê¸° ìœ„í•œ ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ, ì´ë ‡ê²Œ Applicationë‹¨ì˜ main ë©”ì†Œë“œì— ë¶™ì—¬ì£¼ê±°ë‚˜ Config í´ë˜ìŠ¤ë¥¼ ë”°ë¡œ ìƒì„±í•˜ì—¬ ì„¤ì •í•´ì¤„ ìˆ˜ ìˆë‹¤.</li>
</ul>

<h3 id="basetimeentityclass">BaseTimeEntity.class</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@MappedSuperclass</span>
<span class="nd">@EntityListeners</span><span class="o">(</span><span class="nc">AuditingEntityListener</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">BaseDateTimeEntity</span> <span class="o">{</span>

    <span class="nd">@CreatedDate</span>
    <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">createdDateTime</span><span class="o">;</span>

    <span class="nd">@LastModifiedDate</span>
    <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">modifiedDateTime</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">@MappedSuperclass</code></strong></p>
<ul>
  <li>JPA Entity í´ë˜ìŠ¤ë“¤ì´ BaseTimeEntity í´ë˜ìŠ¤ë¥¼ ìƒì†í•  ê²½ìš° í•„ë“œë“¤(createdDateTime, modifiedDateTime)ì„ ì»¬ëŸ¼ìœ¼ë¡œ ì¸ì‹í•˜ë„ë¡ í•œë‹¤.</li>
</ul>

<p><strong><code class="language-plaintext highlighter-rouge">@EntityListeners(AuditingEntityListener.class)</code></strong></p>
<ul>
  <li>BaseTimeEntity í´ë˜ìŠ¤ì— Auditing ê¸°ëŠ¥ì„ í¬í•¨ì‹œí‚¨ë‹¤.</li>
</ul>

<p><strong><code class="language-plaintext highlighter-rouge">@CreatedDate</code></strong></p>
<ul>
  <li>Entityê°€ ìƒì„±ë˜ì–´ ì €ì¥ë  ë•Œ ì‹œê°„ì´ ìë™ ì €ì¥ëœë‹¤.</li>
</ul>

<p><strong><code class="language-plaintext highlighter-rouge">@LastModifiedDate</code></strong></p>
<ul>
  <li>ì¡°íšŒí•œ Entityì˜ ê°’ì„ ë³€ê²½í•  ë•Œ ì‹œê°„ì´ ìë™ ì €ì¥ëœë‹¤.
<br /></li>
</ul>

<h3 id="-mappedsuperclassë€"><strong>â• @MappedSuperclassë€?</strong></h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Documented</span>
<span class="nd">@Target</span><span class="o">(</span><span class="no">TYPE</span><span class="o">)</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="no">RUNTIME</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">MappedSuperclass</span>
</code></pre></div></div>
<ul>
  <li>MappedSuperclassëŠ” ìƒìœ„ í´ë˜ìŠ¤ë¡œë¶€í„° ë§¤í•‘ ì •ë³´ë¥¼ ìƒì† ë°›ëŠ” í´ë˜ìŠ¤ì„ì„ ì§€ì •í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ì´ë‹¤.</li>
  <li>ì§€ì •ëœ í´ë˜ìŠ¤ ìì²´ëŠ” ë³„ë„ì˜ í…Œì´ë¸”ì´ ìƒì„±ë˜ì§€ ì•ŠëŠ”ë‹¤. (== ìƒì†í•˜ëŠ” í•˜ìœ„ í´ë˜ìŠ¤ì—ë§Œ ì ìš©ëœë‹¤.)</li>
  <li>í•˜ìœ„ í´ë˜ìŠ¤ì—ì„œëŠ” ìƒì†ëœ ë§¤í•‘ ì •ë³´ê°€ í•´ë‹¹ í´ë˜ìŠ¤ì˜ í…Œì´ë¸”ì— ì ìš©ë˜ê³ , <code class="language-plaintext highlighter-rouge">@AttributeOverride</code>, <code class="language-plaintext highlighter-rouge">@AssociationOverride</code> ì• ë…¸í…Œì´ì…˜ (ë˜ëŠ” XML)ì„ ì‚¬ìš©í•˜ë©´ ë§¤í•‘ ì •ë³´ë¥¼ ì¬ì •ì˜í•  ìˆ˜ë„ ìˆë‹¤.<br />
<br />
<br />
<br /></li>
</ul>

<h2 id="auditoraware">AuditorAware</h2>
<p>ê·¸ë ‡ë‹¤ë©´ AuditorAwareëŠ” ë­˜ê¹Œ? 
ì•„ì§ ì§ì ‘ ì¨ë³¸ ì  ì—†ì§€ë§Œ ìƒì„±ì¼, ìˆ˜ì •ì¼ì²˜ëŸ¼ ìƒì„±ì, ìˆ˜ì •ì ê°™ì€ ì‚¬ìš©ì ì •ë³´ë„ JPA Auditingì„ í†µí•´ ìë™ìœ¼ë¡œ ì…ë ¥í•´ì¤„ ìˆ˜ ìˆë‹¤.
ìƒì„±ì¼, ìˆ˜ì •ì¼ê³¼ëŠ” êµ¬í˜„ì²´ë¥¼ ì„¤ì •í•˜ê³  ê·¸ êµ¬í˜„ì²´ë¥¼ JWT ê°™ì€ ì¸ì¦ í† í°ì„ ê²€ì‚¬í•  ë•Œ ê°™ì´ ë„£ì–´ì£¼ë©´ ëœë‹¤.</p>

<h3 id="userauditawareclass">UserAuditAware.class</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserAuditAware</span> <span class="kd">implements</span> <span class="nc">AuditorAware</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">&gt;</span> <span class="nf">getCurrentAuditor</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Authentication</span> <span class="n">authentication</span> <span class="o">=</span> <span class="nc">SecurityContextHolder</span><span class="o">.</span><span class="na">getContext</span><span class="o">().</span><span class="na">getAuthentication</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">authentication</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="o">!</span><span class="n">authentication</span><span class="o">.</span><span class="na">isAuthenticated</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">empty</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="nc">CustomUserDetails</span> <span class="n">userDetails</span> <span class="o">=</span> <span class="o">(</span><span class="nc">CustomUserDetails</span><span class="o">)</span> <span class="n">authentication</span><span class="o">.</span><span class="na">getPrincipal</span><span class="o">();</span>
        <span class="k">return</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">userDetails</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="applicationclass-1">Application.class</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@EnableJpaAuditing</span><span class="o">(</span><span class="n">auditorAwareRef</span> <span class="o">=</span> <span class="s">"userAuditorAware"</span><span class="o">)</span>
<span class="nd">@SpringBootApplication</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Application</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">CaffeineApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ìœ„ì—ì„œ ì„¤ì •í•´ì¤€ main ë©”ì„œë“œì— êµ¬í˜„í•´ì¤€ í´ë˜ìŠ¤ì˜ ë¹ˆ ì´ë¦„ì„ ì„¤ì •í•´ì£¼ë©´ í•´ë‹¹ í´ë˜ìŠ¤ë¥¼ ì´ìš©í•˜ì—¬ ì‚¬ìš©ì ì •ë³´ë¥¼ ìë™ìœ¼ë¡œ ë“±ë¡í•  ìˆ˜ ìˆê²Œ ëœë‹¤.<br />
<br />
<br />
<br /></p>

<h2 id="íŠ¸ëŸ¬ë¸”-ìŠˆíŒ…-">íŠ¸ëŸ¬ë¸” ìŠˆíŒ… ğŸ’«</h2>

<h3 id="ì–´ë¼-ì™œ-updateë¬¸ì˜-ê²°ê³¼ë¥¼-í™•ì¸í•˜ëŠ”ë°-createddatetimeì´-nullë¡œ-ì—…ë°ì´íŠ¸-ë˜ì§€">ì–´ë¼ ì™œ updateë¬¸ì˜ ê²°ê³¼ë¥¼ í™•ì¸í•˜ëŠ”ë° createdDateTimeì´ nullë¡œ ì—…ë°ì´íŠ¸ ë˜ì§€â“ğŸ¤”</h3>
<p>ìƒì„±ì¼ ì»¬ëŸ¼ì— ì´ë¦„ì„ ì„¤ì •í•˜ê¸° ìœ„í•´ <code class="language-plaintext highlighter-rouge">@Column</code> ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì˜€ëŠ”ë°, <code class="language-plaintext highlighter-rouge">@Column</code>ì˜ ì˜µì…˜ ì¤‘ í•˜ë‚˜ì¸ updatableì˜ ê¸°ë³¸ê°’ì´ trueë¼ì„œ ê°’ì„ ì„¤ì •í•´ì£¼ì§€ ì•Šì€ ìƒì„±ì¼ ì»¬ëŸ¼ì— nullì´ ì—…ë°ì´íŠ¸ëœ ê²ƒì´ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Target</span><span class="o">({</span><span class="no">METHOD</span><span class="o">,</span> <span class="no">FIELD</span><span class="o">})</span> 
<span class="nd">@Retention</span><span class="o">(</span><span class="no">RUNTIME</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">Column</span> <span class="o">{</span>
	<span class="cm">/**
	* (Optional) Whether the column is included in SQL UPDATE 
	* statements generated by the persistence provider.
	*/</span>
	<span class="kt">boolean</span> <span class="nf">updatable</span><span class="o">()</span> <span class="k">default</span> <span class="o">**</span><span class="kc">true</span><span class="o">**;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ê·¸ë˜ì„œ <code class="language-plaintext highlighter-rouge">@Column</code>ì„ ì‚¬ìš©í•  ê±°ë¼ë©´ ì•„ë˜ì²˜ëŸ¼ <strong>updatable</strong> ì˜µì…˜ì„ <strong>false</strong>ë¡œ ì§€ì •í•´ì£¼ëŠ” ê²ƒì´ í•„ìš”í•˜ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@CreatedDate</span>
<span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"created_date_time"</span><span class="o">,</span> <span class="n">updatable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
<span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">createdDateTime</span><span class="o">;</span>
</code></pre></div></div>

<p>ë‹¤ì‹œ ìƒê°í•´ë³´ë‹ˆ <code class="language-plaintext highlighter-rouge">@Column</code> ì–´ë…¸í…Œì´ì…˜ì„ ê¼­ ì¨ì•¼í• ê¹Œ? í•˜ëŠ” ì˜ë¬¸ì´ ë“¤ì—ˆë‹¤. ë‚´ê°€ <code class="language-plaintext highlighter-rouge">@Column</code>ì„ ì¼ë˜ ì´ìœ ëŠ” Javaì˜ ì¹´ë©œì¼€ì´ìŠ¤ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì˜ ìŠ¤ë„¤ì´í¬ì¼€ì´ìŠ¤ì™€ ì—°ê²°ì‹œí‚¤ê³  ì‹¶ì–´ì„œì˜€ë‹¤. 
ê·¸ëŸ°ë° ì•„ë˜ì²˜ëŸ¼ YML íŒŒì¼ì— ì„¤ì •í•˜ë©´ ìë™ ì—°ê²°ì´ ëœë‹¤ë‹ˆ ğŸ’¦ ì•ìœ¼ë¡œëŠ” ì´ëŸ° ì„¤ì • í•˜ë‚˜ë¡œ ì½”ë“œë¥¼ ì¤„ì´ê¸° ìœ„í•´ í•œë²ˆì”©ì€ ê¼­ ì°¾ì•„ë³´ê³  ì‘ì—…í•  í•„ìš”ë¥¼ ëŠê¼ˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">spring:</span>
  <span class="nl">jpa:</span>
    <span class="nl">hibernate:</span>
      <span class="nl">naming:</span>
        <span class="n">physical</span><span class="o">-</span><span class="nl">strategy:</span> <span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">boot</span><span class="o">.</span><span class="na">model</span><span class="o">.</span><span class="na">naming</span><span class="o">.</span><span class="na">CamelCaseToUnderscoresNamingStrategy</span>
</code></pre></div></div>

<p>â• ì¶”ê°€ë¡œ <code class="language-plaintext highlighter-rouge">@CreatedDate</code>/<code class="language-plaintext highlighter-rouge">@CreatedBy</code>ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì—”í‹°í‹°ê°€ ì²˜ìŒ ì €ì¥ë  ë•Œ ìë™ìœ¼ë¡œ ê°’ì´ ì„¤ì •ë˜ì§€ë§Œ, ì§ì ‘ ë³€ê²½í•˜ê±°ë‚˜ Native Queryë¡œëŠ” ìˆ˜ì • ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— <code class="language-plaintext highlighter-rouge">@Column(updatable = false)</code>ì„ ì„¤ì •í•˜ëŠ” ê²ƒì´ ì•ˆì „í•˜ë‹¤.<br />
<br />
<br /></p>

<p><strong>ì°¸ê³ </strong></p>
<ul>
  <li><a href="https://docs.spring.io/spring-data/jpa/reference/auditing.html">Spring ê³µì‹ ë¬¸ì„œ</a></li>
  <li><a href="https://hudi.blog/spring-data-jpa-auditing-create-update-date/">https://hudi.blog/spring-data-jpa-auditing-create-update-date/</a></li>
</ul>]]></content><author><name>Dajeong Park</name></author><category term="wiki" /><category term="JPA" /><category term="Auditing" /><summary type="html"><![CDATA[Spring Data JPAì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µí•´ì£¼ëŠ” ê¸°ëŠ¥ ì¤‘ í¸ë¦¬í•œ ê¸°ëŠ¥ë“¤ì´ ë§ì€ë°, ê·¸ì¤‘ ë‚´ê²Œ ì¶©ê²©ì„ ì£¼ì—ˆë˜ ê¸°ëŠ¥ì´ ë°”ë¡œ Auditingì´ì—ˆë‹¤. MyBatisì—ì„œëŠ” ì¼ì¼ì´ ì„¤ì •í•˜ê±°ë‚˜ ì§€ì •í•´ì¤˜ì•¼ í–ˆë˜ ë¶€ë¶„ì´ ê¸°ëŠ¥ìœ¼ë¡œ ìˆë‹¤ë‹ˆ.. ì˜¤ëŠ˜ì€ JPA Auditingì— ëŒ€í•´ì„œ ìì„¸íˆ ì•Œì•„ë³´ê³ , ì•„ì§ ì‚¬ìš©í•´ë³´ì§€ ëª»í•œ AuditorAware ê¸°ëŠ¥ê³¼ ì‹¤ë¬´ì—ì„œ ê²ªì—ˆë˜ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…ê¹Œì§€ ì¶”ê°€í•´ì„œ ê¸°ë¡í•´ë‘ë ¤ê³  í•œë‹¤.]]></summary></entry><entry><title type="html">Spring @Scheduledë¡œ ê°„ë‹¨í•˜ê²Œ ì›í•˜ëŠ” ì‹œê°„ì— ìŠ¤ì¼€ì¤„ì„ ë“±ë¡í•´ë³´ì</title><link href="http://localhost:4000/wiki/2025/02/13/spring-scheduled-annotation.html" rel="alternate" type="text/html" title="Spring @Scheduledë¡œ ê°„ë‹¨í•˜ê²Œ ì›í•˜ëŠ” ì‹œê°„ì— ìŠ¤ì¼€ì¤„ì„ ë“±ë¡í•´ë³´ì" /><published>2025-02-13T00:00:00+09:00</published><updated>2025-02-13T00:00:00+09:00</updated><id>http://localhost:4000/wiki/2025/02/13/spring-scheduled-annotation</id><content type="html" xml:base="http://localhost:4000/wiki/2025/02/13/spring-scheduled-annotation.html"><![CDATA[<p>ì˜¤ëŠ˜ì€ ì‹¤ë¬´ì—ì„œ ìì£¼ ì‚¬ìš©í•˜ëŠ” <code class="language-plaintext highlighter-rouge">@Scheduled</code>ì— ëŒ€í•´ì„œ ì •ë¦¬í•´ë‘ë ¤ê³  í•œë‹¤. ì´ë²ˆ í”„ë¡œì íŠ¸ì—ì„œë„ ì–´ê¹€ì—†ì´ <code class="language-plaintext highlighter-rouge">@Scheduled</code>ë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ì—ˆëŠ”ë°, ë§ˆì¹¨ ì´ë²ˆì— ì•Œê²Œ ëœ ë¶€ë¶„ê¹Œì§€ ì¶”ê°€í•´ì„œ <code class="language-plaintext highlighter-rouge">@Scheduled</code>ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ê³¼ <code class="language-plaintext highlighter-rouge">@Scheduled</code>ì—ì„œ ì›í•˜ëŠ” ì‹œê°„ì— ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ëŒë¦´ ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” Cronì‹ê¹Œì§€ ì•Œì•„ë³´ì.
<br />
<br /></p>

<h2 id="scheduled">@Scheduled</h2>
<ul>
  <li><code class="language-plaintext highlighter-rouge">@Scheduled</code>ëŠ” Springì—ì„œ ì œê³µí•˜ëŠ” ìŠ¤ì¼€ì¤„ë§ ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ, íŠ¹ì • ì‘ì—…ì„ ì¼ì •í•œ ì£¼ê¸°ë¡œ ìë™ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤€ë‹¤.</li>
  <li>ì•Œë¦¼ ì „ì†¡, ë°°ì¹˜ ì‘ì—…, ë°ì´í„° ë°±ì—… ë“±ì˜ ì£¼ê¸°ì ì¸ ì‘ì—…ì„ ìˆ˜í–‰í•´ì•¼ í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
<br /></li>
</ul>

<h3 id="scheduled-ì„¤ì •">@Scheduled ì„¤ì •</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@EnableScheduling</span>
<span class="nd">@SpringBootApplication</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SchedulerApplication</span> <span class="o">{</span> 
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>        
		<span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">DemoApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>    
	<span class="o">}</span> 
<span class="o">}</span>

</code></pre></div></div>
<ul>
  <li>ë¨¼ì € Application í´ë˜ìŠ¤ main() ë©”ì†Œë“œì— <code class="language-plaintext highlighter-rouge">@EnableScheduling</code> ì–´ë…¸í…Œì´ì…˜ì„ ì„¤ì •í•´ì¤€ë‹¤. (Config í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ì„œ ì§€ì •í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•˜ë‹¤.)
<br /></li>
</ul>

<h3 id="scheduled-ì‚¬ìš©ë²•">@Scheduled ì‚¬ìš©ë²•</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SchedulerService</span> <span class="o">{</span>
	<span class="nd">@Scheduled</span><span class="o">(</span><span class="n">fixedDelay</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">)</span> <span class="c1">// 1ì´ˆë§ˆë‹¤ ì‹¤í–‰</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Hello Cron!"</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>ê·¸ëŸ¬ë©´ ì´ì œ ë©”ì†Œë“œì—ëŠ” <code class="language-plaintext highlighter-rouge">@Scheduled</code> ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ë°, ì£¼ì˜í•´ì•¼ í•  ì ì€ <code class="language-plaintext highlighter-rouge">@Scheduled</code>ë¥¼ ì‚¬ìš©í•  í´ë˜ìŠ¤ê°€ ìŠ¤í”„ë§ ë¹ˆì— ë“±ë¡ëœ í´ë˜ìŠ¤ì—¬ì•¼ í•œë‹¤ëŠ” ê²ƒì´ë‹¤.
    <ul>
      <li><code class="language-plaintext highlighter-rouge">@Component</code>, <code class="language-plaintext highlighter-rouge">@Service</code> ë“±
<br /></li>
    </ul>
  </li>
</ul>

<h3 id="scheduled-ë©”ì†Œë“œ-ê·œì¹™">@Scheduled ë©”ì†Œë“œ ê·œì¹™</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">@Scheduled</code>ë¥¼ ì‚¬ìš©í•˜ëŠ” ë©”ì†Œë“œëŠ” ì•„ë˜ ë‘ ê·œì¹™ì„ ì§€ì¼œì•¼ í•œë‹¤.
    <ol>
      <li>void ë¦¬í„´ íƒ€ì…</li>
      <li>ë§¤ê°œë³€ìˆ˜ ì‚¬ìš© ë¶ˆê°€
<br />
<br /></li>
    </ol>
  </li>
</ul>

<h2 id="scheduled-ì†ì„±">@Scheduled ì†ì„±</h2>

<h3 id="fixeddelay">fixedDelay</h3>
<ul>
  <li>ì´ì „ Taskì˜ ì¢…ë£Œ ì‹œì ë¶€í„° ì •ì˜ëœ ì‹œê°„ë§Œí¼ ì§€ë‚œ í›„ Task ì‹¤í–‰ (ë‹¨ìœ„: milliseconds)</li>
  <li>(ì‘ì—… ìˆ˜í–‰ ì‹œê°„ì„ í¬í•¨í•˜ì—¬) <strong>ì‘ì—…ì„ ë§ˆì¹œ í›„ë¶€í„°</strong> ì¼ì • ì£¼ê¸°ë§ˆë‹¤ ë©”ì†Œë“œ í˜¸ì¶œ</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Scheduled</span><span class="o">(</span><span class="n">fixedDelay</span> <span class="o">=</span> <span class="mi">5000</span><span class="o">)</span> <span class="c1">// 5ì´ˆë§ˆë‹¤ ì‹¤í–‰</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">fixedDelaySchedule</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"FixedDelay Task = {}"</span><span class="o">,</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">0</span><span class="n">ì´ˆ</span> <span class="o">-&gt;</span> <span class="n">ì‹¤í–‰</span> <span class="o">(</span><span class="mi">3</span><span class="n">ì´ˆ</span> <span class="n">ê±¸ë¦¼</span><span class="o">,</span> <span class="mi">5</span><span class="n">ì´ˆ</span> <span class="n">ëŒ€ê¸°</span><span class="o">)</span>
<span class="mi">8</span><span class="n">ì´ˆ</span> <span class="o">-&gt;</span> <span class="n">ì‹¤í–‰</span> <span class="o">(</span><span class="mi">3</span><span class="n">ì´ˆ</span> <span class="n">ê±¸ë¦¼</span><span class="o">,</span> <span class="mi">5</span><span class="n">ì´ˆ</span> <span class="n">ëŒ€ê¸°</span><span class="o">)</span>
<span class="mi">13</span><span class="n">ì´ˆ</span> <span class="o">-&gt;</span> <span class="n">ì‹¤í–‰</span>
</code></pre></div></div>

<h3 id="fixedrate">fixedRate</h3>
<ul>
  <li>ì´ì „ Taskì˜ ì‹œì‘ ì‹œì ìœ¼ë¡œë¶€í„° ì •ì˜ëœ ì‹œê°„ë§Œí¼ ì§€ë‚œ í›„ Task ì‹¤í–‰ (ë‹¨ìœ„: milliseconds)</li>
  <li><strong>ì‘ì—… ìˆ˜í–‰ì‹œê°„ê³¼ ìƒê´€ì—†ì´</strong> ì¼ì • ì£¼ê¸°ë§ˆë‹¤ ë©”ì†Œë“œ í˜¸ì¶œ</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Scheduled</span><span class="o">(</span><span class="n">fixedRate</span> <span class="o">=</span> <span class="mi">5000</span><span class="o">)</span> <span class="c1">// 5ì´ˆë§ˆë‹¤ ì‹¤í–‰</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">fixedRateSchedule</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"FixedRate Task = {}"</span><span class="o">,</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">0</span><span class="n">ì´ˆ</span> <span class="o">-&gt;</span> <span class="n">ì‹¤í–‰</span> <span class="o">(</span><span class="mi">3</span><span class="n">ì´ˆ</span> <span class="n">ê±¸ë¦¼</span><span class="o">)</span>
<span class="mi">5</span><span class="n">ì´ˆ</span> <span class="o">-&gt;</span> <span class="n">ì‹¤í–‰</span> <span class="o">(</span><span class="mi">3</span><span class="n">ì´ˆ</span> <span class="n">ê±¸ë¦¼</span><span class="o">)</span>
<span class="mi">10</span><span class="n">ì´ˆ</span> <span class="o">-&gt;</span> <span class="n">ì‹¤í–‰</span>
</code></pre></div></div>

<h3 id="initialdelay">initialDelay</h3>
<ul>
  <li>ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ í›„ ì´ˆê¸° ì§€ì—°ì‹œê°„ ì„¤ì •</li>
  <li>ì„œë²„ê°€ ì‹œì‘ë˜ìë§ˆì ì‹¤í–‰ë˜ëŠ” ê²ƒì„ ë°©ì§€</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Scheduled</span><span class="o">(</span><span class="n">fixedRate</span> <span class="o">=</span> <span class="mi">5000</span><span class="o">,</span> <span class="n">initialDelay</span> <span class="o">=</span> <span class="mi">10000</span><span class="o">)</span> <span class="c1">// 5ì´ˆë§ˆë‹¤ ì‹¤í–‰, ì´ˆê¸° 10ì´ˆ ëŒ€ê¸°</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialDelaySchedule</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"InitialDelay Task = {}"</span><span class="o">,</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ì•±</span> <span class="n">ì‹œì‘</span> <span class="o">-&gt;</span> <span class="mi">10</span><span class="n">ì´ˆ</span> <span class="n">ëŒ€ê¸°</span>
<span class="mi">10</span><span class="n">ì´ˆ</span> <span class="o">-&gt;</span> <span class="n">ì‹¤í–‰</span>
<span class="mi">15</span><span class="n">ì´ˆ</span> <span class="o">-&gt;</span> <span class="n">ì‹¤í–‰</span>
<span class="mi">20</span><span class="n">ì´ˆ</span> <span class="o">-&gt;</span> <span class="n">ì‹¤í–‰</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h2 id="cron">Cron</h2>
<ul>
  <li>ì¼ì •í•œ ì£¼ê¸°ê°€ ì•„ë‹ˆë¼ íŠ¹ì • ì‹œê°„ì— ì‘ì—…ì„ ì‹¤í–‰í•˜ê³  ì‹¶ë‹¤ë©´ cron ì†ì„±ì— Cronì‹ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Scheduled</span><span class="o">(</span><span class="n">cron</span> <span class="o">=</span> <span class="s">"0 0 10 * * *"</span><span class="o">)</span> <span class="c1">// ë§¤ì¼ ì˜¤ì „ 10ì‹œ ì‹¤í–‰</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">cronSchedule</span><span class="o">()</span> <span class="o">{</span>
	<span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Cron Task = {}"</span><span class="o">,</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="ìˆœì„œ">ìˆœì„œ</h3>
<p>1.ì´ˆ(0-59)
2.ë¶„(0-59)
3.ì‹œê°„(0-23)
4.ì¼(1-31)
5.ì›”(1-12)
6.ìš”ì¼(0-6) (0:ì¼, â€¦ 6: í† )</p>

<h3 id="í‘œí˜„">í‘œí˜„</h3>

<table>
  <thead>
    <tr>
      <th>í‘œí˜„</th>
      <th>ì„¤ëª…</th>
      <th>ì˜ˆì‹œ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>*</td>
      <td>ëª¨ë“  ì¡°ê±´ (ë§¤ì‹œ, ë§¤ì¼, ë§¤ì£¼ì²˜ëŸ¼ ì‚¬ìš©)</td>
      <td>0 0 18 * * * -&gt; ë§¤ì¼ 18ì‹œ</td>
    </tr>
    <tr>
      <td>?</td>
      <td>ì„¤ì •ê°’ ì—†ìŒ (ë‚ ì§œ, ìš”ì¼ì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥)</td>
      <td>0 0 14 10,20 * ? -&gt; ë§¤ë‹¬ 10ì¼, 20ì¼ 14ì‹œ</td>
    </tr>
    <tr>
      <td>-</td>
      <td>ë²”ìœ„ ì§€ì •</td>
      <td>0 0/5 9-18 * * * -&gt; ë§¤ì¼ 9ì‹œ0ë¶„ì—ì„œ18ì‹œ55ë¶„ ì‚¬ì´ì— 5ë¶„ ê°„ê²©</td>
    </tr>
    <tr>
      <td>,</td>
      <td>ì—¬ëŸ¬ ê°’ ì§€ì •</td>
      <td>0 0 14 10,20 * ? -&gt; ë§¤ë‹¬ 10ì¼, 20ì¼ 14ì‹œ</td>
    </tr>
    <tr>
      <td>/</td>
      <td>ì¦ë¶„ê°’, ì¦‰ ì´ˆê¸°ê°’ê³¼ ì¦ê°€ì¹˜ ì„¤ì •ì— ì‚¬ìš©</td>
      <td>0 0 0/1 * * * -&gt; 1ì‹œê°„ë§ˆë‹¤</td>
    </tr>
    <tr>
      <td>L</td>
      <td>ë§ˆì§€ë§‰ - ì§€ì •í•  ìˆ˜ ìˆëŠ” ë²”ìœ„ì˜ ë§ˆì§€ë§‰ ê°’ ì„¤ì • ì‹œ ì‚¬ìš© (ë‚ ì§œ, ìš”ì¼ì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥)</td>
      <td>0 30 10 ? * 6L -&gt; ë§¤ë‹¬ ë§ˆì§€ë§‰ í† ìš”ì¼ 10ì‹œ 30ë¶„ë§ˆë‹¤</td>
    </tr>
    <tr>
      <td>W</td>
      <td>ê°€ì¥ ê°€ê¹Œìš´ í‰ì¼(weekday) ì„¤ì •</td>
      <td>10W -&gt; 10ì¼ì´ í‰ì¼ì´ë©´ 10ì¼, ì£¼ë§ì´ë©´ ê°€ê¹Œìš´ í‰ì¼ì— ì‹¤í–‰</td>
    </tr>
    <tr>
      <td>#</td>
      <td>Në²ˆì§¸ ì£¼ íŠ¹ì • ìš”ì¼ ì„¤ì • (ìš”ì¼ì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥)</td>
      <td>4#2 â†’ ëª©ìš”ì¼#ë‘˜ì§¸ì£¼ì— ì‹¤í–‰</td>
    </tr>
  </tbody>
</table>

<p><strong><code class="language-plaintext highlighter-rouge">*</code>ì™€ <code class="language-plaintext highlighter-rouge">?</code>ì˜ ì°¨ì´</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">?</code>ëŠ” íŠ¹ì • ê°’ì„ ì§€ì •í•˜ì§€ ì•ŠìŒì„ ì˜ë¯¸í•˜ëŠ”ë°, <code class="language-plaintext highlighter-rouge">*</code>ì™€ í—·ê°ˆë¦´ ìˆ˜ ìˆë‹¤.</li>
  <li>ì˜ˆë¥¼ ë“¤ì–´ <code class="language-plaintext highlighter-rouge">â€œ0 0 12 * * ?â€</code>ëŠ” ë§¤ì¼ 12ì‹œì— ì‹¤í–‰í•˜ì§€ë§Œ, <code class="language-plaintext highlighter-rouge">â€œ0 0 12 * * *â€</code>ëŠ” ë§¤ì¼ 12ì‹œì— ì‹¤í–‰í•˜ë©´ì„œ ìš”ì¼ë„ ëª¨ë“  ê°’ì— í•´ë‹¹ëœë‹¤ëŠ” ì°¨ì´ì ì´ ìˆë‹¤.
<br /></li>
</ul>

<h3 id="zone">zone</h3>
<ul>
  <li>cron í‘œí˜„ì‹ì—ì„œ ì‚¬ìš©í•  time zone (default: Local time zone)</li>
  <li>ì„œë²„ì˜ ê¸°ë³¸ ì‹œê°„ëŒ€ì— ì˜ì¡´í•˜ë©´ ë°°í¬ í™˜ê²½ë§ˆë‹¤ ì‹¤í–‰ ì‹œê°„ì´ ë‹¤ë¥¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ zoneìœ¼ë¡œ ëª…í™•í•˜ê²Œ ì§€ì •í•´ì£¼ëŠ” ê²ƒì´ ì¢‹ë‹¤.
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Scheduled</span><span class="o">(</span><span class="n">cron</span> <span class="o">=</span> <span class="err">â€œ</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">12</span> <span class="o">*</span> <span class="o">*</span> <span class="o">?</span><span class="err">â€</span><span class="o">,</span> <span class="n">zone</span> <span class="o">=</span> <span class="s">"Asia/Seoul"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">seoulTimeZoneTask</span><span class="o">()</span> <span class="o">{</span>
  <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"í•œêµ­ ì‹œê°„ ê¸°ì¤€ 12ì‹œ ì‹¤í–‰"</span><span class="o">);</span>
<span class="o">}</span>    
</code></pre></div>    </div>
    <p><br />
<br /></p>
  </li>
</ul>

<h2 id="trouble-shooting-">Trouble Shooting ğŸ’«</h2>

<h3 id="ê°™ì€-ì‹œê°„ì—-ë‘-ê°œì˜-ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼-ì„¤ì •í–ˆëŠ”ë°-ì™œ-í•˜ë‚˜ë§Œ-ì‹¤í–‰ë ê¹Œ">ê°™ì€ ì‹œê°„ì— ë‘ ê°œì˜ ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ì„¤ì •í–ˆëŠ”ë° ì™œ í•˜ë‚˜ë§Œ ì‹¤í–‰ë ê¹Œâ“ğŸ¤”</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">@Scheduled</code>ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ <strong>ì‹±ê¸€ ìŠ¤ë ˆë“œ</strong>ì—ì„œ ì‹¤í–‰ë˜ë¯€ë¡œ, ì—¬ëŸ¬ ê°œì˜ ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ë™ì‹œì— ì‹¤í–‰í•˜ë ¤ë©´ application.ymlì´ë‚˜ Config í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤ë ˆë“œ í’€ì„ 2ê°œ ì´ìƒìœ¼ë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nl">task:</span>
    <span class="nl">scheduling:</span>
      <span class="nl">pool:</span>
        <span class="nl">size:</span> <span class="mi">5</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TaskSchedulerConfig</span> <span class="o">{</span>
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">TaskScheduler</span> <span class="nf">taskScheduler</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">ThreadPoolTaskScheduler</span> <span class="n">scheduler</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ThreadPoolTaskScheduler</span><span class="o">();</span>
        <span class="n">scheduler</span><span class="o">.</span><span class="na">setPoolSize</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span>
        <span class="n">scheduler</span><span class="o">.</span><span class="na">initialize</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">scheduler</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="ì‹œê°„ë§ˆë‹¤-ë§ê³ -í•œ-ë²ˆë§Œ-ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼-ì‹¤í–‰ì‹œí‚¬-ìˆ˜ëŠ”-ì—†ë‚˜">ì‹œê°„ë§ˆë‹¤ ë§ê³  í•œ ë²ˆë§Œ ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ëŠ” ì—†ë‚˜â“ğŸ¤”</h3>
<ul>
  <li>í•œ ë²ˆë§Œ ì‹¤í–‰ë˜ëŠ” ìŠ¤ì¼€ì¤„ë§ ì‘ì—…ì€ ì—¬ëŸ¬ ê°€ì§€ê°€ ìˆì§€ë§Œ, ìŠ¤í”„ë§ì„ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ TaskScheduler ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ ThreadPoolTaskSchedulerë¥¼ ì‚¬ìš©í•´ë³¼ ìˆ˜ ìˆë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">@Scheduled</code>ì²˜ëŸ¼ ì„¤ì •ë§Œ í•´ì£¼ë©´ ë©€í‹° ìŠ¤ë ˆë“œê°€ ê°€ëŠ¥í•˜ê³ , ëŒ€ëŸ‰ì˜ ì‘ì—…ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OneTimeTaskSchedulerService</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">ThreadPoolTaskScheduler</span> <span class="n">taskScheduler</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">OneTimeTaskSchedulerService</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">taskScheduler</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ThreadPoolTaskScheduler</span><span class="o">();</span>
        <span class="k">this</span><span class="o">.</span><span class="na">taskScheduler</span><span class="o">.</span><span class="na">initialize</span><span class="o">();</span> <span class="c1">// ì´ˆê¸°í™” í•„ìˆ˜</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">scheduleOneTimeTask</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">taskScheduler</span><span class="o">.</span><span class="na">schedule</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"10ë¶„ í›„ ì‹¤í–‰ë˜ëŠ” ì‘ì—… ì‹¤í–‰ë¨! "</span> <span class="o">+</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
            <span class="c1">// ì‹¤í–‰í•  ë¡œì§ ì¶”ê°€</span>
        <span class="o">},</span> <span class="nc">Instant</span><span class="o">.</span><span class="na">now</span><span class="o">().</span><span class="na">plusSeconds</span><span class="o">(</span><span class="mi">600</span><span class="o">));</span> <span class="c1">// í˜„ì¬ ì‹œê°„ ê¸°ì¤€ 600ì´ˆ(10ë¶„) í›„ ì‹¤í–‰</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>ìœ„ì—ì„œì²˜ëŸ¼ Config í´ë˜ìŠ¤ë¡œ <code class="language-plaintext highlighter-rouge">@Bean</code> ë“±ë¡ì„ í•´ì¤€ë‹¤ë©´ ìƒì„±ìì—ì„œ ì´ˆê¸°í™”í•  í•„ìš” ì—†ì–´ ì½”ë“œë„ ê°„ê²°í•˜ê³ , ì—¬ëŸ¬ ê³³ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ ë” í¸ë¦¬í•˜ë‹¤.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RequiredArgsConstructor</span>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OneTimeTaskSchedulerService</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">TaskScheduler</span> <span class="n">taskScheduler</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">scheduleOneTimeTask</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">taskScheduler</span><span class="o">.</span><span class="na">schedule</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"ì˜ˆì•½ëœ ì‘ì—…ì´ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤! "</span> <span class="o">+</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
            <span class="c1">// ì‹¤í–‰í•  ë¡œì§ ì¶”ê°€</span>
        <span class="o">},</span> <span class="nc">Instant</span><span class="o">.</span><span class="na">now</span><span class="o">().</span><span class="na">plusSeconds</span><span class="o">(</span><span class="mi">600</span><span class="o">));</span> <span class="c1">// í˜„ì¬ ì‹œê°„ ê¸°ì¤€ 600ì´ˆ(10ë¶„) í›„ ì‹¤í–‰</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<p><strong>ì°¸ê³ </strong></p>
<ul>
  <li><a href="https://spring.io/guides/gs/scheduling-tasks">Spring ê³µì‹ ê°€ì´ë“œ</a></li>
  <li><a href="https://dev-coco.tistory.com/176">https://dev-coco.tistory.com/176</a></li>
  <li><a href="https://data-make.tistory.com/699">https://data-make.tistory.com/699</a></li>
  <li><a href="https://chatgpt.com/c/67ac8d2b-83d0-8003-98ec-3ffc372b8437">https://chatgpt.com/c/67ac8d2b-83d0-8003-98ec-3ffc372b8437</a></li>
</ul>]]></content><author><name>Dajeong Park</name></author><category term="wiki" /><category term="Spring" /><category term="Scheduled" /><category term="TaskScheduler" /><category term="Annotation" /><summary type="html"><![CDATA[ì˜¤ëŠ˜ì€ ì‹¤ë¬´ì—ì„œ ìì£¼ ì‚¬ìš©í•˜ëŠ” @Scheduledì— ëŒ€í•´ì„œ ì •ë¦¬í•´ë‘ë ¤ê³  í•œë‹¤. ì´ë²ˆ í”„ë¡œì íŠ¸ì—ì„œë„ ì–´ê¹€ì—†ì´ @Scheduledë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ì—ˆëŠ”ë°, ë§ˆì¹¨ ì´ë²ˆì— ì•Œê²Œ ëœ ë¶€ë¶„ê¹Œì§€ ì¶”ê°€í•´ì„œ @Scheduledë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ê³¼ @Scheduledì—ì„œ ì›í•˜ëŠ” ì‹œê°„ì— ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ëŒë¦´ ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” Cronì‹ê¹Œì§€ ì•Œì•„ë³´ì.]]></summary></entry><entry><title type="html">QueryDSLì—ì„œ FROM ì ˆì— ì„œë¸Œì¿¼ë¦¬ë¥¼ ë„£ì–´ë³´ì (feat. @Subselect)</title><link href="http://localhost:4000/wiki/2025/01/31/querydsl-subselect.html" rel="alternate" type="text/html" title="QueryDSLì—ì„œ FROM ì ˆì— ì„œë¸Œì¿¼ë¦¬ë¥¼ ë„£ì–´ë³´ì (feat. @Subselect)" /><published>2025-01-31T00:00:00+09:00</published><updated>2025-01-31T00:00:00+09:00</updated><id>http://localhost:4000/wiki/2025/01/31/querydsl-subselect</id><content type="html" xml:base="http://localhost:4000/wiki/2025/01/31/querydsl-subselect.html"><![CDATA[<p>í˜„ì¬ ì§„í–‰í•˜ëŠ” í”„ë¡œì íŠ¸ì—ì„œ ì¿ í° ê´€ë ¨ ë³µì¡í•œ ì¿¼ë¦¬ë¥¼ ì‘ì„±í•˜ë˜ ì¤‘ì´ì—ˆë‹¤. 
SQLë¡œ ë¨¼ì € ì‘ì—…ì„ í•´ë³´ëŠ”ë° ì„œë¸Œì¿¼ë¦¬ë¥¼ from ì ˆì— ë„£ì–´ì•¼ ë°ì´í„°ê°€ ì œëŒ€ë¡œ ë‚˜ì˜¤ëŠ”ë°, QueryDSLì—ì„œëŠ” from ì ˆì— ì„œë¸Œì¿¼ë¦¬ë¥¼ ë„£ì„ ìˆ˜ ì—†ë‹¤ëŠ” ë¬¸ì œë¥¼ ìˆì—ˆë‹¤.
ê·¸ë˜ì„œ í•´ê²° ë°©ë²•ì„ ì°¾ì•„ë³´ë‹¤ê°€ <code class="language-plaintext highlighter-rouge">@Subselect</code>ë¼ëŠ” Hibernate ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ ì¿¼ë¦¬ë¥¼ ìº¡ìŠí™”í•´ì„œ Viewë¥¼ ë§Œë“¤ì–´ ì—”í‹°í‹°ì²˜ëŸ¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ê±¸ ì•Œê²Œ ë˜ì—ˆë‹¤.
ê·¸ë˜ì„œ @Subselectë¥¼ í™œìš©í•˜ì—¬ ì„œë¸Œì¿¼ë¦¬ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ê³µìœ í•˜ë ¤ê³  í•œë‹¤.</p>

<p><img width="743" alt="Image" src="https://github.com/user-attachments/assets/8d09e978-f260-4342-905f-fa789ffb653f" />
<br />
<br /></p>

<h3 id="ì„œë¸Œì¿¼ë¦¬ë¡œ-ì‚¬ìš©í• -í´ë˜ìŠ¤-ì„ ì–¸">ì„œë¸Œì¿¼ë¦¬ë¡œ ì‚¬ìš©í•  í´ë˜ìŠ¤ ì„ ì–¸</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Subselect</span><span class="o">(</span>
        <span class="s">"select c.id, ROW_NUMBER() OVER (ORDER BY cd.valid_end_date ASC) as rn "</span> <span class="o">+</span>
                <span class="s">"from coupons c "</span> <span class="o">+</span>
                <span class="s">"inner join coupon_duration_settings cd on c.id = cd.coupon_id "</span> <span class="o">+</span>
                <span class="s">"where c.discount_type = 'RATE' "</span> <span class="o">+</span>
                    <span class="s">"and c.discount_value = ("</span> <span class="o">+</span>
                        <span class="s">"select max(c2.discount_value) "</span> <span class="o">+</span>
                        <span class="s">"from coupons c2 "</span> <span class="o">+</span>
                        <span class="s">"where c2.discount_type = 'RATE'"</span> <span class="o">+</span>
                    <span class="s">")"</span>
<span class="o">)</span>
<span class="nd">@Immutable</span>
<span class="nd">@Synchronize</span><span class="o">(</span><span class="s">"coupons"</span><span class="o">)</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MaxRateCouponSubDto</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"id"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"rn"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">rn</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>selectë¬¸ì—ì„œ ì‚¬ìš©í•œ ì»¬ëŸ¼ëª…ê³¼ í•„ë“œì— <code class="language-plaintext highlighter-rouge">@Column</code> ì• ë…¸í…Œì´ì…˜ìœ¼ë¡œ ì„¤ì •í•´ì¤€ nameì´ ë™ì¼í•´ì•¼ ì°¾ì„ ìˆ˜ ìˆë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">@Subselect</code>ë¥¼ ì‚¬ìš©í•œ ì—”í‹°í‹°ëŠ” ì–´ë–¤ íŠ¹ì • ì—”í‹°í‹°ì— ì¢…ì†ëœ ê²ƒì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— <code class="language-plaintext highlighter-rouge">@Immutable</code>ì„ ì„ ì–¸í•´ì£¼ì–´ì•¼ í•˜ì—¬ ë¶ˆë³€(<strong>immutable</strong>), ì¦‰ ì½ê¸° ì „ìš©ìœ¼ë¡œ ë³€ê²½ ë¶ˆê°€í•¨ì„ ì„ ì–¸í•´ì•¼ í•œë‹¤.
    <ul>
      <li><code class="language-plaintext highlighter-rouge">@Immutable</code> : í•´ë‹¹ ì—”í‹°í‹°ê°€ ë³€ê²½ë˜ì§€ ì•ŠëŠ” ë°ì´í„°ì„ì„ Hibernateì—ê²Œ ì•Œë ¤ì£¼ëŠ” ì• ë…¸í…Œì´ì…˜ìœ¼ë¡œ, ë³€ê²½ ê°ì§€ë¥¼ ë°©ì§€í•˜ì—¬ ì„±ëŠ¥ì„ ìµœì í™”í•  ìˆ˜ ìˆë‹¤.  <br />
<img width="1003" alt="Image" src="https://github.com/user-attachments/assets/f033f851-4c23-4c52-b86e-e4f52c9e5f45" /></li>
    </ul>
  </li>
  <li>ë˜í•œ, ë™ì‹œì„± ë¬¸ì œë¥¼ ì œì–´í•˜ì—¬ ë°ì´í„°ì˜ ì¼ê´€ì„±ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ <code class="language-plaintext highlighter-rouge">@Sychronize</code>ì„ ì‚¬ìš©í–ˆë‹¤.
<br />
<br /></li>
</ul>

<h3 id="querydslì—ì„œ-ì‚¬ìš©">QueryDSLì—ì„œ ì‚¬ìš©</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">QMaxRateCouponSubDto</span> <span class="n">maxRateCouponSub</span> <span class="o">=</span> <span class="nc">QMaxRateCouponSubDto</span><span class="o">.</span><span class="na">maxRateCouponSubDto</span><span class="o">;</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">QMaxAmountCouponSubDto</span> <span class="n">maxAmountCouponSub</span> <span class="o">=</span> <span class="nc">QMaxAmountCouponSubDto</span><span class="o">.</span><span class="na">maxAmountCouponSubDto</span><span class="o">;</span>

<span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">HotelAndCouponResponse</span><span class="o">&gt;</span> <span class="nf">findHotelAndCoupons</span><span class="o">(</span><span class="nc">HotelSearchConditionDto</span> <span class="n">condition</span><span class="o">)</span> <span class="o">{</span>
 <span class="nc">BooleanBuilder</span> <span class="n">whereClause</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BooleanBuilder</span><span class="o">();</span>
 <span class="o">...</span> 
 <span class="k">return</span> <span class="n">queryFactory</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="nc">Projections</span><span class="o">.</span><span class="na">constructor</span><span class="o">(</span><span class="nc">HotelAndCouponResponse</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
                        <span class="n">hotel</span><span class="o">.</span><span class="na">id</span><span class="o">,</span>
                        <span class="nc">Projections</span><span class="o">.</span><span class="na">constructor</span><span class="o">(</span><span class="nc">CouponDto</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
                                <span class="n">rateCouponDuration</span><span class="o">.</span><span class="na">isTimeDeal</span><span class="o">.</span><span class="na">stringValue</span><span class="o">().</span><span class="na">max</span><span class="o">(),</span>
                                <span class="n">rateCouponDuration</span><span class="o">.</span><span class="na">validStartDate</span><span class="o">.</span><span class="na">max</span><span class="o">(),</span>
                                <span class="n">rateCouponDuration</span><span class="o">.</span><span class="na">validEndDate</span><span class="o">.</span><span class="na">max</span><span class="o">(),</span>
                                <span class="n">rateCoupon</span><span class="o">.</span><span class="na">discountType</span><span class="o">.</span><span class="na">max</span><span class="o">(),</span>
                                <span class="n">rateCoupon</span><span class="o">.</span><span class="na">discountValue</span><span class="o">.</span><span class="na">max</span><span class="o">(),</span>
                                <span class="n">rateCoupon</span><span class="o">.</span><span class="na">maxDiscountPrice</span><span class="o">.</span><span class="na">max</span><span class="o">()</span>
                        <span class="o">),</span>
                        <span class="nc">Projections</span><span class="o">.</span><span class="na">constructor</span><span class="o">(</span><span class="nc">CouponDto</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
                                <span class="n">amountCouponDuration</span><span class="o">.</span><span class="na">isTimeDeal</span><span class="o">.</span><span class="na">stringValue</span><span class="o">().</span><span class="na">max</span><span class="o">(),</span>
                                <span class="n">amountCouponDuration</span><span class="o">.</span><span class="na">validStartDate</span><span class="o">.</span><span class="na">max</span><span class="o">(),</span>
                                <span class="n">amountCouponDuration</span><span class="o">.</span><span class="na">validEndDate</span><span class="o">.</span><span class="na">max</span><span class="o">(),</span>
                                <span class="n">amountCoupon</span><span class="o">.</span><span class="na">discountType</span><span class="o">.</span><span class="na">max</span><span class="o">(),</span>
                                <span class="n">amountCoupon</span><span class="o">.</span><span class="na">discountValue</span><span class="o">.</span><span class="na">max</span><span class="o">(),</span>
                                <span class="n">amountCoupon</span><span class="o">.</span><span class="na">maxDiscountPrice</span><span class="o">.</span><span class="na">max</span><span class="o">()</span>
                        <span class="o">)</span>
                <span class="o">))</span>
                <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">hotel</span><span class="o">)</span>
                <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">couponUsageConditionObject</span><span class="o">).</span><span class="na">on</span><span class="o">(</span><span class="n">couponUsageConditionObject</span><span class="o">.</span><span class="na">hotel</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">hotel</span><span class="o">.</span><span class="na">id</span><span class="o">))</span>
                <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">rateCoupon</span><span class="o">).</span><span class="na">on</span><span class="o">(</span><span class="n">rateCoupon</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">couponUsageConditionObject</span><span class="o">.</span><span class="na">coupon</span><span class="o">.</span><span class="na">id</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="n">rateCoupon</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span>
                                <span class="nc">JPAExpressions</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">maxRateCouponSub</span><span class="o">.</span><span class="na">id</span><span class="o">)</span>
                                        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">maxRateCouponSub</span><span class="o">)</span>
                                        <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">maxRateCouponSub</span><span class="o">.</span><span class="na">rn</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="mi">1L</span><span class="o">))</span>
                        <span class="o">)))</span>
                <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">rateCouponDuration</span><span class="o">).</span><span class="na">on</span><span class="o">(</span><span class="n">rateCouponDuration</span><span class="o">.</span><span class="na">coupon</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">rateCoupon</span><span class="o">.</span><span class="na">id</span><span class="o">))</span>
                <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">amountCoupon</span><span class="o">).</span><span class="na">on</span><span class="o">(</span><span class="n">amountCoupon</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">couponUsageConditionObject</span><span class="o">.</span><span class="na">coupon</span><span class="o">.</span><span class="na">id</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="n">amountCoupon</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span>
                                <span class="nc">JPAExpressions</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">maxAmountCouponSub</span><span class="o">.</span><span class="na">id</span><span class="o">)</span>
                                        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">maxAmountCouponSub</span><span class="o">)</span>
                                        <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">maxAmountCouponSub</span><span class="o">.</span><span class="na">rn</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="mi">1L</span><span class="o">))</span>
                        <span class="o">)))</span>
                <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">amountCouponDuration</span><span class="o">).</span><span class="na">on</span><span class="o">(</span><span class="n">amountCouponDuration</span><span class="o">.</span><span class="na">coupon</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">amountCoupon</span><span class="o">.</span><span class="na">id</span><span class="o">))</span>
                <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">whereClause</span><span class="o">)</span>
                <span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="n">hotel</span><span class="o">.</span><span class="na">id</span><span class="o">)</span>
                <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>ìœ„ì—ì„œ ìƒì„±í•´ì¤€ í´ë˜ìŠ¤ë¥¼ Qí´ë˜ìŠ¤ë¡œ ì„ ì–¸í•˜ê³ , from ì ˆì— ë„£ì–´ ì‚¬ìš©í•˜ë©´ <code class="language-plaintext highlighter-rouge">@Subselect</code>ì— ì‘ì„±í•œ ì½”ë“œê°€ ê·¸ëŒ€ë¡œ ì„œë¸Œì¿¼ë¦¬ë¡œ ë“¤ì–´ê°„ë‹¤.</li>
</ul>

<p><strong>SQL ì˜ˆì‹œ</strong></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">h</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
       <span class="k">MAX</span><span class="p">(</span><span class="n">rcd</span><span class="p">.</span><span class="n">is_time_deal</span><span class="p">),</span>
       <span class="k">MAX</span><span class="p">(</span><span class="n">rcd</span><span class="p">.</span><span class="n">valid_start_date</span><span class="p">),</span>
       <span class="k">MAX</span><span class="p">(</span><span class="n">rcd</span><span class="p">.</span><span class="n">valid_end_date</span><span class="p">),</span>
       <span class="k">MAX</span><span class="p">(</span><span class="n">rc</span><span class="p">.</span><span class="n">discount_type</span><span class="p">),</span>
       <span class="k">MAX</span><span class="p">(</span><span class="n">rc</span><span class="p">.</span><span class="n">discount_value</span><span class="p">),</span>
       <span class="k">MAX</span><span class="p">(</span><span class="n">rc</span><span class="p">.</span><span class="n">max_discount_price</span><span class="p">),</span>
       <span class="k">MAX</span><span class="p">(</span><span class="n">acd</span><span class="p">.</span><span class="n">is_time_deal</span><span class="p">),</span>
       <span class="k">MAX</span><span class="p">(</span><span class="n">acd</span><span class="p">.</span><span class="n">valid_start_date</span><span class="p">),</span>
       <span class="k">MAX</span><span class="p">(</span><span class="n">acd</span><span class="p">.</span><span class="n">valid_end_date</span><span class="p">),</span>
       <span class="k">MAX</span><span class="p">(</span><span class="n">ac</span><span class="p">.</span><span class="n">discount_type</span><span class="p">),</span>
       <span class="k">MAX</span><span class="p">(</span><span class="n">ac</span><span class="p">.</span><span class="n">discount_value</span><span class="p">),</span>
       <span class="k">MAX</span><span class="p">(</span><span class="n">ac</span><span class="p">.</span><span class="n">max_discount_price</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">hotels</span> <span class="n">h</span>
         <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">coupon_usage_conditions</span> <span class="n">cuc</span>
                   <span class="k">ON</span> <span class="n">cuc</span><span class="p">.</span><span class="n">hotel_id</span> <span class="o">=</span> <span class="n">h</span><span class="p">.</span><span class="n">id</span>
         <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">rate_coupons</span> <span class="n">rc</span>
                   <span class="k">ON</span> <span class="n">rc</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">cuc</span><span class="p">.</span><span class="n">coupon_id</span>
                       <span class="k">AND</span> <span class="n">rc</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="p">(</span>
                           <span class="k">SELECT</span> <span class="n">mrt</span><span class="p">.</span><span class="n">id</span>
                           <span class="k">FROM</span> <span class="p">(</span>
                                    <span class="k">select</span> <span class="k">c</span><span class="p">.</span><span class="n">id</span><span class="p">,</span> <span class="n">ROW_NUMBER</span><span class="p">()</span> <span class="n">OVER</span> <span class="p">(</span><span class="k">ORDER</span> <span class="k">BY</span> <span class="n">cd</span><span class="p">.</span><span class="n">valid_end_date</span> <span class="k">ASC</span><span class="p">)</span> <span class="k">as</span> <span class="n">rn</span>
                                    <span class="k">from</span> <span class="n">coupons</span> <span class="k">c</span>
                                             <span class="k">inner</span> <span class="k">join</span> <span class="n">coupon_duration_settings</span> <span class="n">cd</span> <span class="k">on</span> <span class="k">c</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">cd</span><span class="p">.</span><span class="n">coupon_id</span>
                                    <span class="k">where</span> <span class="k">c</span><span class="p">.</span><span class="n">discount_type</span> <span class="o">=</span> <span class="s1">'RATE'</span>
                                      <span class="k">and</span> <span class="k">c</span><span class="p">.</span><span class="n">discount_value</span> <span class="o">=</span> <span class="p">(</span>
                                        <span class="k">select</span> <span class="k">max</span><span class="p">(</span><span class="n">c2</span><span class="p">.</span><span class="n">discount_value</span><span class="p">)</span>
                                        <span class="k">from</span> <span class="n">coupons</span> <span class="n">c2</span>
                                        <span class="k">where</span> <span class="n">c2</span><span class="p">.</span><span class="n">discount_type</span> <span class="o">=</span> <span class="s1">'RATE'</span>
                                    <span class="p">)</span>
                                <span class="p">)</span> <span class="n">mrt</span>
                           <span class="k">WHERE</span> <span class="n">mrt</span><span class="p">.</span><span class="n">rn</span> <span class="o">=</span> <span class="mi">1</span>
                       <span class="p">)</span>
         <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">rate_coupon_durations</span> <span class="n">rcd</span>
                   <span class="k">ON</span> <span class="n">rcd</span><span class="p">.</span><span class="n">coupon_id</span> <span class="o">=</span> <span class="n">rc</span><span class="p">.</span><span class="n">id</span>
         <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">amount_coupons</span> <span class="n">ac</span>
                   <span class="k">ON</span> <span class="n">ac</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">cuc</span><span class="p">.</span><span class="n">coupon_id</span>
                       <span class="k">AND</span> <span class="n">ac</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="p">(</span>
                           <span class="k">SELECT</span> <span class="n">mac</span><span class="p">.</span><span class="n">id</span>
                           <span class="k">FROM</span> <span class="p">(</span>
                                    <span class="k">select</span> <span class="n">c3</span><span class="p">.</span><span class="n">id</span><span class="p">,</span> <span class="n">ROW_NUMBER</span><span class="p">()</span> <span class="n">OVER</span> <span class="p">(</span><span class="k">ORDER</span> <span class="k">BY</span> <span class="n">cd2</span><span class="p">.</span><span class="n">valid_end_date</span> <span class="k">ASC</span><span class="p">)</span> <span class="k">as</span> <span class="n">rn</span>
                                    <span class="k">from</span> <span class="n">coupons</span> <span class="n">c3</span>
                                             <span class="k">inner</span> <span class="k">join</span> <span class="n">coupon_duration_settings</span> <span class="n">cd2</span> <span class="k">on</span> <span class="n">c3</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">cd2</span><span class="p">.</span><span class="n">coupon_id</span>
                                    <span class="k">where</span> <span class="n">c3</span><span class="p">.</span><span class="n">discount_type</span> <span class="o">=</span> <span class="s1">'AMOUNT'</span>
                                      <span class="k">and</span> <span class="n">c3</span><span class="p">.</span><span class="n">discount_value</span> <span class="o">=</span> <span class="p">(</span>
                                        <span class="k">select</span> <span class="k">max</span><span class="p">(</span><span class="n">c4</span><span class="p">.</span><span class="n">discount_value</span><span class="p">)</span>
                                        <span class="k">from</span> <span class="n">coupons</span> <span class="n">c4</span>
                                        <span class="k">where</span> <span class="n">c4</span><span class="p">.</span><span class="n">discount_type</span> <span class="o">=</span> <span class="s1">'AMOUNT'</span>
                                    <span class="p">)</span>
                                <span class="p">)</span> <span class="n">mac</span>
                           <span class="k">WHERE</span> <span class="n">mac</span><span class="p">.</span><span class="n">rn</span> <span class="o">=</span> <span class="mi">1</span>
                       <span class="p">)</span>
         <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">amount_coupon_durations</span> <span class="n">acd</span>
                   <span class="k">ON</span> <span class="n">acd</span><span class="p">.</span><span class="n">coupon_id</span> <span class="o">=</span> <span class="n">ac</span><span class="p">.</span><span class="n">id</span>
<span class="k">WHERE</span> <span class="n">h</span><span class="p">.</span><span class="n">has_deleted</span> <span class="o">=</span> <span class="k">false</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">h</span><span class="p">.</span><span class="n">id</span><span class="p">;</span>

</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="ì¥ì ">ì¥ì </h3>
<ul>
  <li>ì¤‘ë³µìœ¼ë¡œ ì—¬ëŸ¬ ê³³ì—ì„œ ì‚¬ìš©í•  ê²½ìš° í•˜ë‚˜ì˜ í´ë˜ìŠ¤ë¡œ ë‘ëŠ” ê²ƒì´ ê°€ë…ì„±ì´ë‚˜ ìœ ì§€ë³´ìˆ˜ë©´ì—ì„œ ì¢‹ë‹¤.</li>
  <li><strong>ì½ê¸° ì „ìš©(<code class="language-plaintext highlighter-rouge">immutable</code>)</strong>ì´ê¸° ë•Œë¬¸ì— ë¶ˆí•„ìš”í•˜ê²Œ ì—”í‹°í‹°ë¥¼ ì €ì¥ ë° ìˆ˜ì •í•˜ì§€ ì•Šê³  ë°ì´í„°ì˜ ì¼ê´€ì„±ì„ ìœ ì§€í•  ìˆ˜ ìˆë‹¤.</li>
  <li>ê¸°ì¡´ í…Œì´ë¸”(ì—¬ê¸°ì„  coupons)ë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³  ìƒˆë¡œìš´ ì—”í‹°í‹°ë¥¼ ì •ì˜í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">@Subselect</code>ëŠ” ì„œë¸Œì¿¼ë¦¬ë¥¼ ê°€ìƒì˜ ì—”í‹°í‹°ë¡œ ë§¤í•‘í•˜ëŠ” ë°©ì‹ì´ë¯€ë¡œ, ORMì´ ì´ë¥¼ ë‹¨ìˆœí•œ ì¡°íšŒë¡œ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ë³µì¡í•œ ì¡°ì¸ ì¿¼ë¦¬ë³´ë‹¤ ì„±ëŠ¥ì´ ë” ë‚˜ì„ ìˆ˜ ìˆë‹¤.
<br /></li>
</ul>

<h3 id="ë‹¨ì ">ë‹¨ì </h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">@Subselect</code> ë¬¸ ì•ˆì˜ ì¿¼ë¦¬ì— ë™ì ìœ¼ë¡œ ì¿¼ë¦¬ë¥¼ ì¶”ê°€í•  ìˆ˜ ì—†ë‹¤. (ì œì¼ ì•„ì‰¬ìš´ ë¶€ë¶„)</li>
  <li>ì¿¼ë¦¬ê°€ ë³µì¡í•œ ê²½ìš° <strong>ì„±ëŠ¥ ì €í•˜</strong>ë¥¼ ìœ ë°œí•  ìˆ˜ ìˆë‹¤.</li>
  <li>ViewëŠ” ì‹¤ì œ ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— <strong>ì¡°íšŒë§Œ ê°€ëŠ¥</strong>í•˜ë‹¤.
<br />
<br /></li>
</ul>

<h3 id="insight">insight</h3>
<p>ì´ë²ˆ ì‘ì—…ì„ í†µí•´ QueryDSLì—ì„œ FROM ì ˆì˜ ì„œë¸Œì¿¼ë¦¬ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë‹¤ì–‘í•œ ë°©ë²•ì„ ê³ ë¯¼í•  ìˆ˜ ìˆì—ˆë‹¤.
ì²˜ìŒì—ëŠ” ë‹¨ìˆœíˆ JPAExpressionsë¡œ í•´ê²°í•˜ë ¤ í–ˆì§€ë§Œ, ì¿ í°ì²˜ëŸ¼ ì—¬ëŸ¬ ê³³ì—ì„œ ì¤‘ë³µìœ¼ë¡œ ì‚¬ìš©í•  ê²½ìš° ì„±ëŠ¥ê³¼ ìœ ì§€ë³´ìˆ˜ë¥¼ ê³ ë ¤í•  ë•Œ ì´ë ‡ê²Œ @Subselectë¥¼ ë¶™ì¸ ì—”í‹°í‹°ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²Œ ë” ì ì ˆí•˜ë‹¤ëŠ” ê²°ë¡ ì„ ëƒˆë‹¤.
ë‹¤í–‰íˆ ì¿¼ë¦¬ë„ ê¸°ì¡´ë³´ë‹¤ ëŠë ¤ì§€ì§€ ì•Šì•„ì„œ ì¢‹ì•˜ì§€ë§Œ, ì´ëŸ° ìƒí™©ì—ì„œ ë™ì  ì¿¼ë¦¬ê°€ í•„ìš”í•˜ë‹¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í•˜ëŠ”ì§€ ì•Œì•„ë³¼ í•„ìš”ê°€ ìˆë‹¤.
<br />
<br />
<br /></p>

<p><strong>ì°¸ê³ </strong></p>
<ul>
  <li><a href="https://www.baeldung.com/hibernate-subselect">@Subselect Annotation in Hibernate</a></li>
  <li><a href="https://juu-code.tistory.com/49">JPA ì—ì„œ From ì ˆì— ì„œë¸Œì¿¼ë¦¬ ì“°ê¸°(@Subselect í†µí•´ì„œ view ìƒì„±)</a></li>
</ul>]]></content><author><name>Dajeong Park</name></author><category term="wiki" /><category term="Java" /><category term="SpringBoot" /><category term="JPA" /><category term="QueryDSL" /><category term="Subselect" /><summary type="html"><![CDATA[í˜„ì¬ ì§„í–‰í•˜ëŠ” í”„ë¡œì íŠ¸ì—ì„œ ì¿ í° ê´€ë ¨ ë³µì¡í•œ ì¿¼ë¦¬ë¥¼ ì‘ì„±í•˜ë˜ ì¤‘ì´ì—ˆë‹¤. SQLë¡œ ë¨¼ì € ì‘ì—…ì„ í•´ë³´ëŠ”ë° ì„œë¸Œì¿¼ë¦¬ë¥¼ from ì ˆì— ë„£ì–´ì•¼ ë°ì´í„°ê°€ ì œëŒ€ë¡œ ë‚˜ì˜¤ëŠ”ë°, QueryDSLì—ì„œëŠ” from ì ˆì— ì„œë¸Œì¿¼ë¦¬ë¥¼ ë„£ì„ ìˆ˜ ì—†ë‹¤ëŠ” ë¬¸ì œë¥¼ ìˆì—ˆë‹¤. ê·¸ë˜ì„œ í•´ê²° ë°©ë²•ì„ ì°¾ì•„ë³´ë‹¤ê°€ @Subselectë¼ëŠ” Hibernate ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ ì¿¼ë¦¬ë¥¼ ìº¡ìŠí™”í•´ì„œ Viewë¥¼ ë§Œë“¤ì–´ ì—”í‹°í‹°ì²˜ëŸ¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ê±¸ ì•Œê²Œ ë˜ì—ˆë‹¤. ê·¸ë˜ì„œ @Subselectë¥¼ í™œìš©í•˜ì—¬ ì„œë¸Œì¿¼ë¦¬ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ê³µìœ í•˜ë ¤ê³  í•œë‹¤.]]></summary></entry></feed>